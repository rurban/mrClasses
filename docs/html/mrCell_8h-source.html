<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mrClasses: mrCell.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>mrCell.h</h1><a href="mrCell_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//</span>
00002 <span class="comment">//  Copyright (c) 2004, Gonzalo Garramuno</span>
00003 <span class="comment">//</span>
00004 <span class="comment">//  All rights reserved.</span>
00005 <span class="comment">//</span>
00006 <span class="comment">//  Redistribution and use in source and binary forms, with or without</span>
00007 <span class="comment">//  modification, are permitted provided that the following conditions are</span>
00008 <span class="comment">//  met:</span>
00009 <span class="comment">//  *       Redistributions of source code must retain the above copyright</span>
00010 <span class="comment">//  notice, this list of conditions and the following disclaimer.</span>
00011 <span class="comment">//  *       Redistributions in binary form must reproduce the above</span>
00012 <span class="comment">//  copyright notice, this list of conditions and the following disclaimer</span>
00013 <span class="comment">//  in the documentation and/or other materials provided with the</span>
00014 <span class="comment">//  distribution.</span>
00015 <span class="comment">//  *       Neither the name of Gonzalo Garramuno nor the names of</span>
00016 <span class="comment">//  its other contributors may be used to endorse or promote products derived</span>
00017 <span class="comment">//  from this software without specific prior written permission. </span>
00018 <span class="comment">//</span>
00019 <span class="comment">//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
00020 <span class="comment">//  "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
00021 <span class="comment">//  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
00022 <span class="comment">//  A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
00023 <span class="comment">//  OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
00024 <span class="comment">//  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
00025 <span class="comment">//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
00026 <span class="comment">//  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
00027 <span class="comment">//  THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
00028 <span class="comment">//  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
00029 <span class="comment">//  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00030 <span class="comment">//</span>
00031 
00032 
00033 <span class="preprocessor">#ifndef mrCell_h</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#define mrCell_h</span>
00035 <span class="preprocessor"></span>
00036 
00037 <span class="preprocessor">#ifndef mrVector_h</span>
00038 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="mrVector_8h.html">mrVector.h</a>"</span>
00039 <span class="preprocessor">#endif</span>
00040 <span class="preprocessor"></span>
00041 
00042 <a class="code" href="mrMacros_8h.html#a0">BEGIN_NAMESPACE</a>( mr )
00043 
00044 <span class="keyword">class </span>VCell;
00045 
<a name="l00046"></a><a class="code" href="mrCell_8h.html#a0">00046</a> <span class="preprocessor">#define mrEPS miSCALAR_EPSILON</span>
00047 <span class="preprocessor"></span>
<a name="l00049"></a><a class="code" href="classmr_1_1FCell.html">00049</a> <span class="keyword">class </span><a class="code" href="classmr_1_1FCell.html">FCell</a>
00050 {
00051    <span class="keyword">protected</span>:
<a name="l00052"></a><a class="code" href="classmr_1_1FCell.html#t0">00052</a>      <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> TABLE_SIZE = 2048;
<a name="l00053"></a><a class="code" href="classmr_1_1FCell.html#t1">00053</a>      <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> MASK = TABLE_SIZE - 1;
00054      
<a name="l00055"></a><a class="code" href="classmr_1_1FCell.html#t2">00055</a>      <span class="keyword">static</span> <a class="code" href="mrWin32_8h.html#a0">MR_LIB_EXPORT</a> <span class="keywordtype">int</span>   <a class="code" href="mrRman__macros_8h.html#a3">P</a>[];  <span class="comment">// permutation table</span>
<a name="l00056"></a><a class="code" href="classmr_1_1FCell.html#t3">00056</a>      <span class="keyword">static</span> <a class="code" href="mrWin32_8h.html#a0">MR_LIB_EXPORT</a> <span class="keywordtype">float</span> R[];  <span class="comment">// pseudo random numbers</span>
00057 
00058    <span class="keyword">public</span>:
00059      
<a name="l00060"></a><a class="code" href="classmr_1_1FCell.html#e0">00060</a>      <span class="keyword">inline</span> <span class="keyword">static</span> miScalar noise(miScalar x)
00061      {
00062         <span class="keywordflow">if</span> (x&lt;0.0f) x -= 1;
00063         <span class="keywordtype">int</span> i = <a class="code" href="mrRman__macros_8h.html#a3">P</a>[((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(x+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; MASK];
00064         <span class="keywordflow">return</span> R[i];
00065      }
00066 
00067      
<a name="l00068"></a><a class="code" href="classmr_1_1FCell.html#e1">00068</a>      <span class="keyword">inline</span> <span class="keyword">static</span> miScalar noise(miScalar x, miScalar y)
00069      {
00070         <span class="keywordflow">if</span> (x&lt;0.0f) x -= 1;
00071         <span class="keywordtype">int</span> i = <a class="code" href="mrRman__macros_8h.html#a3">P</a>[((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(x+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; MASK];
00072         <span class="keywordflow">if</span> (y&lt;0.0f) y -= 1;
00073         i = <a class="code" href="mrRman__macros_8h.html#a3">P</a>[<a class="code" href="mrRman__macros_8h.html#a3">P</a>[i] + ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(y+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; MASK];
00074         <span class="keywordflow">return</span> R[i];
00075      }
00076 
00077      
<a name="l00078"></a><a class="code" href="classmr_1_1FCell.html#e2">00078</a>      <span class="keyword">inline</span> <span class="keyword">static</span> miScalar noise(miScalar x, miScalar y,
00079                                   miScalar z)
00080      {
00081         <span class="keywordflow">if</span> (x&lt;0.0f) x -= 1;
00082         <span class="keywordtype">int</span> i = <a class="code" href="mrRman__macros_8h.html#a3">P</a>[((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(x+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; MASK];
00083         <span class="keywordflow">if</span> (y&lt;0.0f) y -= 1;
00084         i = <a class="code" href="mrRman__macros_8h.html#a3">P</a>[<a class="code" href="mrRman__macros_8h.html#a3">P</a>[i] + ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(y+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; MASK];
00085         <span class="keywordflow">if</span> (z&lt;0.0f) z -= 1;
00086         i = <a class="code" href="mrRman__macros_8h.html#a3">P</a>[<a class="code" href="mrRman__macros_8h.html#a3">P</a>[i] + ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(z+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; MASK];
00087         <span class="keywordflow">return</span> R[i];
00088      }
00089 
00090      
<a name="l00091"></a><a class="code" href="classmr_1_1FCell.html#e3">00091</a>      <span class="keyword">inline</span> <span class="keyword">static</span> miScalar noise(miScalar x, miScalar y,
00092                                   miScalar z, miScalar t)
00093      {
00094         <span class="keywordflow">if</span> (x&lt;0.0f) x -= 1;
00095         <span class="keywordtype">int</span> i = <a class="code" href="mrRman__macros_8h.html#a3">P</a>[((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(x+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; MASK];
00096         <span class="keywordflow">if</span> (y&lt;0.0f) y -= 1;
00097         i = <a class="code" href="mrRman__macros_8h.html#a3">P</a>[<a class="code" href="mrRman__macros_8h.html#a3">P</a>[i] + ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(y+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; MASK];
00098         <span class="keywordflow">if</span> (z&lt;0.0f) z -= 1;
00099         i = <a class="code" href="mrRman__macros_8h.html#a3">P</a>[<a class="code" href="mrRman__macros_8h.html#a3">P</a>[i] + ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(z+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; MASK];
00100         <span class="keywordflow">if</span> (t&lt;0.0f) t -= 1;
00101         i = <a class="code" href="mrRman__macros_8h.html#a3">P</a>[<a class="code" href="mrRman__macros_8h.html#a3">P</a>[i] + ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(t+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; MASK];
00102         <span class="keywordflow">return</span> R[i];
00103      }
00104 
00105      
<a name="l00106"></a><a class="code" href="classmr_1_1FCell.html#e4">00106</a>      <span class="keyword">inline</span> <span class="keyword">static</span> miScalar noise(<span class="keyword">const</span> <a class="code" href="structmr_1_1base_1_1vec2.html">vector2d</a>&amp; P)
00107      {
00108         <span class="keywordflow">return</span> noise(<a class="code" href="mrRman__macros_8h.html#a3">P</a>.u, <a class="code" href="mrRman__macros_8h.html#a3">P</a>.v);
00109      }
00110      
<a name="l00111"></a><a class="code" href="classmr_1_1FCell.html#e5">00111</a>      <span class="keyword">inline</span> <span class="keyword">static</span> miScalar noise(<span class="keyword">const</span> <a class="code" href="structmr_1_1point__base.html">point</a>&amp; P)
00112      {
00113         <span class="keywordflow">return</span> noise(<a class="code" href="mrRman__macros_8h.html#a3">P</a>.x, <a class="code" href="mrRman__macros_8h.html#a3">P</a>.y, <a class="code" href="mrRman__macros_8h.html#a3">P</a>.z);
00114      }
00115      
<a name="l00116"></a><a class="code" href="classmr_1_1FCell.html#e6">00116</a>      <span class="keyword">inline</span> <span class="keyword">static</span> miScalar noise(<span class="keyword">const</span> <a class="code" href="structmr_1_1point__base.html">point</a>&amp; P, <span class="keyword">const</span> miScalar t)
00117      {
00118         <span class="keywordflow">return</span> noise(<a class="code" href="mrRman__macros_8h.html#a3">P</a>.x, <a class="code" href="mrRman__macros_8h.html#a3">P</a>.y, <a class="code" href="mrRman__macros_8h.html#a3">P</a>.z, t);
00119      }
00120 
<a name="l00121"></a><a class="code" href="classmr_1_1FCell.html#o0">00121</a>      <span class="keyword">friend</span> <a class="code" href="classmr_1_1VCell.html">VCell</a>;
00122 };
00123 
00124 
<a name="l00126"></a><a class="code" href="classmr_1_1VCell.html">00126</a> <span class="keyword">class </span><a class="code" href="classmr_1_1VCell.html">VCell</a>
00127 {
00128    <span class="keyword">public</span>:
00129      
<a name="l00130"></a><a class="code" href="classmr_1_1VCell.html#e0">00130</a>      <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="structmr_1_1vec__base.html">vector</a> noise(miScalar x)
00131      {
00132         <a class="code" href="structmr_1_1vec__base.html">vector</a> r( kNoInit );
00133         <span class="keywordflow">if</span> (x&lt;0.0f) x -= 1;
00134         <span class="keywordtype">int</span> i = FCell::P[((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(x+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; FCell::MASK];
00135         r.x = FCell::R[i];
00136         i = FCell::P[FCell::P[i] + i];
00137         r.y = FCell::R[i];
00138         i = FCell::P[FCell::P[i] + i];
00139         r.z = FCell::R[i];
00140         <span class="keywordflow">return</span> r;
00141      }
00142 
00143      
<a name="l00144"></a><a class="code" href="classmr_1_1VCell.html#e1">00144</a>      <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="structmr_1_1vec__base.html">vector</a> noise(miScalar x, miScalar y)
00145      {
00146         <a class="code" href="structmr_1_1vec__base.html">vector</a> r( kNoInit );
00147         <span class="keywordflow">if</span> (x&lt;0.0f) x -= 1;
00148         <span class="keywordflow">if</span> (y&lt;0.0f) y -= 1;
00149         <span class="keywordtype">int</span> xidx, yidx;
00150         xidx = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(x+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; FCell::MASK;
00151         yidx = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(y+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; FCell::MASK;
00152         <span class="keywordtype">int</span> i = FCell::P[ FCell::P[xidx] ^ FCell::P[yidx] ];
00153         i = FCell::P[FCell::P[i] + yidx];
00154         
00155         r.x = FCell::R[i];
00156         i = FCell::P[i];
00157         r.y = FCell::R[i];
00158         i = FCell::P[i];
00159         r.z = FCell::R[i];
00160         <span class="keywordflow">return</span> r;
00161      }
00162 
00163      
<a name="l00164"></a><a class="code" href="classmr_1_1VCell.html#e2">00164</a>      <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="structmr_1_1vec__base.html">vector</a> noise(miScalar x, miScalar y,
00165                                 miScalar z)
00166      {
00167         <a class="code" href="structmr_1_1vec__base.html">vector</a> r( kNoInit );
00168         <span class="keywordflow">if</span> (x&lt;0.0f) x -= 1;
00169         <span class="keywordflow">if</span> (y&lt;0.0f) y -= 1;
00170         <span class="keywordflow">if</span> (z&lt;0.0f) z -= 1;
00171         <span class="keywordtype">int</span> xidx, yidx, zidx;
00172         xidx = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(x+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; FCell::MASK;
00173         yidx = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(y+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; FCell::MASK;
00174         zidx = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(z+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; FCell::MASK;
00175         <span class="keywordtype">int</span> i = FCell::P[ FCell::P[xidx] ^ FCell::P[yidx] ^ FCell::P[zidx] ];
00176         r.x = FCell::R[i];
00177         i = FCell::P[FCell::P[i] + yidx];
00178         r.y = FCell::R[i];
00179         i = FCell::P[FCell::P[i] + zidx];
00180         r.z = FCell::R[i];
00181         <span class="keywordflow">return</span> r;
00182      }
00183 
00184      
<a name="l00185"></a><a class="code" href="classmr_1_1VCell.html#e3">00185</a>      <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="structmr_1_1vec__base.html">vector</a> noise(miScalar x, miScalar y,
00186                                 miScalar z, miScalar t)
00187      {
00188         <a class="code" href="structmr_1_1vec__base.html">vector</a> r( kNoInit );
00189         <span class="keywordflow">if</span> (x&lt;0.0f) x -= 1;
00190         <span class="keywordflow">if</span> (y&lt;0.0f) y -= 1;
00191         <span class="keywordflow">if</span> (z&lt;0.0f) z -= 1;
00192         <span class="keywordflow">if</span> (t&lt;0.0f) t -= 1;
00193         <span class="keywordtype">int</span> xidx, yidx, zidx, tidx;
00194         tidx = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(t+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; FCell::MASK;
00195         xidx = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(x+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; FCell::MASK;
00196         yidx = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(y+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; FCell::MASK;
00197         zidx = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(z+<a class="code" href="mrCell_8h.html#a0">mrEPS</a>)) &amp; FCell::MASK;
00198         <span class="keywordtype">int</span> i = FCell::P[ FCell::P[xidx] ^ FCell::P[yidx] ^
00199                           FCell::P[zidx] ^ FCell::P[tidx] ];
00200         r.x = FCell::R[i];
00201         i = FCell::P[FCell::P[i] + yidx];
00202         r.y = FCell::R[i];
00203         i = FCell::P[FCell::P[i] + zidx];
00204         r.z = FCell::R[i];
00205         <span class="keywordflow">return</span> r;
00206      }
00207 
00208      
<a name="l00209"></a><a class="code" href="classmr_1_1VCell.html#e4">00209</a>      <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="structmr_1_1vec__base.html">vector</a> noise(<span class="keyword">const</span> <a class="code" href="structmr_1_1base_1_1vec2.html">vector2d</a>&amp; P)
00210      {
00211         <span class="keywordflow">return</span> noise(<a class="code" href="mrRman__macros_8h.html#a3">P</a>.u, <a class="code" href="mrRman__macros_8h.html#a3">P</a>.v);
00212      }
00213 
<a name="l00214"></a><a class="code" href="classmr_1_1VCell.html#e5">00214</a>      <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="structmr_1_1vec__base.html">vector</a> noise(<span class="keyword">const</span> <a class="code" href="structmr_1_1point__base.html">point</a>&amp; P)
00215      {
00216         <span class="keywordflow">return</span> noise(<a class="code" href="mrRman__macros_8h.html#a3">P</a>.x, <a class="code" href="mrRman__macros_8h.html#a3">P</a>.y, <a class="code" href="mrRman__macros_8h.html#a3">P</a>.z);
00217      }
00218 
00219      
<a name="l00220"></a><a class="code" href="classmr_1_1VCell.html#e6">00220</a>      <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="structmr_1_1vec__base.html">vector</a> noise(<span class="keyword">const</span> <a class="code" href="structmr_1_1point__base.html">point</a>&amp; P, <span class="keyword">const</span> miScalar t)
00221      {
00222         <span class="keywordflow">return</span> noise(<a class="code" href="mrRman__macros_8h.html#a3">P</a>.x, <a class="code" href="mrRman__macros_8h.html#a3">P</a>.y, <a class="code" href="mrRman__macros_8h.html#a3">P</a>.z, t);
00223      }
00224 
00225 };
00226 
00227 <span class="preprocessor">#undef mrEPS</span>
00228 <span class="preprocessor"></span>
00229 <a class="code" href="mrMacros_8h.html#a1">END_NAMESPACE</a>( mr )
00230 
00231 
00232 #endif <span class="comment">// mrCell_h</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Feb 22 18:29:23 2004 for mrClasses by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
