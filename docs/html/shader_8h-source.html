<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mrClasses: shader.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>shader.h</h1><a href="shader_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/******************************************************************************</span>
00002 <span class="comment"> * Copyright 2003 by mental images GmbH &amp; Co.KG, Fasanenstr. 81, D-10623 Berlin</span>
00003 <span class="comment"> * All rights reserved.</span>
00004 <span class="comment"> ******************************************************************************</span>
00005 <span class="comment"> * Author:      thomas</span>
00006 <span class="comment"> * Created:     16.07.2003</span>
00007 <span class="comment"> * Purpose:     standard header file for all mental ray shaders</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> * Note: This file is generated automatically from the mental ray sources, do</span>
00010 <span class="comment"> * not edit. Some definitions exist for internal reasons and are subject to</span>
00011 <span class="comment"> * change between mental ray versions. See the mental ray user's manual for</span>
00012 <span class="comment"> * a definitive description of the shader interface. Avoid using features not</span>
00013 <span class="comment"> * documented in the manual because they may change in future versions.</span>
00014 <span class="comment"> *****************************************************************************/</span>
00015 
00016 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00017 <span class="preprocessor">#include &lt;math.h&gt;</span>
00018 
00019 <span class="preprocessor">#ifndef SHADER_H</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#define SHADER_H</span>
00021 <span class="preprocessor"></span>
00022 <span class="preprocessor">#define RAY2                    </span><span class="comment">/* for shaders that share sources with 1.9 */</span>
00023 
00024 <span class="preprocessor">#ifdef __cplusplus</span>
00025 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00026 <span class="preprocessor">#endif</span>
00027 <span class="preprocessor"></span>
00028 
00029 <span class="comment">/*------------ mi_raylib.h ------------*/</span>
00030 
<a name="l00031"></a><a class="code" href="shader_8h.html#a875">00031</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {<a class="code" href="shader_8h.html#a875a176">miFALSE</a>=0, <a class="code" href="shader_8h.html#a875a177">miTRUE</a>=1}      <a class="code" href="shader_8h.html#a875">miBoolean</a>;
<a name="l00032"></a><a class="code" href="shader_8h.html#a127">00032</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>                   <a class="code" href="shader_8h.html#a127">miCBoolean</a>;     <span class="comment">/* if space is tight */</span>
<a name="l00033"></a><a class="code" href="shader_8h.html#a128">00033</a> <span class="keyword">typedef</span> <span class="keywordtype">int</span>                             <a class="code" href="shader_8h.html#a128">miInteger</a>;      <span class="comment">/* for shader params */</span>
<a name="l00034"></a><a class="code" href="shader_8h.html#a129">00034</a> <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">char</span>                     <a class="code" href="shader_8h.html#a129">miSint1</a>;
<a name="l00035"></a><a class="code" href="shader_8h.html#a130">00035</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>                   <a class="code" href="shader_8h.html#a130">miUint1</a>;
<a name="l00036"></a><a class="code" href="shader_8h.html#a131">00036</a> <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">short</span>                    <a class="code" href="shader_8h.html#a131">miSint2</a>;
<a name="l00037"></a><a class="code" href="shader_8h.html#a132">00037</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>                  <a class="code" href="shader_8h.html#a132">miUint2</a>;
<a name="l00038"></a><a class="code" href="shader_8h.html#a133">00038</a> <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">int</span>                      <a class="code" href="shader_8h.html#a133">miSint4</a>;
<a name="l00039"></a><a class="code" href="shader_8h.html#a134">00039</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                    <a class="code" href="shader_8h.html#a134">miUint4</a>;
<a name="l00040"></a><a class="code" href="shader_8h.html#a135">00040</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                    <a class="code" href="shader_8h.html#a135">miUint</a>;
<a name="l00041"></a><a class="code" href="shader_8h.html#a136">00041</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>                   <a class="code" href="shader_8h.html#a136">miUchar</a>;
<a name="l00042"></a><a class="code" href="shader_8h.html#a137">00042</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>                  <a class="code" href="shader_8h.html#a137">miUshort</a>;
00043 
00044 <span class="preprocessor">#if defined(WIN_NT) &amp;&amp; defined(BIT64)</span>
00045 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> __int64                <a class="code" href="shader_8h.html#a138">miUlong</a>;
00046 <span class="keyword">typedef</span> <span class="keywordtype">signed</span>   __int64                <a class="code" href="shader_8h.html#a139">miSlong</a>;
00047 <span class="preprocessor">#else</span>
<a name="l00048"></a><a class="code" href="shader_8h.html#a138">00048</a> <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>                   <a class="code" href="shader_8h.html#a138">miUlong</a>;
<a name="l00049"></a><a class="code" href="shader_8h.html#a139">00049</a> <span class="keyword">typedef</span> <span class="keywordtype">signed</span>   <span class="keywordtype">long</span>                   <a class="code" href="shader_8h.html#a139">miSlong</a>;
00050 <span class="preprocessor">#endif</span>
00051 <span class="preprocessor"></span>
<a name="l00052"></a><a class="code" href="shader_8h.html#a140">00052</a> <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">char</span>                     <a class="code" href="shader_8h.html#a140">miSchar</a>;
<a name="l00053"></a><a class="code" href="shader_8h.html#a141">00053</a> <span class="keyword">typedef</span> <span class="keywordtype">float</span>                           <a class="code" href="shader_8h.html#a141">miScalar</a>;
<a name="l00054"></a><a class="code" href="shader_8h.html#a142">00054</a> <span class="keyword">typedef</span> <span class="keywordtype">double</span>                          <a class="code" href="shader_8h.html#a142">miGeoScalar</a>;
<a name="l00055"></a><a class="code" href="structmiVector2d.html#o1">00055</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{<a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="mrRman__macros_8h.html#a9">u</a>, <a class="code" href="mrRman__macros_8h.html#a10">v</a>;}         <a class="code" href="structmiVector2d.html">miVector2d</a>;
<a name="l00056"></a><a class="code" href="structmiVector.html#o2">00056</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{<a class="code" href="shader_8h.html#a141">miScalar</a> x, y, z;}      <a class="code" href="structmiVector.html">miVector</a>;
<a name="l00057"></a><a class="code" href="structmiGeoVector2d.html#o1">00057</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{<a class="code" href="shader_8h.html#a142">miGeoScalar</a> <a class="code" href="mrRman__macros_8h.html#a9">u</a>, <a class="code" href="mrRman__macros_8h.html#a10">v</a>;}      <a class="code" href="structmiGeoVector2d.html">miGeoVector2d</a>;
<a name="l00058"></a><a class="code" href="structmiGeoVector.html#o2">00058</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{<a class="code" href="shader_8h.html#a142">miGeoScalar</a> x, y, z;}   <a class="code" href="structmiGeoVector.html">miGeoVector</a>;
<a name="l00059"></a><a class="code" href="structmiQuaternion.html#o2">00059</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{<a class="code" href="shader_8h.html#a141">miScalar</a> x, y, z, w;}   <a class="code" href="structmiQuaternion.html">miQuaternion</a>;
<a name="l00060"></a><a class="code" href="shader_8h.html#a143">00060</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a141">miScalar</a>                        <a class="code" href="shader_8h.html#a143">miMatrix</a>[16];
<a name="l00061"></a><a class="code" href="structmiColor.html#o0">00061</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{<span class="keywordtype">float</span> r, g, b, a;}      <a class="code" href="structmiColor.html">miColor</a>;
<a name="l00062"></a><a class="code" href="structmiRange.html#o0">00062</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{<a class="code" href="shader_8h.html#a141">miScalar</a> min, max;}     <a class="code" href="structmiRange.html">miRange</a>;
<a name="l00063"></a><a class="code" href="structmiGeoRange.html#o0">00063</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{<a class="code" href="shader_8h.html#a142">miGeoScalar</a> min, max;}  <a class="code" href="structmiGeoRange.html">miGeoRange</a>;
<a name="l00064"></a><a class="code" href="shader_8h.html#a144">00064</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>                  <a class="code" href="shader_8h.html#a144">miIndex</a>;
<a name="l00065"></a><a class="code" href="shader_8h.html#a145">00065</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                    <a class="code" href="shader_8h.html#a145">miGeoIndex</a>;
<a name="l00066"></a><a class="code" href="shader_8h.html#a146">00066</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a875">miBoolean</a>                       (*<a class="code" href="shader_8h.html#a146">miFunction_ptr</a>)(<span class="keywordtype">void</span>);
<a name="l00067"></a><a class="code" href="unionmiPointer.html#o0">00067</a> <span class="keyword">typedef</span> <span class="keyword">union </span>{<span class="keywordtype">void</span> *p; <span class="keywordtype">double</span> d;}      <a class="code" href="unionmiPointer.html">miPointer</a>;      <span class="comment">/* 8-byte aligned ptr*/</span>
<a name="l00068"></a><a class="code" href="shader_8h.html#a147">00068</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a135">miUint</a>                          <a class="code" href="shader_8h.html#a147">miTag</a>;
<a name="l00069"></a><a class="code" href="shader_8h.html#a148">00069</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a133">miSint4</a>                         <a class="code" href="shader_8h.html#a148">miThreadID</a>;
<a name="l00070"></a><a class="code" href="shader_8h.html#a149">00070</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a133">miSint4</a>                         <a class="code" href="shader_8h.html#a149">miHostID</a>;
<a name="l00071"></a><a class="code" href="shader_8h.html#a150">00071</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a133">miSint4</a>                         <a class="code" href="shader_8h.html#a150">miSessionID</a>;
<a name="l00072"></a><a class="code" href="shader_8h.html#a151">00072</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a133">miSint4</a>                         <a class="code" href="shader_8h.html#a151">miTransactionID</a>;
<a name="l00073"></a><a class="code" href="shader_8h.html#a152">00073</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a133">miSint4</a>                         <a class="code" href="shader_8h.html#a152">miWorldID</a>;
00074 
00075 <span class="keyword">struct </span><a class="code" href="shader_8h.html#a747">mi_lock</a>;
<a name="l00076"></a><a class="code" href="unionmiLock.html">00076</a> <span class="keyword">typedef</span> <span class="keyword">union </span>{
<a name="l00077"></a><a class="code" href="unionmiLock.html#o0">00077</a>         <span class="keyword">struct  </span><a class="code" href="classmi__lock.html">mi_lock</a> *milockptr;
<a name="l00078"></a><a class="code" href="unionmiLock.html#o1">00078</a>         <span class="keywordtype">int</span>     padding[2];
00079 } <a class="code" href="unionmiLock.html">miLock</a>;
00080 <span class="preprocessor">#if defined(WIN_NT) &amp;&amp; defined(BIT64)                   </span><span class="comment">/* int wide enough   */</span>
00081 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> __int64                <a class="code" href="shader_8h.html#a153">miIntptr</a>;       <span class="comment">/* for a pointer. Get*/</span>
00082 <span class="preprocessor">#else                                                   </span><span class="comment">/* this: 64-bit NT   */</span>
<a name="l00083"></a><a class="code" href="shader_8h.html#a153">00083</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>                   <a class="code" href="shader_8h.html#a153">miIntptr</a>;       <span class="comment">/* will have 32-bit  */</span>
00084 <span class="preprocessor">#endif                                                  </span><span class="comment">/* longs! Losers...  */</span>
00085 
<a name="l00086"></a><a class="code" href="shader_8h.html#a1">00086</a> <span class="preprocessor">#define miSCALAR_EPSILON                (1.0e-5f)</span>
<a name="l00087"></a><a class="code" href="shader_8h.html#a2">00087</a> <span class="preprocessor"></span><span class="preprocessor">#define miGEO_SCALAR_EPSILON            (1e-9)</span>
<a name="l00088"></a><a class="code" href="shader_8h.html#a3">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define miHUGE_SCALAR                   (1e36)  </span><span class="comment">/* don't require &lt;limits.h&gt; */</span>
<a name="l00089"></a><a class="code" href="shader_8h.html#a4">00089</a> <span class="preprocessor">#define miHUGE_INT                      (2147483647)</span>
<a name="l00090"></a><a class="code" href="shader_8h.html#a5">00090</a> <span class="preprocessor"></span><span class="preprocessor">#define miNULL_INDEX                    (0xffff) </span><span class="comment">/* null value for miIndex */</span>
<a name="l00091"></a><a class="code" href="shader_8h.html#a6">00091</a> <span class="preprocessor">#define miMAX_INDEX                     (0xfffe) </span><span class="comment">/* largest valid miIndex */</span>
<a name="l00092"></a><a class="code" href="shader_8h.html#a7">00092</a> <span class="preprocessor">#define miNULL_GEOINDEX                 (0xffffffff) </span><span class="comment">/* null miGeoIndex */</span>
<a name="l00093"></a><a class="code" href="shader_8h.html#a8">00093</a> <span class="preprocessor">#define miMAX_GEOINDEX                  (0xfffffffe) </span><span class="comment">/* largest miGeoIndex */</span>
00094 
<a name="l00095"></a><a class="code" href="shader_8h.html#a876">00095</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
00096         <a class="code" href="shader_8h.html#a876a178">miM_NULL</a> = 0,           <span class="comment">/* not a legal module, wildcard value */</span>
00097         <a class="code" href="shader_8h.html#a876a179">miM_MSG</a>,                <span class="comment">/* message passing */</span>
00098         <a class="code" href="shader_8h.html#a876a180">miM_PAR</a>,                <span class="comment">/* message routing and event loops */</span>
00099         <a class="code" href="shader_8h.html#a876a181">miM_MEM</a>,                <span class="comment">/* memory manager */</span>
00100         <a class="code" href="shader_8h.html#a876a182">miM_DB</a>,                 <span class="comment">/* database module */</span>
00101         <a class="code" href="shader_8h.html#a876a183">miM_PHEN</a>,               <span class="comment">/* phenomenon database */</span>
00102         <a class="code" href="shader_8h.html#a876a184">miM_RCRM</a>,               <span class="comment">/* rendering core: rapid motion */</span>
00103         <a class="code" href="shader_8h.html#a876a185">miM_SCENE</a>,              <span class="comment">/* common scene operations */</span>
00104         <a class="code" href="shader_8h.html#a876a186">miM_RC</a>,                 <span class="comment">/* rendering core */</span>
00105         <a class="code" href="shader_8h.html#a876a187">miM_GAPMI</a>,              <span class="comment">/* geometry approximation (GAP) */</span>
00106         <a class="code" href="shader_8h.html#a876a188">miM_IMG</a>,                <span class="comment">/* image file read/write */</span>
00107         <a class="code" href="shader_8h.html#a876a189">miM_ECHO</a>,               <span class="comment">/* scene echo to .mi file */</span>
00108         <a class="code" href="shader_8h.html#a876a190">miM_MI</a>,                 <span class="comment">/* mi file translator */</span>
00109         <a class="code" href="shader_8h.html#a876a191">miM_RCLM</a>,               <span class="comment">/* light mapping module */</span>
00110         <a class="code" href="shader_8h.html#a876a192">miM_SBS</a>,                <span class="comment">/* shape-by-shading */</span>
00111         <a class="code" href="shader_8h.html#a876a193">miM_RCH</a>,                <span class="comment">/* Hair rendering */</span>
00112         <a class="code" href="shader_8h.html#a876a194">miM_IMATTER</a>,            <span class="comment">/* imatter C++ interface (iraylib module) */</span>
00113         <a class="code" href="shader_8h.html#a876a195">miM_GEOSI</a>,              <span class="comment">/* surface / surface intersection */</span>
00114         <a class="code" href="shader_8h.html#a876a196">miM_TEST</a>,               <span class="comment">/* not used in raylib, for test beds only */</span>
00115         <a class="code" href="shader_8h.html#a876a197">miM_LINK</a>,               <span class="comment">/* dynamical linking, function symbol table */</span>
00116         <a class="code" href="shader_8h.html#a876a198">miM_P2SD</a>,               <span class="comment">/* polygonal import */</span>
00117         <a class="code" href="shader_8h.html#a876a199">miM_DISP</a>,               <span class="comment">/* realtime image displayer */</span>
00118         <a class="code" href="shader_8h.html#a876a200">miM_LPROF</a>,              <span class="comment">/* light profile support (ray 3.1) */</span>
00119         <a class="code" href="shader_8h.html#a876a201">miM_JOB</a>,                <span class="comment">/* job manager (ray 3.0) */</span>
00120         <a class="code" href="shader_8h.html#a876a202">miM_MAIN</a>,               <span class="comment">/* all front-ends with main() */</span>
00121         <a class="code" href="shader_8h.html#a876a203">miM_GEOMI</a>,              <span class="comment">/* geometry service library (GEO) */</span>
00122         <a class="code" href="shader_8h.html#a876a204">miM_MATTER</a>,             <span class="comment">/* -- unused */</span>
00123         <a class="code" href="shader_8h.html#a876a205">miM_TRANS</a>,              <span class="comment">/* TRANS transaction handling */</span>
00124         <a class="code" href="shader_8h.html#a876a206">miM_INVENTOR</a>,           <span class="comment">/* SGI Inventor translator */</span>
00125         <a class="code" href="shader_8h.html#a876a207">miM_LIB</a>,                <span class="comment">/* library module, error messages */</span>
00126         <a class="code" href="shader_8h.html#a876a208">miM_API</a>,                <span class="comment">/* high-level app programming interface */</span>
00127         <a class="code" href="shader_8h.html#a876a209">miM_SPDL</a>,               <span class="comment">/* Softimage SPDL phenomenon parser */</span>
00128         <a class="code" href="shader_8h.html#a876a210">miM_PHCR</a>,               <span class="comment">/* shader editor GUI */</span>
00129         <a class="code" href="shader_8h.html#a876a211">miM_RCB</a>,                <span class="comment">/* RC boxing */</span>
00130         <a class="code" href="shader_8h.html#a876a212">miM_RCC</a>,                <span class="comment">/* RC contours */</span>
00131         <a class="code" href="shader_8h.html#a876a213">miM_RCI</a>,                <span class="comment">/* RC intersection */</span>
00132         <a class="code" href="shader_8h.html#a876a214">miM_RCGI</a>,               <span class="comment">/* RC global illumination and caustics */</span>
00133         <a class="code" href="shader_8h.html#a876a215">miM_RCHW</a>,               <span class="comment">/* RC hardware rendering */</span>
00134         <a class="code" href="shader_8h.html#a876a216">miM_SIMP</a>,               <span class="comment">/* Mesh simplification */</span>
00135         <a class="code" href="shader_8h.html#a876a217">miM_SURF</a>,               <span class="comment">/* subdivision surfaces */</span>
00136         <a class="code" href="shader_8h.html#a876a218">miM_CAPI</a>,               <span class="comment">/* class api module */</span>
00137         <a class="code" href="shader_8h.html#a876a219">miM_GAPAD</a>,              <span class="comment">/* GAP adjacency detection and edge merging */</span>
00138         <a class="code" href="shader_8h.html#a876a220">miM_GAPCU</a>,              <span class="comment">/* GAP curves */</span>
00139         <a class="code" href="shader_8h.html#a876a221">miM_GAPDI</a>,              <span class="comment">/* GAP displacement mapping */</span>
00140         <a class="code" href="shader_8h.html#a876a222">miM_GAPIS</a>,              <span class="comment">/* GAP isoline segments */</span>
00141         <a class="code" href="shader_8h.html#a876a223">miM_GAPPO</a>,              <span class="comment">/* GAP polygons */</span>
00142         <a class="code" href="shader_8h.html#a876a224">miM_GAPFA</a>,              <span class="comment">/* GAP faces */</span>
00143         <a class="code" href="shader_8h.html#a876a225">miM_GAPTE</a>,              <span class="comment">/* GAP tessellation */</span>
00144         <a class="code" href="shader_8h.html#a876a226">miM_GEOCO</a>,              <span class="comment">/* GEO conditioning */</span>
00145         <a class="code" href="shader_8h.html#a876a227">miM_GEOEV</a>,              <span class="comment">/* GEO evaluation */</span>
00146         <a class="code" href="shader_8h.html#a876a228">miM_GEOMO</a>,              <span class="comment">/* GEO modelling */</span>
00147         <a class="code" href="shader_8h.html#a876a229">miM_GEOST</a>,              <span class="comment">/* GEO strips */</span>
00148         <a class="code" href="shader_8h.html#a876a230">miM_GEOTE</a>,              <span class="comment">/* GEO tessellation */</span>
00149         <a class="code" href="shader_8h.html#a876a231">miM_JPG</a>,                <span class="comment">/* JPEG compression/decompression */</span>
00150         <a class="code" href="shader_8h.html#a876a232">miM_RCFG</a>,               <span class="comment">/* Final gathering */</span>
00151         <a class="code" href="shader_8h.html#a876a233">miNMODULES</a>              <span class="comment">/* # of modules (not a module itself) */</span>
00152 } <a class="code" href="shader_8h.html#a876">miModule</a>;
00153 <span class="preprocessor">#ifndef M_PI</span>
<a name="l00154"></a><a class="code" href="shader_8h.html#a9">00154</a> <span class="preprocessor"></span><span class="preprocessor">#define M_PI            3.14159265358979323846</span>
00155 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00156 <span class="preprocessor"></span><span class="preprocessor">#ifndef M_PI_2</span>
<a name="l00157"></a><a class="code" href="shader_8h.html#a10">00157</a> <span class="preprocessor"></span><span class="preprocessor">#define M_PI_2          1.57079632679489661923</span>
00158 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00159 <span class="preprocessor"></span><span class="preprocessor">#ifndef M_SQRT1_2</span>
<a name="l00160"></a><a class="code" href="shader_8h.html#a11">00160</a> <span class="preprocessor"></span><span class="preprocessor">#define M_SQRT1_2       0.70710678118654752440</span>
00161 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00162"></a><a class="code" href="shader_8h.html#a12">00162</a> <span class="preprocessor"></span><span class="preprocessor">#define RAY2                    </span><span class="comment">/* for shaders that share sources with 1.9 */</span>
<a name="l00163"></a><a class="code" href="shader_8h.html#a13">00163</a> <span class="preprocessor">#define RAY3                    </span><span class="comment">/* for shaders that share sources with 2.x */</span>
<a name="l00164"></a><a class="code" href="shader_8h.html#a14">00164</a> <span class="preprocessor">#define RAY31                   </span><span class="comment">/* for shaders that share sources with 3.0 */</span>
<a name="l00165"></a><a class="code" href="shader_8h.html#a15">00165</a> <span class="preprocessor">#define RAY32                   </span><span class="comment">/* for shaders that share sources with 3.1 */</span>
00166 <span class="preprocessor">#ifdef _WIN32</span>
00167 <span class="preprocessor"></span><span class="preprocessor">#define DLLIMPORT __declspec(dllexport)</span>
00168 <span class="preprocessor"></span><span class="preprocessor">#define DLLEXPORT __declspec(dllexport)</span>
00169 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00170"></a><a class="code" href="shader_8h.html#a16">00170</a> <span class="preprocessor"></span><span class="preprocessor">#define DLLIMPORT</span>
<a name="l00171"></a><a class="code" href="shader_8h.html#a17">00171</a> <span class="preprocessor"></span><span class="preprocessor">#define DLLEXPORT</span>
00172 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00173 <span class="preprocessor"></span>
00174 <span class="comment">/*------------ mi_lib.h ------------*/</span>
00175 
00176 <span class="comment">/*</span>
00177 <span class="comment"> * vector operations. MI_SQRT works for ANSI C compilers. If it causes trouble,</span>
00178 <span class="comment"> * #define MI_SQRT sqrt before including this file. IBM and HP mess up as usual.</span>
00179 <span class="comment"> */</span>
00180 
00181 <span class="preprocessor">#ifndef MI_SQRT</span>
00182 <span class="preprocessor"></span><span class="preprocessor">#ifdef IRIX</span>
00183 <span class="preprocessor"></span><span class="preprocessor">#define MI_SQRT sqrtf</span>
00184 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00185"></a><a class="code" href="shader_8h.html#a18">00185</a> <span class="preprocessor"></span><span class="preprocessor">#define MI_SQRT sqrt</span>
00186 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00187 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00188 <span class="preprocessor"></span>
<a name="l00189"></a><a class="code" href="shader_8h.html#a19">00189</a> <span class="preprocessor">#define mi_vector_neg(r)        ((r)-&gt;x = -(r)-&gt;x,\</span>
00190 <span class="preprocessor">                                 (r)-&gt;y = -(r)-&gt;y,\</span>
00191 <span class="preprocessor">                                 (r)-&gt;z = -(r)-&gt;z)</span>
00192 <span class="preprocessor"></span>
<a name="l00193"></a><a class="code" href="shader_8h.html#a20">00193</a> <span class="preprocessor">#define mi_vector_add(r,a,b)    ((r)-&gt;x = (a)-&gt;x + (b)-&gt;x,\</span>
00194 <span class="preprocessor">                                 (r)-&gt;y = (a)-&gt;y + (b)-&gt;y,\</span>
00195 <span class="preprocessor">                                 (r)-&gt;z = (a)-&gt;z + (b)-&gt;z)</span>
00196 <span class="preprocessor"></span>
<a name="l00197"></a><a class="code" href="shader_8h.html#a21">00197</a> <span class="preprocessor">#define mi_vector_sub(r,a,b)    ((r)-&gt;x = (a)-&gt;x - (b)-&gt;x,\</span>
00198 <span class="preprocessor">                                 (r)-&gt;y = (a)-&gt;y - (b)-&gt;y,\</span>
00199 <span class="preprocessor">                                 (r)-&gt;z = (a)-&gt;z - (b)-&gt;z)</span>
00200 <span class="preprocessor"></span>
<a name="l00201"></a><a class="code" href="shader_8h.html#a22">00201</a> <span class="preprocessor">#define mi_vector_mul(r,f)      ((r)-&gt;x *= (f),\</span>
00202 <span class="preprocessor">                                 (r)-&gt;y *= (f),\</span>
00203 <span class="preprocessor">                                 (r)-&gt;z *= (f))</span>
00204 <span class="preprocessor"></span>
<a name="l00205"></a><a class="code" href="shader_8h.html#a23">00205</a> <span class="preprocessor">#define mi_vector_div(r,d)      do {if ((d) != 0.0f)\</span>
00206 <span class="preprocessor">                                        {register miScalar _i=1.0f/(d);\</span>
00207 <span class="preprocessor">                                                 (r)-&gt;x *= _i;\</span>
00208 <span class="preprocessor">                                                 (r)-&gt;y *= _i;\</span>
00209 <span class="preprocessor">                                                 (r)-&gt;z *= _i; }} while (0)</span>
00210 <span class="preprocessor"></span>
<a name="l00211"></a><a class="code" href="shader_8h.html#a24">00211</a> <span class="preprocessor">#define mi_vector_div_d(r,d)    do {if ((d) != 0.0)\</span>
00212 <span class="preprocessor">                                        {register double _i = 1.0/(d);\</span>
00213 <span class="preprocessor">                                                 (r)-&gt;x *= _i;\</span>
00214 <span class="preprocessor">                                                 (r)-&gt;y *= _i;\</span>
00215 <span class="preprocessor">                                                 (r)-&gt;z *= _i; }} while (0)</span>
00216 <span class="preprocessor"></span>
<a name="l00217"></a><a class="code" href="shader_8h.html#a25">00217</a> <span class="preprocessor">#define mi_vector_prod(r,a,b)   ((r)-&gt;x = (a)-&gt;y * (b)-&gt;z - (a)-&gt;z * (b)-&gt;y,\</span>
00218 <span class="preprocessor">                                 (r)-&gt;y = (a)-&gt;z * (b)-&gt;x - (a)-&gt;x * (b)-&gt;z,\</span>
00219 <span class="preprocessor">                                 (r)-&gt;z = (a)-&gt;x * (b)-&gt;y - (a)-&gt;y * (b)-&gt;x)</span>
00220 <span class="preprocessor"></span>
<a name="l00221"></a><a class="code" href="shader_8h.html#a26">00221</a> <span class="preprocessor">#define mi_vector_dot(a,b)      ((a)-&gt;x * (b)-&gt;x +\</span>
00222 <span class="preprocessor">                                 (a)-&gt;y * (b)-&gt;y +\</span>
00223 <span class="preprocessor">                                 (a)-&gt;z * (b)-&gt;z)</span>
00224 <span class="preprocessor"></span>
<a name="l00225"></a><a class="code" href="shader_8h.html#a27">00225</a> <span class="preprocessor">#define mi_vector_dot_d(a,b)    ((double)(a)-&gt;x * (double)(b)-&gt;x +\</span>
00226 <span class="preprocessor">                                 (double)(a)-&gt;y * (double)(b)-&gt;y +\</span>
00227 <span class="preprocessor">                                 (double)(a)-&gt;z * (double)(b)-&gt;z)</span>
00228 <span class="preprocessor"></span>
<a name="l00229"></a><a class="code" href="shader_8h.html#a28">00229</a> <span class="preprocessor">#define mi_vector_norm(r)       (miScalar)MI_SQRT((r)-&gt;x * (r)-&gt;x +\</span>
00230 <span class="preprocessor">                                        (r)-&gt;y * (r)-&gt;y +\</span>
00231 <span class="preprocessor">                                        (r)-&gt;z * (r)-&gt;z)</span>
00232 <span class="preprocessor"></span>
<a name="l00233"></a><a class="code" href="shader_8h.html#a29">00233</a> <span class="preprocessor">#define mi_vector_norm_d(r)     sqrt((double)(r)-&gt;x * (double)(r)-&gt;x +\</span>
00234 <span class="preprocessor">                                     (double)(r)-&gt;y * (double)(r)-&gt;y +\</span>
00235 <span class="preprocessor">                                     (double)(r)-&gt;z * (double)(r)-&gt;z)</span>
00236 <span class="preprocessor"></span>
<a name="l00237"></a><a class="code" href="shader_8h.html#a30">00237</a> <span class="preprocessor">#define mi_vector_normalize(r)  do { register miScalar _n = mi_vector_norm(r);\</span>
00238 <span class="preprocessor">                                     mi_vector_div(r, _n); } while (0)</span>
00239 <span class="preprocessor"></span>
<a name="l00240"></a><a class="code" href="shader_8h.html#a31">00240</a> <span class="preprocessor">#define mi_vector_normalize_d(r) do { register double _n= mi_vector_norm_d(r);\</span>
00241 <span class="preprocessor">                                     mi_vector_div_d(r, _n); } while (0)</span>
00242 <span class="preprocessor"></span>
<a name="l00243"></a><a class="code" href="shader_8h.html#a32">00243</a> <span class="preprocessor">#define mi_vector_min(r,a,b)    ((a)-&gt;x &lt; (b)-&gt;x ? ((r)-&gt;x = (a)-&gt;x) \</span>
00244 <span class="preprocessor">                                                 : ((r)-&gt;x = (b)-&gt;x),\</span>
00245 <span class="preprocessor">                                 (a)-&gt;y &lt; (b)-&gt;y ? ((r)-&gt;y = (a)-&gt;y) \</span>
00246 <span class="preprocessor">                                                 : ((r)-&gt;y = (b)-&gt;y),\</span>
00247 <span class="preprocessor">                                 (a)-&gt;z &lt; (b)-&gt;z ? ((r)-&gt;z = (a)-&gt;z) \</span>
00248 <span class="preprocessor">                                                 : ((r)-&gt;z = (b)-&gt;z))</span>
00249 <span class="preprocessor"></span>
<a name="l00250"></a><a class="code" href="shader_8h.html#a33">00250</a> <span class="preprocessor">#define mi_vector_max(r,a,b)    ((a)-&gt;x &gt; (b)-&gt;x ? ((r)-&gt;x = (a)-&gt;x) \</span>
00251 <span class="preprocessor">                                                 : ((r)-&gt;x = (b)-&gt;x),\</span>
00252 <span class="preprocessor">                                 (a)-&gt;y &gt; (b)-&gt;y ? ((r)-&gt;y = (a)-&gt;y) \</span>
00253 <span class="preprocessor">                                                 : ((r)-&gt;y = (b)-&gt;y),\</span>
00254 <span class="preprocessor">                                 (a)-&gt;z &gt; (b)-&gt;z ? ((r)-&gt;z = (a)-&gt;z) \</span>
00255 <span class="preprocessor">                                                 : ((r)-&gt;z = (b)-&gt;z))</span>
00256 <span class="preprocessor"></span>
<a name="l00257"></a><a class="code" href="shader_8h.html#a34">00257</a> <span class="preprocessor">#define mi_vector_det(a,b,c)    ((a)-&gt;x * ((b)-&gt;y * (c)-&gt;z - (c)-&gt;y * (b)-&gt;z)+\</span>
00258 <span class="preprocessor">                                 (b)-&gt;x * ((c)-&gt;y * (a)-&gt;z - (a)-&gt;y * (c)-&gt;z)+\</span>
00259 <span class="preprocessor">                                 (c)-&gt;x * ((a)-&gt;y * (b)-&gt;z - (b)-&gt;y * (a)-&gt;z))</span>
00260 <span class="preprocessor"></span>
<a name="l00261"></a><a class="code" href="shader_8h.html#a35">00261</a> <span class="preprocessor">#define mi_vector_dist(a,b)     MI_SQRT(((a)-&gt;x - (b)-&gt;x) * ((a)-&gt;x - (b)-&gt;x)+\</span>
00262 <span class="preprocessor">                                        ((a)-&gt;y - (b)-&gt;y) * ((a)-&gt;y - (b)-&gt;y)+\</span>
00263 <span class="preprocessor">                                        ((a)-&gt;z - (b)-&gt;z) * ((a)-&gt;z - (b)-&gt;z))</span>
00264 <span class="preprocessor"></span>
00265 <span class="comment">/*</span>
00266 <span class="comment"> * matrix operations (libmatrix.c)</span>
00267 <span class="comment"> */</span>
00268 
<a name="l00269"></a><a class="code" href="shader_8h.html#a36">00269</a> <span class="preprocessor">#define   mi_matrix_copy(t,s)           (void)memcpy((t),(s),sizeof(miMatrix))</span>
<a name="l00270"></a><a class="code" href="shader_8h.html#a37">00270</a> <span class="preprocessor"></span><span class="preprocessor">#define   mi_matrix_null(m)             (void)memset((m), 0, sizeof(miMatrix))</span>
00271 <span class="preprocessor"></span>
00272 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a636">mi_matrix_ident</a>         (miMatrix);
00273 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a637">mi_matrix_prod</a>          (miMatrix,
00274                                          miMatrix <span class="keyword">const</span>,
00275                                          miMatrix <span class="keyword">const</span>);
00276 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a638">mi_matrix_isident</a>       (miMatrix <span class="keyword">const</span>);
00277 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a639">mi_matrix_isnull</a>        (miMatrix <span class="keyword">const</span>);
00278 <span class="keywordtype">float</span>           <a class="code" href="shader_8h.html#a640">mi_matrix_rot_det</a>       (miMatrix <span class="keyword">const</span>);
00279 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a641">mi_matrix_invert</a>        (miMatrix, miMatrix <span class="keyword">const</span>);
00280 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a642">mi_point_transform</a>      (<a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>,
00281                                          <a class="code" href="structmiVector.html">miVector</a> <span class="keyword">const</span> * <span class="keyword">const</span>,
00282                                          miMatrix <span class="keyword">const</span>);
00283 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a643">mi_vector_transform</a>     (<a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>,
00284                                          <a class="code" href="structmiVector.html">miVector</a> <span class="keyword">const</span> * <span class="keyword">const</span>,
00285                                          miMatrix <span class="keyword">const</span>);
00286 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a644">mi_vector_transform_T</a>   (<a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>,
00287                                          <a class="code" href="structmiVector.html">miVector</a> <span class="keyword">const</span> * <span class="keyword">const</span>,
00288                                          miMatrix <span class="keyword">const</span>);
00289 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a645">mi_matrix_rotate</a>        (miMatrix, <span class="keyword">const</span> miScalar,
00290                                          <span class="keyword">const</span> miScalar, <span class="keyword">const</span> miScalar);
00291 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a646">mi_matrix_rotate_axis</a>   (miMatrix, <a class="code" href="structmiVector.html">miVector</a> <span class="keyword">const</span> * <span class="keyword">const</span>,
00292                                          miScalar <span class="keyword">const</span>);
00293 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a647">mi_matrix_solve</a>         (miScalar *, miMatrix <span class="keyword">const</span>,
00294                                          miScalar <span class="keyword">const</span> *, <span class="keywordtype">int</span>);
00295 
00296 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a648">mi_spline</a>               (miScalar, <span class="keyword">const</span> <span class="keywordtype">int</span>, miScalar *<span class="keyword">const</span>);
00297 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a649">mi_random</a>               (<span class="keywordtype">void</span>);
00298 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a650">mi_erandom</a>              (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> seed[3]);
00299 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a651">mi_srandom</a>              (<span class="keywordtype">long</span> newseed);
00300 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a652">mi_noise_1d</a>             (<span class="keyword">const</span> miScalar);
00301 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a653">mi_unoise_1d</a>            (<span class="keyword">const</span> miScalar);
00302 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a654">mi_noise_2d</a>             (<span class="keyword">const</span> miScalar, <span class="keyword">const</span> miScalar);
00303 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a655">mi_unoise_2d</a>            (<span class="keyword">const</span> miScalar, <span class="keyword">const</span> miScalar);
00304 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a656">mi_noise_3d</a>             (<a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>);
00305 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a657">mi_unoise_3d</a>            (<a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>);
00306 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a658">mi_noise_1d_grad</a>        (<span class="keyword">const</span> miScalar, miScalar * <span class="keyword">const</span>);
00307 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a659">mi_unoise_1d_grad</a>       (<span class="keyword">const</span> miScalar, miScalar * <span class="keyword">const</span>);
00308 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a660">mi_noise_2d_grad</a>        (<span class="keyword">const</span> miScalar, <span class="keyword">const</span> miScalar,
00309                                          miScalar * <span class="keyword">const</span>, miScalar * <span class="keyword">const</span>);
00310 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a661">mi_unoise_2d_grad</a>       (<span class="keyword">const</span> miScalar, <span class="keyword">const</span> miScalar,
00311                                          miScalar * <span class="keyword">const</span>, miScalar * <span class="keyword">const</span>);
00312 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a662">mi_noise_3d_grad</a>        (<a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>);
00313 <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="shader_8h.html#a663">mi_unoise_3d_grad</a>       (<a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>);
00314 
00315 
00316 <span class="comment">/*</span>
00317 <span class="comment"> * error handler: severity levels for mi_set_verbosity (miERR_*), and</span>
00318 <span class="comment"> * sub-levels to turn on individual message types per module (miMSG_*).</span>
00319 <span class="comment"> */</span>
00320 
00321 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a664">mi_fatal</a>                (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, ...);
00322 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a665">mi_error</a>                (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, ...);
00323 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a666">mi_warning</a>              (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, ...);
00324 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a667">mi_info</a>                 (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, ...);
00325 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a668">mi_progress</a>             (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, ...);
00326 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a669">mi_debug</a>                (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, ...);
00327 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a670">mi_vdebug</a>               (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, ...);
00328 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a671">mi_nfatal</a>               (<span class="keyword">const</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, ...);
00329 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a672">mi_nerror</a>               (<span class="keyword">const</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, ...);
00330 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a673">mi_nwarning</a>             (<span class="keyword">const</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, ...);
00331 <span class="keywordtype">char</span>            *<a class="code" href="shader_8h.html#a674">mi_strerror</a>            (<span class="keywordtype">void</span>);
00332 
00333 <span class="keywordtype">char</span> *<a class="code" href="shader_8h.html#a675">mi_string_substitute</a>(     <span class="comment">/* apply dos/unix etc path substns */</span>
00334         <span class="keywordtype">char</span>    *new_name,              <span class="comment">/* place to copy mangled path */</span>
00335         <span class="keywordtype">char</span>    *name,                  <span class="comment">/* path to be mangled */</span>
00336         <span class="keywordtype">long</span>    max_new_name_len);      <span class="comment">/* size of new_name[] */</span>
00337 <span class="keyword">struct </span><a class="code" href="structmiState.html">miState</a>;
00338 <a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="shader_8h.html#a676">mi_luminance</a>(<span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a> *state, <a class="code" href="structmiColor.html">miColor</a> *c);
<a name="l00339"></a><a class="code" href="shader_8h.html#a877">00339</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
00340         <a class="code" href="shader_8h.html#a877a234">miQ_NONE</a>                        = 0,
00341         <a class="code" href="shader_8h.html#a877a235">miQ_VERSION</a>                     = 1,
00342         <a class="code" href="shader_8h.html#a877a236">miQ_DATE</a>                        = 2,
00343         <a class="code" href="shader_8h.html#a877a237">miQ_INST_FUNCTION</a>               = 3,
00344         <a class="code" href="shader_8h.html#a877a238">miQ_INST_GLOBAL_TO_LOCAL</a>        = 4,
00345         <a class="code" href="shader_8h.html#a877a239">miQ_INST_LOCAL_TO_GLOBAL</a>        = 5,
00346         <a class="code" href="shader_8h.html#a877a240">miQ_INST_IDENTITY</a>               = 6,
00347         <a class="code" href="shader_8h.html#a877a241">miQ_INST_ITEM</a>                   = 7,
00348         <a class="code" href="shader_8h.html#a877a242">miQ_INST_PARENT</a>                 = 8,
00349         <a class="code" href="shader_8h.html#a877a243">miQ_INST_HIDE</a>                   = 9,
00350         <a class="code" href="shader_8h.html#a877a244">miQ_INST_VISIBLE</a>                = 90,
00351         <a class="code" href="shader_8h.html#a877a245">miQ_INST_SHADOW</a>                 = 91,
00352         <a class="code" href="shader_8h.html#a877a246">miQ_INST_TRACE</a>                  = 92,
00353         <a class="code" href="shader_8h.html#a877a247">miQ_INST_CAUSTIC</a>                = 93,
00354         <a class="code" href="shader_8h.html#a877a248">miQ_INST_GLOBILLUM</a>              = 111,
00355         <a class="code" href="shader_8h.html#a877a249">miQ_INST_DECL</a>                   = 10,
00356         <a class="code" href="shader_8h.html#a877a250">miQ_INST_PARAM_SIZE</a>             = 11,
00357         <a class="code" href="shader_8h.html#a877a251">miQ_INST_PARAM</a>                  = 12,
00358         <a class="code" href="shader_8h.html#a877a252">miQ_INST_MATERIAL</a>               = 83,
00359         <a class="code" href="shader_8h.html#a877a253">miQ_INST_LABEL</a>                  = 101,
00360         <a class="code" href="shader_8h.html#a877a254">miQ_INST_DATA</a>                   = 102,
00361         <a class="code" href="shader_8h.html#a877a255">miQ_INST_AREA</a>                   = 125, 
00362         <a class="code" href="shader_8h.html#a877a256">miQ_GROUP_MERGE_GROUP</a>           = 13,
00363         <a class="code" href="shader_8h.html#a877a257">miQ_GROUP_NKIDS</a>                 = 14,
00364         <a class="code" href="shader_8h.html#a877a258">miQ_GROUP_KID</a>                   = 15,
00365         <a class="code" href="shader_8h.html#a877a259">miQ_GROUP_LABEL</a>                 = 103,
00366         <a class="code" href="shader_8h.html#a877a260">miQ_GROUP_DATA</a>                  = 104,
00367         <a class="code" href="shader_8h.html#a877a261">miQ_OBJ_TYPE</a>                    = 16,
00368         <a class="code" href="shader_8h.html#a877a262">miQ_OBJ_VISIBLE</a>                 = 17,
00369         <a class="code" href="shader_8h.html#a877a263">miQ_OBJ_TRACE</a>                   = 18,
00370         <a class="code" href="shader_8h.html#a877a264">miQ_OBJ_SHADOW</a>                  = 19,
00371         <a class="code" href="shader_8h.html#a877a265">miQ_OBJ_VIEW_DEPENDENT</a>          = 20,
00372         <a class="code" href="shader_8h.html#a877a266">miQ_OBJ_CAUSTIC</a>                 = 21,
00373         <a class="code" href="shader_8h.html#a877a267">miQ_OBJ_GLOBILLUM</a>               = 112,
00374         <a class="code" href="shader_8h.html#a877a268">miQ_OBJ_LABEL</a>                   = 22,
00375         <a class="code" href="shader_8h.html#a877a269">miQ_OBJ_DATA</a>                    = 100,
00376         <a class="code" href="shader_8h.html#a877a270">miQ_LIGHT_TYPE</a>                  = 23,
00377         <a class="code" href="shader_8h.html#a877a271">miQ_LIGHT_AREA</a>                  = 24,
00378         <a class="code" href="shader_8h.html#a877a272">miQ_LIGHT_EXPONENT</a>              = 25,
00379         <a class="code" href="shader_8h.html#a877a273">miQ_LIGHT_CAUSTIC_PHOTONS</a>       = 26,
00380         <a class="code" href="shader_8h.html#a877a274">miQ_LIGHT_CAUSTIC_PHOTONS_EMIT</a>  = 135,
00381         <a class="code" href="shader_8h.html#a877a275">miQ_LIGHT_CAUSTIC_PHOTONS_EMITTED</a>       = 144,
00382         <a class="code" href="shader_8h.html#a877a276">miQ_LIGHT_GLOBAL_PHOTONS</a>        = 27,
00383         <a class="code" href="shader_8h.html#a877a277">miQ_LIGHT_GLOBAL_PHOTONS_EMIT</a>   = 136,
00384         <a class="code" href="shader_8h.html#a877a278">miQ_LIGHT_GLOBAL_PHOTONS_EMITTED</a>        = 145,
00385         <a class="code" href="shader_8h.html#a877a279">miQ_LIGHT_ENERGY</a>                = 28,
00386         <a class="code" href="shader_8h.html#a877a280">miQ_LIGHT_SHADER</a>                = 29,
00387         <a class="code" href="shader_8h.html#a877a281">miQ_LIGHT_EMITTER</a>               = 30,
00388         <a class="code" href="shader_8h.html#a877a282">miQ_LIGHT_ORIGIN</a>                = 31,
00389         <a class="code" href="shader_8h.html#a877a283">miQ_LIGHT_DIRECTION</a>             = 32,
00390         <a class="code" href="shader_8h.html#a877a284">miQ_LIGHT_AREA_R_EDGE_U</a>         = 33,
00391         <a class="code" href="shader_8h.html#a877a285">miQ_LIGHT_AREA_R_EDGE_V</a>         = 34,
00392         <a class="code" href="shader_8h.html#a877a286">miQ_LIGHT_AREA_D_NORMAL</a>         = 35,
00393         <a class="code" href="shader_8h.html#a877a287">miQ_LIGHT_AREA_D_RADIUS</a>         = 36,
00394         <a class="code" href="shader_8h.html#a877a288">miQ_LIGHT_AREA_S_RADIUS</a>         = 37,
00395         <a class="code" href="shader_8h.html#a877a289">miQ_LIGHT_AREA_C_RADIUS</a>         = 96,
00396         <a class="code" href="shader_8h.html#a877a290">miQ_LIGHT_AREA_C_AXIS</a>           = 97,
00397         <a class="code" href="shader_8h.html#a877a291">miQ_LIGHT_AREA_SAMPLES_U</a>        = 38,
00398         <a class="code" href="shader_8h.html#a877a292">miQ_LIGHT_AREA_SAMPLES_V</a>        = 39,
00399         <a class="code" href="shader_8h.html#a877a293">miQ_LIGHT_SPREAD</a>                = 40,
00400         <a class="code" href="shader_8h.html#a877a294">miQ_LIGHT_USE_SHADOWMAP</a>         = 41,
00401         <a class="code" href="shader_8h.html#a877a295">miQ_LIGHT_LABEL</a>                 = 98,
00402         <a class="code" href="shader_8h.html#a877a296">miQ_LIGHT_DATA</a>                  = 99,
00403         <a class="code" href="shader_8h.html#a877a297">miQ_MTL_OPAQUE</a>                  = 42,
00404         <a class="code" href="shader_8h.html#a877a298">miQ_MTL_SHADER</a>                  = 43,
00405         <a class="code" href="shader_8h.html#a877a299">miQ_MTL_DISPLACE</a>                = 44,
00406         <a class="code" href="shader_8h.html#a877a300">miQ_MTL_SHADOW</a>                  = 45,
00407         <a class="code" href="shader_8h.html#a877a301">miQ_MTL_VOLUME</a>                  = 46,
00408         <a class="code" href="shader_8h.html#a877a302">miQ_MTL_ENVIRONMENT</a>             = 47,
00409         <a class="code" href="shader_8h.html#a877a303">miQ_MTL_CONTOUR</a>                 = 48,
00410         <a class="code" href="shader_8h.html#a877a304">miQ_MTL_PHOTON</a>                  = 49,
00411         <a class="code" href="shader_8h.html#a877a305">miQ_MTL_PHOTONVOL</a>               = 50,
00412         <a class="code" href="shader_8h.html#a877a306">miQ_FUNC_USERPTR</a>                = 51,
00413         <a class="code" href="shader_8h.html#a877a307">miQ_FUNC_LOCK</a>                   = 52,
00414         <a class="code" href="shader_8h.html#a877a308">miQ_FUNC_TYPE</a>                   = 53,
00415         <a class="code" href="shader_8h.html#a877a309">miQ_FUNC_DECL</a>                   = 54,
00416         <a class="code" href="shader_8h.html#a877a310">miQ_FUNC_NEXT</a>                   = 55,
00417         <a class="code" href="shader_8h.html#a877a311">miQ_FUNC_INDIRECT</a>               = 56,
00418         <a class="code" href="shader_8h.html#a877a312">miQ_FUNC_PARAM_SIZE</a>             = 57,
00419         <a class="code" href="shader_8h.html#a877a313">miQ_FUNC_RESULT_SIZE</a>            = 58,
00420         <a class="code" href="shader_8h.html#a877a314">miQ_FUNC_PARAM</a>                  = 59,
00421         <a class="code" href="shader_8h.html#a877a315">miQ_FUNC_TLS_GET</a>                = 124,
00422         <a class="code" href="shader_8h.html#a877a316">miQ_FUNC_TLS_SET</a>                = 126,
00423         <a class="code" href="shader_8h.html#a877a317">miQ_FUNC_TLS_GETALL</a>             = 127,
00424         <a class="code" href="shader_8h.html#a877a318">miQ_FUNC_CALLTYPE</a>               = 140,
00425         <a class="code" href="shader_8h.html#a877a319">miQ_FUNC_TAG</a>                    = 141,
00426         <a class="code" href="shader_8h.html#a877a320">miQ_DECL_LOCK</a>                   = 60,
00427         <a class="code" href="shader_8h.html#a877a321">miQ_DECL_TYPE</a>                   = 61,
00428         <a class="code" href="shader_8h.html#a877a322">miQ_DECL_RESULT_SIZE</a>            = 62,
00429         <a class="code" href="shader_8h.html#a877a323">miQ_DECL_NAME</a>                   = 63,
00430         <a class="code" href="shader_8h.html#a877a324">miQ_DECL_PARAM</a>                  = 64,
00431         <a class="code" href="shader_8h.html#a877a325">miQ_DECL_VERSION</a>                = 89,
00432         <a class="code" href="shader_8h.html#a877a326">miQ_IMAGE_WIDTH</a>                 = 65,
00433         <a class="code" href="shader_8h.html#a877a327">miQ_IMAGE_HEIGHT</a>                = 66,
00434         <a class="code" href="shader_8h.html#a877a328">miQ_IMAGE_BITS</a>                  = 67,
00435         <a class="code" href="shader_8h.html#a877a329">miQ_IMAGE_COMP</a>                  = 68,
00436         <a class="code" href="shader_8h.html#a877a330">miQ_IMAGE_FILTER</a>                = 69,
00437         <a class="code" href="shader_8h.html#a877a331">miQ_IMAGE_DESATURATE</a>            = 85,
00438         <a class="code" href="shader_8h.html#a877a332">miQ_IMAGE_DITHER</a>                = 86,
00439         <a class="code" href="shader_8h.html#a877a333">miQ_IMAGE_NOPREMULT</a>             = 87,
00440         <a class="code" href="shader_8h.html#a877a334">miQ_IMAGE_GAMMA</a>                 = 88,
00441         <a class="code" href="shader_8h.html#a877a335">miQ_IMAGE_COLORCLIP</a>             = 115,
00442         <a class="code" href="shader_8h.html#a877a336">miQ_NUM_GLOBAL_LIGHTS</a>           = 70,
00443         <a class="code" href="shader_8h.html#a877a337">miQ_GLOBAL_LIGHTS</a>               = 71,
00444         <a class="code" href="shader_8h.html#a877a338">miQ_TRANS_INTERNAL_TO_WORLD</a>     = 72,
00445         <a class="code" href="shader_8h.html#a877a339">miQ_TRANS_INTERNAL_TO_CAMERA</a>    = 73,
00446         <a class="code" href="shader_8h.html#a877a340">miQ_TRANS_INTERNAL_TO_OBJECT</a>    = 74,
00447         <a class="code" href="shader_8h.html#a877a341">miQ_TRANS_WORLD_TO_INTERNAL</a>     = 75,
00448         <a class="code" href="shader_8h.html#a877a342">miQ_TRANS_CAMERA_TO_INTERNAL</a>    = 76,
00449         <a class="code" href="shader_8h.html#a877a343">miQ_TRANS_OBJECT_TO_INTERNAL</a>    = 77,
00450         <a class="code" href="shader_8h.html#a877a344">miQ_TRANS_WORLD_TO_CAMERA</a>       = 78,
00451         <a class="code" href="shader_8h.html#a877a345">miQ_TRANS_WORLD_TO_OBJECT</a>       = 79,
00452         <a class="code" href="shader_8h.html#a877a346">miQ_TRANS_CAMERA_TO_WORLD</a>       = 80,
00453         <a class="code" href="shader_8h.html#a877a347">miQ_TRANS_OBJECT_TO_WORLD</a>       = 81,
00454         <a class="code" href="shader_8h.html#a877a348">miQ_NUM_TEXTURES</a>                = 82,
00455         <a class="code" href="shader_8h.html#a877a349">miQ_NUM_BUMPS</a>                   = 137,
00456         <a class="code" href="shader_8h.html#a877a350">miQ_GEO_LABEL</a>                   = 84,
00457         <a class="code" href="shader_8h.html#a877a351">miQ_GEO_DATA</a>                    = 114,
00458         <a class="code" href="shader_8h.html#a877a352">miQ_GEO_HAS_DERIVS</a>              = 138,
00459         <a class="code" href="shader_8h.html#a877a353">miQ_GEO_HAS_DERIVS2</a>             = 139,
00460         <a class="code" href="shader_8h.html#a877a354">miQ_PRI_BBOX_MIN</a>                = 94,
00461         <a class="code" href="shader_8h.html#a877a355">miQ_PRI_BBOX_MAX</a>                = 95,
00462         <a class="code" href="shader_8h.html#a877a356">miQ_DATA_PARAM</a>                  = 105,
00463         <a class="code" href="shader_8h.html#a877a357">miQ_DATA_DECL</a>                   = 106,
00464         <a class="code" href="shader_8h.html#a877a358">miQ_DATA_NEXT</a>                   = 107,
00465         <a class="code" href="shader_8h.html#a877a359">miQ_DATA_LABEL</a>                  = 108,
00466         <a class="code" href="shader_8h.html#a877a360">miQ_DATA_PARAM_SIZE</a>             = 109,
00467         <a class="code" href="shader_8h.html#a877a361">miQ_DATA_NEEDSWAP</a>               = 110,
00468         <a class="code" href="shader_8h.html#a877a362">miQ_TILE_PIXELS</a>                 = 116,
00469         <a class="code" href="shader_8h.html#a877a363">miQ_TILE_SAMPLES</a>                = 117,
00470         <a class="code" href="shader_8h.html#a877a364">miQ_FINALGATHER_STATE</a>           = 142,
00471         <a class="code" href="shader_8h.html#a877a365">miQ_SCENE_BBOX_ALL</a>              = 118,
00472         <a class="code" href="shader_8h.html#a877a366">miQ_SCENE_BBOX_SHADOW</a>           = 119,
00473         <a class="code" href="shader_8h.html#a877a367">miQ_SCENE_BBOX_GLOBILLUM_G</a>      = 120,
00474         <a class="code" href="shader_8h.html#a877a368">miQ_SCENE_BBOX_GLOBILLUM_R</a>      = 121,
00475         <a class="code" href="shader_8h.html#a877a369">miQ_SCENE_BBOX_CAUSTIC_G</a>        = 122,
00476         <a class="code" href="shader_8h.html#a877a370">miQ_SCENE_BBOX_CAUSTIC_R</a>        = 123,
00477         <a class="code" href="shader_8h.html#a877a371">miQ_LIGHTPROFILE_PHI_MIN</a>        = 128,
00478         <a class="code" href="shader_8h.html#a877a372">miQ_LIGHTPROFILE_PHI_MAX</a>        = 129,
00479         <a class="code" href="shader_8h.html#a877a373">miQ_LIGHTPROFILE_COSTHETA_MIN</a>   = 130,
00480         <a class="code" href="shader_8h.html#a877a374">miQ_LIGHTPROFILE_COSTHETA_MAX</a>   = 131,
00481         <a class="code" href="shader_8h.html#a877a375">miQ_LIGHTPROFILE_INTENSITY_MAX</a>  = 132,
00482         <a class="code" href="shader_8h.html#a877a376">miQ_LIGHTPROFILE_PHI_RES</a>        = 133,
00483         <a class="code" href="shader_8h.html#a877a377">miQ_LIGHTPROFILE_THETA_RES</a>      = 134,
00484         <a class="code" href="shader_8h.html#a877a378">miQ_PIXEL_SAMPLE</a>                = 143,
00485         <a class="code" href="shader_8h.html#a877a379">miNQ</a>                            = 144
00486 } <a class="code" href="shader_8h.html#a877">miQ_type</a>;
00487 
00488 <span class="keyword">struct </span><a class="code" href="structmiState.html">miState</a>;
00489 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a677">mi_query</a>(<span class="keyword">const</span> miQ_type, <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a> * <span class="keyword">const</span>,
00490                  miUint, <span class="keywordtype">void</span> * <span class="keyword">const</span>, ...);
<a name="l00491"></a><a class="code" href="shader_8h.html#a38">00491</a> <span class="preprocessor">#define miSS_LIFETIME_EYERAY    1       </span><span class="comment">/* for mi_shaderstate_set: delete */</span>
<a name="l00492"></a><a class="code" href="shader_8h.html#a39">00492</a> <span class="preprocessor">#define miSS_LIFETIME_RECT      2       </span><span class="comment">/* if eye ray is done, or sometime */</span>
00493                                         <span class="comment">/* later when pixel rect is finished */</span>
00494 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a678">mi_shaderstate_set</a>(
00495         <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>  *state,         <span class="comment">/* table is anchored in state-&gt;ts */</span>
00496         <span class="keywordtype">char</span>            *key,           <span class="comment">/* key to look up */</span>
00497         <span class="keywordtype">void</span>            *value,         <span class="comment">/* value to store */</span>
00498         <span class="keywordtype">int</span>             valsize,        <span class="comment">/* # of bytes in value */</span>
00499         <span class="keywordtype">int</span>             lifetime);      <span class="comment">/* 0=subrays, 1=eye ray, 2=many rays */</span>
00500 
00501 <span class="keywordtype">void</span> *<a class="code" href="shader_8h.html#a679">mi_shaderstate_get</a>(
00502         <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>  *state,         <span class="comment">/* table is anchored in state-&gt;ts */</span>
00503         <span class="keywordtype">char</span>            *key,           <span class="comment">/* key to look up */</span>
00504         <span class="keywordtype">int</span>             *valsize);      <span class="comment">/* # of bytes in key (strlen/sizeof) */</span>
00505 
00506 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a680">mi_shaderstate_enumerate</a>(
00507         <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>  *state,         <span class="comment">/* table is anchored in state-&gt;ts */</span>
00508         miBoolean       (*cb)(<span class="keywordtype">void</span> *arg, <span class="keywordtype">char</span> *key, <span class="keywordtype">void</span> *val, <span class="keywordtype">int</span> vsz, <span class="keywordtype">int</span> l),
00509         <span class="keywordtype">void</span>            *arg);          <span class="comment">/* opaque data pointer for cb */</span>
00510 
00511 <span class="comment">/*------------ mi_mem.h ------------*/</span>
00512 
00513 <span class="keyword">struct </span><a class="code" href="shader_8h.html#a154">miMemblk</a>;
<a name="l00514"></a><a class="code" href="shader_8h.html#a154">00514</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="shader_8h.html#a154">miMemblk</a> <a class="code" href="shader_8h.html#a154">miMemblk</a>;
<a name="l00515"></a><a class="code" href="shader_8h.html#a40">00515</a> <span class="preprocessor">#define mi_mem_blkcreate(s)     mi_mem_int_blkcreate    (__FILE__,__LINE__,s)</span>
<a name="l00516"></a><a class="code" href="shader_8h.html#a41">00516</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_mem_strdup(s)        mi_mem_int_strdup       (__FILE__,__LINE__,s)</span>
<a name="l00517"></a><a class="code" href="shader_8h.html#a42">00517</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_mem_release(m)       mi_mem_int_release      (__FILE__,__LINE__,m)</span>
<a name="l00518"></a><a class="code" href="shader_8h.html#a43">00518</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_mem_allocate(s)      mi_mem_int_allocate     (__FILE__,__LINE__,s)</span>
<a name="l00519"></a><a class="code" href="shader_8h.html#a44">00519</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_mem_test_allocate(s) mi_mem_int_test_allocate(__FILE__,__LINE__,s)</span>
<a name="l00520"></a><a class="code" href="shader_8h.html#a45">00520</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_mem_reallocate(m,s)  mi_mem_int_reallocate   (__FILE__,__LINE__,m,s)</span>
<a name="l00521"></a><a class="code" href="shader_8h.html#a46">00521</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_mem_test_reallocate(m,s)     mi_mem_int_test_reallocate\</span>
00522 <span class="preprocessor">                                                        (__FILE__,__LINE__,m,s)</span>
00523 <span class="preprocessor"></span><span class="keywordtype">void</span>            *<a class="code" href="shader_8h.html#a681">mi_mem_int_allocate</a>       (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, <span class="keyword">const</span> <span class="keywordtype">int</span>,
00524                                             <span class="keyword">const</span> <span class="keywordtype">int</span>);
00525 <span class="keywordtype">void</span>            *<a class="code" href="shader_8h.html#a682">mi_mem_int_test_allocate</a>  (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, <span class="keyword">const</span> <span class="keywordtype">int</span>,
00526                                             <span class="keyword">const</span> <span class="keywordtype">int</span>);
00527 <span class="keywordtype">void</span>            *<a class="code" href="shader_8h.html#a683">mi_mem_int_reallocate</a>     (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, <span class="keyword">const</span> <span class="keywordtype">int</span>,
00528                                             <span class="keywordtype">void</span> *, <span class="keyword">const</span> <span class="keywordtype">int</span>);
00529 <span class="keywordtype">void</span>            *<a class="code" href="shader_8h.html#a684">mi_mem_int_test_reallocate</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, <span class="keyword">const</span> <span class="keywordtype">int</span>,
00530                                             <span class="keywordtype">void</span> *, <span class="keyword">const</span> <span class="keywordtype">int</span>);
00531 <span class="keywordtype">void</span>             <a class="code" href="shader_8h.html#a685">mi_mem_int_release</a>        (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, <span class="keyword">const</span> <span class="keywordtype">int</span>,
00532                                             <span class="keywordtype">void</span> *);
00533 <span class="keywordtype">void</span>             <a class="code" href="shader_8h.html#a686">mi_mem_check</a>           (<span class="keywordtype">void</span>);
00534 <a class="code" href="shader_8h.html#a138">miUlong</a>          <a class="code" href="shader_8h.html#a687">mi_mem_getsize</a>         (<span class="keywordtype">void</span>);
00535 <span class="keywordtype">int</span>              <a class="code" href="shader_8h.html#a688">mi_mem_getheapsize</a>     (<span class="keywordtype">void</span>);
00536 <span class="keywordtype">int</span>              <a class="code" href="shader_8h.html#a689">mi_mem_getremain</a>       (<span class="keywordtype">void</span>);
00537 <span class="keywordtype">void</span>             <a class="code" href="shader_8h.html#a690">mi_mem_summary</a>         (<span class="keywordtype">void</span>);
00538 <span class="keywordtype">void</span>             <a class="code" href="shader_8h.html#a691">mi_mem_dump</a>            (<span class="keyword">const</span> miModule);
00539 
00540 <span class="keywordtype">char</span>            *<a class="code" href="shader_8h.html#a692">mi_mem_int_strdup</a>      (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, <span class="keyword">const</span> <span class="keywordtype">int</span>,
00541                                          <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00542 <a class="code" href="shader_8h.html#a154">miMemblk</a>        *<a class="code" href="shader_8h.html#a693">mi_mem_int_blkcreate</a>   (<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span>, <span class="keyword">const</span> <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
00543 <span class="keywordtype">void</span>             <a class="code" href="shader_8h.html#a694">mi_mem_blkdelete</a>       (miMemblk *);
00544 <span class="keywordtype">void</span>            *<a class="code" href="shader_8h.html#a695">mi_mem_blkallocate</a>     (miMemblk *);
00545 <span class="keywordtype">void</span>            *<a class="code" href="shader_8h.html#a696">mi_mem_blkfallocate</a>    (miMemblk *);
00546 <span class="keywordtype">void</span>             <a class="code" href="shader_8h.html#a697">mi_mem_blkrelease</a>      (miMemblk *, <span class="keywordtype">void</span> *);
00547 <span class="keywordtype">void</span>             <a class="code" href="shader_8h.html#a698">mi_mem_blkfrelease</a>     (miMemblk *, <span class="keywordtype">void</span> *);
00548 <span class="keywordtype">void</span>             <a class="code" href="shader_8h.html#a699">mi_mem_blkclear</a>        (miMemblk *);
00549 <span class="keywordtype">void</span>             <a class="code" href="shader_8h.html#a700">mi_mem_blkenumerate</a>    (miMemblk *, <span class="keywordtype">void</span> (*)(<span class="keywordtype">void</span> *));
00550 
00551 <span class="comment">/*------------ mi_db.h ------------*/</span>
00552 
00553 
<a name="l00554"></a><a class="code" href="shader_8h.html#a47">00554</a> <span class="preprocessor">#define miNULLTAG 0</span>
00555 <span class="preprocessor"></span><span class="keywordtype">void</span>  *<a class="code" href="shader_8h.html#a701">mi_db_access</a>(
00556                         <span class="keyword">const</span> miTag);   <span class="comment">/* tag to be accessed */</span>
00557 <span class="keywordtype">int</span>    <a class="code" href="shader_8h.html#a702">mi_db_type</a>(
00558                         <span class="keyword">const</span> miTag);   <span class="comment">/* tag to be accessed */</span>
00559 <span class="keywordtype">int</span>    <a class="code" href="shader_8h.html#a703">mi_db_size</a>(
00560                         <span class="keyword">const</span> miTag);   <span class="comment">/* tag to be accessed */</span>
00561 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a704">mi_db_isjob</a>(
00562                         <span class="keyword">const</span> miTag);   <span class="comment">/* tag to be accessed */</span>
00563 <span class="keywordtype">void</span>  *<a class="code" href="shader_8h.html#a705">mi_db_access_type</a>(
00564                         <span class="keywordtype">int</span> * <span class="keyword">const</span>,    <span class="comment">/* returned type, really miScene_type*/</span>
00565                         <span class="keyword">const</span> miTag);   <span class="comment">/* tag to be accessed */</span>
00566 <span class="keywordtype">void</span>   <a class="code" href="shader_8h.html#a706">mi_db_unpin</a>(
00567                         <span class="keyword">const</span> miTag);   <span class="comment">/* tag to be unpinned */</span>
00568 <span class="keywordtype">void</span>  *<a class="code" href="shader_8h.html#a707">mi_db_create</a>(
00569                         miTag * <span class="keyword">const</span>,  <span class="comment">/* returned new tag */</span>
00570                         <span class="keyword">const</span> <span class="keywordtype">int</span>,      <span class="comment">/* miSCENE_* type to store */</span>
00571                         <span class="keyword">const</span> <span class="keywordtype">int</span>);     <span class="comment">/* size of item in bytes */</span>
00572 <span class="keywordtype">void</span>  *<a class="code" href="shader_8h.html#a708">mi_db_realloc</a>(
00573                         <span class="keyword">const</span> miTag,    <span class="comment">/* tag to be resized */</span>
00574                         <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* new size of the db item */</span>
00575 <span class="keywordtype">void</span>   <a class="code" href="shader_8h.html#a709">mi_db_delete</a>(
00576                         <span class="keyword">const</span> miTag);   <span class="comment">/* tag to be deleted */</span>
00577 <a class="code" href="shader_8h.html#a147">miTag</a>  <a class="code" href="shader_8h.html#a710">mi_db_copy</a>(
00578                         <span class="keyword">const</span> miTag);   <span class="comment">/* source tag to duplicate */</span>
00579 <span class="keywordtype">void</span>   <a class="code" href="shader_8h.html#a711">mi_db_dump</a>(
00580                         <span class="keyword">const</span> miModule);<span class="comment">/* dump whose entries, 0=all */</span>
00581 
00582 <span class="comment">/*------------ mi_img.h ------------*/</span>
00583 
00584 <span class="comment">/*</span>
00585 <span class="comment"> * supported internal scanline types. These types are used when a file is</span>
00586 <span class="comment"> * opened and created; they specify the internal data structure but not the</span>
00587 <span class="comment"> * type of the file to be created. If you change this list, also change</span>
00588 <span class="comment"> * compatible_type[] in imgcall.c. The use as array indexes is the reason</span>
00589 <span class="comment"> * why every enumerator is assigned explicitly, to show that the numbers</span>
00590 <span class="comment"> * are important. No real type may exceed 31!</span>
00591 <span class="comment"> * miIMG_TYPE_ANY is a wildcard that disables conversion. The USER types</span>
00592 <span class="comment"> * are assigned real types in "frame buffer" statements. Defining them here</span>
00593 <span class="comment"> * allows storing them in the out_type and out_interp bitmaps in miFunction.</span>
00594 <span class="comment"> * No type should have a code &gt;31 because output statements use type bitmaps.</span>
00595 <span class="comment"> */</span>
00596 
<a name="l00597"></a><a class="code" href="shader_8h.html#a878">00597</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
00598         <a class="code" href="shader_8h.html#a878a380">miIMG_TYPE_RGBA</a>         = 0,    <span class="comment">/* 4*8  bits, color with alpha */</span>
00599         <a class="code" href="shader_8h.html#a878a381">miIMG_TYPE_RGBA_16</a>      = 1,    <span class="comment">/* 4*16 bits, color with alpha */</span>
00600         <a class="code" href="shader_8h.html#a878a382">miIMG_TYPE_RGB</a>          = 2,    <span class="comment">/* 4*8  bits, color */</span>
00601         <a class="code" href="shader_8h.html#a878a383">miIMG_TYPE_RGB_16</a>       = 3,    <span class="comment">/* 4*16 bits, color */</span>
00602         <a class="code" href="shader_8h.html#a878a384">miIMG_TYPE_A</a>            = 4,    <span class="comment">/* 1*8  bits, alpha */</span>
00603         <a class="code" href="shader_8h.html#a878a385">miIMG_TYPE_A_16</a>         = 5,    <span class="comment">/* 1*16 bits, alpha */</span>
00604         <a class="code" href="shader_8h.html#a878a386">miIMG_TYPE_S</a>            = 6,    <span class="comment">/* 1*8  bits, intensity */</span>
00605         <a class="code" href="shader_8h.html#a878a387">miIMG_TYPE_S_16</a>         = 7,    <span class="comment">/* 1*16 bits, intensity */</span>
00606         <a class="code" href="shader_8h.html#a878a388">miIMG_TYPE_VTA</a>          = 8,    <span class="comment">/* 2*16 bits, bumpmap from alpha */</span>
00607         <a class="code" href="shader_8h.html#a878a389">miIMG_TYPE_VTS</a>          = 9,    <span class="comment">/* 2*16 bits, bumpmap from intensity */</span>
00608         <a class="code" href="shader_8h.html#a878a390">miIMG_TYPE_Z</a>            = 10,   <span class="comment">/* 1*32 bits, Z coordinates (float) */</span>
00609         <a class="code" href="shader_8h.html#a878a391">miIMG_TYPE_N</a>            = 11,   <span class="comment">/* 3*32 bits, normal vectors (float) */</span>
00610         <a class="code" href="shader_8h.html#a878a392">miIMG_TYPE_M</a>            = 14,   <span class="comment">/* 3*32 bits, motion vectors (float) */</span>
00611         <a class="code" href="shader_8h.html#a878a393">miIMG_TYPE_TAG</a>          = 12,   <span class="comment">/* 1*32 bits, material tags (u int) */</span>
00612         <a class="code" href="shader_8h.html#a878a394">miIMG_TYPE_BIT</a>          = 15,   <span class="comment">/* 1*1  bit,  must-render flag map */</span>
00613         <a class="code" href="shader_8h.html#a878a395">miIMG_TYPE_RGBA_FP</a>      = 13,   <span class="comment">/* 4*32 bits, color with alpha, float*/</span>
00614         <a class="code" href="shader_8h.html#a878a396">miIMG_TYPE_RGB_FP</a>       = 16,   <span class="comment">/* 3*32 bits, color, float*/</span>
00615         <a class="code" href="shader_8h.html#a878a397">miIMG_TYPE_COVERAGE</a>     = 17,   <span class="comment">/* 1*32 bits, coverage, float */</span>
00616         <a class="code" href="shader_8h.html#a878a398">miIMG_TYPE_RGBE</a>         = 18,   <span class="comment">/* 4*8  bits, HDR with common expon. */</span>
00617         <a class="code" href="shader_8h.html#a878a399">miIMG_TYPE_A_FP</a>         = 19,   <span class="comment">/* 1*16 bits, alpha */</span>
00618         <a class="code" href="shader_8h.html#a878a400">miIMG_TYPE_S_FP</a>         = 20,   <span class="comment">/* 1*32 bits, intensity */</span>
00619         <a class="code" href="shader_8h.html#a878a401">miIMG_NTYPES</a>            = 21,
00620                                         <span class="comment">/* remainder is out-of-band types */</span>
00621         <a class="code" href="shader_8h.html#a878a402">miIMG_TYPE_CONT</a>         = 23,   <span class="comment">/* API/PHEN: contours */</span>
00622         <a class="code" href="shader_8h.html#a878a403">miIMG_TYPE_USER_FIRST</a>   = 24,   <span class="comment">/* API/PHEN: user-defined types 0..7 */</span>
00623         <a class="code" href="shader_8h.html#a878a404">miIMG_TYPE_USER_LAST</a>    = 31,   <span class="comment">/* (used by frame buffer defs 0..7) */</span>
00624         <a class="code" href="shader_8h.html#a878a405">miIMG_TYPE_ANY</a>          = 99    <span class="comment">/* img_open: don't convert */</span>
00625 } <a class="code" href="shader_8h.html#a878">miImg_type</a>;
00626 <span class="comment">/* The documented error return */</span>
<a name="l00627"></a><a class="code" href="shader_8h.html#a48">00627</a> <span class="preprocessor">#define miIMG_TYPE_ERROR miIMG_NTYPES</span>
00628 <span class="preprocessor"></span>
00629 
00630 
00631 <span class="comment">/*</span>
00632 <span class="comment"> * supported file formats. These are used for one purpose only: when creating</span>
00633 <span class="comment"> * an image file, they specify the output format. When adding or inserting</span>
00634 <span class="comment"> * an entry, add external declarations and entries to all arrays defined as</span>
00635 <span class="comment"> * "something[miIMG_NFORMATS]" at the beginning of imgdispatch.c. Make sure</span>
00636 <span class="comment"> * the order is correct!</span>
00637 <span class="comment"> * Generally, common formats should precede uncommon, and formats difficult</span>
00638 <span class="comment"> * to recognize by their headers should come last (qnt, zpic). QNT_PAL must</span>
00639 <span class="comment"> * be QNT_NTSC-1, and there may be only two QNT formats (see mi_img_open).</span>
00640 <span class="comment"> */</span>
00641 
<a name="l00642"></a><a class="code" href="shader_8h.html#a879">00642</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
00643         <a class="code" href="shader_8h.html#a879a406">miIMG_FORMAT_RLA</a>        = 0,    <span class="comment">/* Wavefront RLA */</span>
00644         <a class="code" href="shader_8h.html#a879a407">miIMG_FORMAT_RLB</a>        = 1,    <span class="comment">/* Wavefront RLB */</span>
00645         <a class="code" href="shader_8h.html#a879a408">miIMG_FORMAT_PIC</a>        = 2,    <span class="comment">/* Softimage pic, compressed */</span>
00646         <a class="code" href="shader_8h.html#a879a409">miIMG_FORMAT_ALIAS</a>      = 3,    <span class="comment">/* Alias */</span>
00647         <a class="code" href="shader_8h.html#a879a410">miIMG_FORMAT_RGB</a>        = 4,    <span class="comment">/* SGI RGB, compressed */</span>
00648         <a class="code" href="shader_8h.html#a879a411">miIMG_FORMAT_CT</a>         = 5,    <span class="comment">/* mi Color Texture */</span>
00649         <a class="code" href="shader_8h.html#a879a412">miIMG_FORMAT_CT_16</a>      = 6,    <span class="comment">/* mi Color Texture, 16 bits */</span>
00650         <a class="code" href="shader_8h.html#a879a413">miIMG_FORMAT_ST</a>         = 7,    <span class="comment">/* mi Scalar Texture */</span>
00651         <a class="code" href="shader_8h.html#a879a414">miIMG_FORMAT_ST_16</a>      = 8,    <span class="comment">/* mi Scalar Texture, 16 bits */</span>
00652         <a class="code" href="shader_8h.html#a879a415">miIMG_FORMAT_VT</a>         = 9,    <span class="comment">/* mi vector texture, from alpha */</span>
00653         <a class="code" href="shader_8h.html#a879a416">miIMG_FORMAT_WT</a>         = 10,   <span class="comment">/* mi vector texture, from intensity */</span>
00654         <a class="code" href="shader_8h.html#a879a417">miIMG_FORMAT_ZT</a>         = 11,   <span class="comment">/* mi Z channel, from intersect depth*/</span>
00655         <a class="code" href="shader_8h.html#a879a418">miIMG_FORMAT_NT</a>         = 12,   <span class="comment">/* mi normal vectors */</span>
00656         <a class="code" href="shader_8h.html#a879a419">miIMG_FORMAT_MT</a>         = 28,   <span class="comment">/* mi motion vectors */</span>
00657         <a class="code" href="shader_8h.html#a879a420">miIMG_FORMAT_TT</a>         = 13,   <span class="comment">/* mi tag channel, from material tags*/</span>
00658         <a class="code" href="shader_8h.html#a879a421">miIMG_FORMAT_BIT</a>        = 29,   <span class="comment">/* mi one-bit render-enable flags */</span>
00659         <a class="code" href="shader_8h.html#a879a422">miIMG_FORMAT_TIFF</a>       = 14,   <span class="comment">/* compressed   any TIFF */</span>
00660         <a class="code" href="shader_8h.html#a879a423">miIMG_FORMAT_TIFF_U</a>     = 15,   <span class="comment">/* uncompressed any TIFF */</span>
00661         <a class="code" href="shader_8h.html#a879a424">miIMG_FORMAT_TIFF_3</a>     = 16,   <span class="comment">/* compressed   any 3-component TIFF */</span>
00662         <a class="code" href="shader_8h.html#a879a425">miIMG_FORMAT_TIFF_U3</a>    = 17,   <span class="comment">/* uncompressed any 3-component TIFF */</span>
00663         <a class="code" href="shader_8h.html#a879a426">miIMG_FORMAT_TIFF_16</a>    = 30,   <span class="comment">/* compressed any 16bit TIFF */</span>
00664         <a class="code" href="shader_8h.html#a879a427">miIMG_FORMAT_TIFF_16_U</a>  = 31,   <span class="comment">/* uncompress any 16bit TIFF */</span>
00665         <a class="code" href="shader_8h.html#a879a428">miIMG_FORMAT_TIFF_16_3</a>  = 32,   <span class="comment">/* compressed 3-component 16bit TIFF */</span>
00666         <a class="code" href="shader_8h.html#a879a429">miIMG_FORMAT_TIFF_16_U3</a> = 33,   <span class="comment">/* uncompress 3-component 16bit TIFF */</span>
00667         <a class="code" href="shader_8h.html#a879a430">miIMG_FORMAT_CATIA</a>      = 18,   <span class="comment">/* Dassault Systemes Catia format */</span>
00668         <a class="code" href="shader_8h.html#a879a431">miIMG_FORMAT_PPM</a>        = 19,   <span class="comment">/* Jef Poskanzer's portable pixmaps */</span>
00669         <a class="code" href="shader_8h.html#a879a432">miIMG_FORMAT_CT_FP</a>      = 20,   <span class="comment">/* mi Color Texture, floating-point */</span>
00670         <a class="code" href="shader_8h.html#a879a433">miIMG_FORMAT_MAP</a>        = 21,   <span class="comment">/* mmap-ed raw texture file */</span>
00671         <a class="code" href="shader_8h.html#a879a434">miIMG_FORMAT_TARGA</a>      = 22,   <span class="comment">/* compressed RGBA Targa */</span>
00672         <a class="code" href="shader_8h.html#a879a435">miIMG_FORMAT_BMP</a>        = 23,   <span class="comment">/* Microsoft BMP 32-bit uncompressed */</span>
00673         <a class="code" href="shader_8h.html#a879a436">miIMG_FORMAT_QNT_PAL</a>    = 24,   <span class="comment">/* Quantel/Abekas, 576x720 */</span>
00674         <a class="code" href="shader_8h.html#a879a437">miIMG_FORMAT_QNT_NTSC</a>   = 25,   <span class="comment">/* Quantel/Abekas, 486x720 */</span>
00675         <a class="code" href="shader_8h.html#a879a438">miIMG_FORMAT_ZPIC</a>       = 26,   <span class="comment">/* Softimage Zpic, uncompr Z coords */</span>
00676         <a class="code" href="shader_8h.html#a879a439">miIMG_FORMAT_NULL</a>       = 27,   <span class="comment">/* dummy file, write nothing at all */</span>
00677         <a class="code" href="shader_8h.html#a879a440">miIMG_FORMAT_JPEG</a>       = 34,   <span class="comment">/* baseline sequential JPEG */</span>
00678         <a class="code" href="shader_8h.html#a879a441">miIMG_FORMAT_LWI</a>        = 35,   <span class="comment">/* Solidworks texture, read only */</span>
00679         <a class="code" href="shader_8h.html#a879a442">miIMG_FORMAT_PS</a>         = 36,   <span class="comment">/* PostScript - write only */</span>
00680         <a class="code" href="shader_8h.html#a879a443">miIMG_FORMAT_EPS</a>        = 37,   <span class="comment">/* encapsulated PostScript */</span>
00681         <a class="code" href="shader_8h.html#a879a444">miIMG_FORMAT_CT_H</a>       = 38,   <span class="comment">/* mi Color Texture, HDR RGBE */</span>
00682         <a class="code" href="shader_8h.html#a879a445">miIMG_FORMAT_HDR</a>        = 39,   <span class="comment">/* Radiance HDR (aka PIC) */</span>
00683         <a class="code" href="shader_8h.html#a879a446">miIMG_FORMAT_ST_FP</a>      = 40,   <span class="comment">/* mi Color Texture, 16 bits */</span>
00684         <a class="code" href="shader_8h.html#a879a447">miIMG_FORMAT_IFF</a>        = 41,   <span class="comment">/* Alias|wavefront IFF compressed */</span>
00685         <a class="code" href="shader_8h.html#a879a448">miIMG_FORMAT_CUSTOM_0</a>   = 42,   <span class="comment">/* user-defined */</span>
00686         <a class="code" href="shader_8h.html#a879a449">miIMG_FORMAT_CUSTOM_1</a>   = 43,   <span class="comment">/* user-defined */</span>
00687         <a class="code" href="shader_8h.html#a879a450">miIMG_FORMAT_CUSTOM_2</a>   = 44,   <span class="comment">/* user-defined */</span>
00688         <a class="code" href="shader_8h.html#a879a451">miIMG_FORMAT_CUSTOM_3</a>   = 45,   <span class="comment">/* user-defined */</span>
00689         <a class="code" href="shader_8h.html#a879a452">miIMG_FORMAT_CUSTOM_4</a>   = 46,   <span class="comment">/* user-defined */</span>
00690         <a class="code" href="shader_8h.html#a879a453">miIMG_FORMAT_CUSTOM_5</a>   = 47,   <span class="comment">/* user-defined */</span>
00691         <a class="code" href="shader_8h.html#a879a454">miIMG_FORMAT_CUSTOM_6</a>   = 48,   <span class="comment">/* user-defined */</span>
00692         <a class="code" href="shader_8h.html#a879a455">miIMG_FORMAT_CUSTOM_7</a>   = 49,   <span class="comment">/* user-defined */</span>
00693         <a class="code" href="shader_8h.html#a879a456">miIMG_FORMAT_CUSTOM_8</a>   = 50,   <span class="comment">/* user-defined */</span>
00694         <a class="code" href="shader_8h.html#a879a457">miIMG_FORMAT_CUSTOM_9</a>   = 51,   <span class="comment">/* user-defined */</span>
00695         <a class="code" href="shader_8h.html#a879a458">miIMG_FORMAT_CUSTOM_10</a>  = 52,   <span class="comment">/* user-defined */</span>
00696         <a class="code" href="shader_8h.html#a879a459">miIMG_FORMAT_CUSTOM_11</a>  = 53,   <span class="comment">/* user-defined */</span>
00697         <a class="code" href="shader_8h.html#a879a460">miIMG_FORMAT_CUSTOM_12</a>  = 54,   <span class="comment">/* user-defined */</span>
00698         <a class="code" href="shader_8h.html#a879a461">miIMG_FORMAT_CUSTOM_13</a>  = 55,   <span class="comment">/* user-defined */</span>
00699         <a class="code" href="shader_8h.html#a879a462">miIMG_FORMAT_CUSTOM_14</a>  = 56,   <span class="comment">/* user-defined */</span>
00700         <a class="code" href="shader_8h.html#a879a463">miIMG_FORMAT_CUSTOM_15</a>  = 57,   <span class="comment">/* user-defined */</span>
00701         <a class="code" href="shader_8h.html#a879a464">miIMG_FORMAT_CUSTOM_LAST</a>= 57,   <span class="comment">/* last user-defined */</span>
00702         <a class="code" href="shader_8h.html#a879a465">miIMG_FORMAT_PNG</a>        = 58,   <span class="comment">/* png */</span>
00703         <a class="code" href="shader_8h.html#a879a466">miIMG_FORMAT_SHMAP</a>      = 59,   <span class="comment">/* internal shadowmap format */</span>
00704         <a class="code" href="shader_8h.html#a879a467">miIMG_NFORMATS</a>          = 60
00705 } <a class="code" href="shader_8h.html#a879">miImg_format</a>;
00706 <span class="comment">/* The documented error return */</span>
<a name="l00707"></a><a class="code" href="shader_8h.html#a49">00707</a> <span class="preprocessor">#define miIMG_FORMAT_ERROR miIMG_NFORMATS</span>
00708 <span class="preprocessor"></span>
00709 
00710 <span class="comment">/*</span>
00711 <span class="comment"> * error codes. If you add one, also add a message to errmsg[] in libimg.c.</span>
00712 <span class="comment"> */</span>
00713 
<a name="l00714"></a><a class="code" href="shader_8h.html#a880">00714</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
00715         <a class="code" href="shader_8h.html#a880a468">miIMG_ERR_NONE</a>          = 0,    <span class="comment">/* no error */</span>
00716         <a class="code" href="shader_8h.html#a880a469">miIMG_ERR_READ</a>          = 1,    <span class="comment">/* can't read, end of file */</span>
00717         <a class="code" href="shader_8h.html#a880a470">miIMG_ERR_WRITE</a>         = 2,    <span class="comment">/* can't write, probably disk full */</span>
00718         <a class="code" href="shader_8h.html#a880a471">miIMG_ERR_DECODE</a>        = 3,    <span class="comment">/* file format error */</span>
00719         <a class="code" href="shader_8h.html#a880a472">miIMG_ERR_ENCODE</a>        = 4,    <span class="comment">/* internal error */</span>
00720         <a class="code" href="shader_8h.html#a880a473">miIMG_ERR_TYPE</a>          = 5,    <span class="comment">/* unrecognized file type */</span>
00721         <a class="code" href="shader_8h.html#a880a474">miIMG_ERR_SUBTYPE</a>       = 6,    <span class="comment">/* file version not supported */</span>
00722         <a class="code" href="shader_8h.html#a880a475">miIMG_ERR_CREATE</a>        = 7,    <span class="comment">/* failed to create file */</span>
00723         <a class="code" href="shader_8h.html#a880a476">miIMG_ERR_OPEN</a>          = 8,    <span class="comment">/* failed to open file */</span>
00724         <a class="code" href="shader_8h.html#a880a477">miIMG_ERR_CLOSE</a>         = 9,    <span class="comment">/* failed to close file */</span>
00725         <a class="code" href="shader_8h.html#a880a478">miIMG_ERR_ARGS</a>          = 10,   <span class="comment">/* incorrect call argument */</span>
00726         <a class="code" href="shader_8h.html#a880a479">miIMG_ERR_NOTOPEN</a>       = 11,   <span class="comment">/* file not open */</span>
00727         <a class="code" href="shader_8h.html#a880a480">miIMG_ERR_NOTCLOSED</a>     = 12,   <span class="comment">/* file still open, can't re-open */</span>
00728         <a class="code" href="shader_8h.html#a880a481">miIMG_ERR_SIZE</a>          = 13,   <span class="comment">/* wrong file size */</span>
00729         <a class="code" href="shader_8h.html#a880a482">miIMG_NERRS</a>
00730 } <a class="code" href="shader_8h.html#a880">miImg_error</a>;
00731 
00732 
00733 <span class="comment">/*</span>
00734 <span class="comment"> * file descriptor. The file name is stored to be able to print meaningful</span>
00735 <span class="comment"> * error messages. It is an array, not a strdup'ed pointer, because it is</span>
00736 <span class="comment"> * not clear who would de-allocate the name otherwise. If the file name is</span>
00737 <span class="comment"> * longer than the array, it is truncated. The real file name is stored</span>
00738 <span class="comment"> * too, but it can't be relied upon to exist. Gamma is not used and may go</span>
00739 <span class="comment"> * away in future versions.</span>
00740 <span class="comment"> * Other modules may only use the public fields. The others are reserved</span>
00741 <span class="comment"> * by raylib (and in fact not documented in the external manual). The fp</span>
00742 <span class="comment"> * field is actually a FILE*, but it's void* here because otherwise every</span>
00743 <span class="comment"> * file including img.h would have to include stdio.h as well. It's always</span>
00744 <span class="comment"> * cast to FILE* in img*.c.</span>
00745 <span class="comment"> */</span>
00746 
<a name="l00747"></a><a class="code" href="structmiImg__line.html">00747</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00748"></a><a class="code" href="structmiImg__line.html#o0">00748</a>         <span class="keywordtype">int</span>             c[4];           <span class="comment">/* indexed by miIMG_* */</span>
00749 } <a class="code" href="structmiImg__line.html">miImg_line</a>;                           <span class="comment">/* component scanlines follow here */</span>
00750 
<a name="l00751"></a><a class="code" href="structmiImg__file.html">00751</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiImg__file.html">miImg_file</a> {
<a name="l00752"></a><a class="code" href="structmiImg__file.html#o0">00752</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__file.html#o0">null</a>;           <span class="comment">/* bomb out if someone forgets &amp; */</span>
00753                                         <span class="comment">/* --------------- public --------- */</span>
<a name="l00754"></a><a class="code" href="structmiImg__file.html#o1">00754</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__file.html#o1">width</a>, <a class="code" href="structmiImg__file.html#o2">height</a>;  <span class="comment">/* width and height in pixels */</span>
<a name="l00755"></a><a class="code" href="structmiImg__file.html#o3">00755</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__file.html#o3">bits</a>;           <span class="comment">/* requested bits per component, 8/16*/</span>
<a name="l00756"></a><a class="code" href="structmiImg__file.html#o4">00756</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__file.html#o4">comp</a>;           <span class="comment">/* requested components/pixel, 1..4 */</span>
<a name="l00757"></a><a class="code" href="structmiImg__file.html#o5">00757</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiImg__file.html#o5">filter</a>;         <span class="comment">/* caller wants filtered lookups */</span>
<a name="l00758"></a><a class="code" href="structmiImg__file.html#o6">00758</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiImg__file.html#o6">topdown</a>;        <span class="comment">/* read file top-down */</span>
<a name="l00759"></a><a class="code" href="structmiImg__file.html#o7">00759</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__file.html#o7">filesize</a>;       <span class="comment">/* if reading, size of file in bytes */</span>
<a name="l00760"></a><a class="code" href="structmiImg__file.html#o8">00760</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiImg__file.html#o8">gamma</a>;          <span class="comment">/* gamma correction value (read only)*/</span>
<a name="l00761"></a><a class="code" href="structmiImg__file.html#o9">00761</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiImg__file.html#o9">aspect</a>;         <span class="comment">/* aspect/xres*yres (for .pic output)*/</span>
<a name="l00762"></a><a class="code" href="structmiImg__file.html#o10">00762</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiImg__file.html#o10">parms</a>[8];       <span class="comment">/* additional undefined parameters, */</span>
00763                                         <span class="comment">/* [0] is .jpg quality: 0..100 */</span>
00764                                         <span class="comment">/* [1] is .pic field: 1=even, 2=odd */</span>
00765                                         <span class="comment">/* [2] scaling factor for filters */</span>
00766                                         <span class="comment">/* [3] whether IFF has extra Z */</span>
<a name="l00767"></a><a class="code" href="structmiImg__file.html#o11">00767</a>         <a class="code" href="shader_8h.html#a878">miImg_type</a>      <a class="code" href="structmiImg__file.html#o11">type</a>;           <span class="comment">/* requested miIMG_TYPE_* */</span>
<a name="l00768"></a><a class="code" href="structmiImg__file.html#o12">00768</a>         <a class="code" href="shader_8h.html#a879">miImg_format</a>    <a class="code" href="structmiImg__file.html#o12">format</a>;         <span class="comment">/* if reading, file format */</span>
<a name="l00769"></a><a class="code" href="structmiImg__file.html#o13">00769</a>         <a class="code" href="shader_8h.html#a880">miImg_error</a>     <a class="code" href="structmiImg__file.html#o13">error</a>;          <span class="comment">/* one of miIMG_ERR_*, or 0 */</span>
<a name="l00770"></a><a class="code" href="structmiImg__file.html#o14">00770</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__file.html#o14">os_error</a>;       <span class="comment">/* copy of Unix's errno, or 0 */</span>
00771                                         <span class="comment">/* --------------- private --------- */</span>
<a name="l00772"></a><a class="code" href="structmiImg__file.html#o15">00772</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__file.html#o15">magic</a>;          <span class="comment">/* magic number while file is open */</span>
<a name="l00773"></a><a class="code" href="structmiImg__file.html#o16">00773</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__file.html#o16">lineno</a>;         <span class="comment">/* current line# to be read/written */</span>
<a name="l00774"></a><a class="code" href="structmiImg__file.html#o17">00774</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiImg__file.html#o17">writing</a>;        <span class="comment">/* if nz, file is open for writing */</span>
<a name="l00775"></a><a class="code" href="structmiImg__file.html#o18">00775</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiImg__file.html#o18">swap_map</a>;       <span class="comment">/* swap if memory-mapping */</span>
<a name="l00776"></a><a class="code" href="structmiImg__file.html#o19">00776</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiImg__file.html#o19">ftype</a>;          <span class="comment">/* actual file data type, should     */</span>
00777                                         <span class="comment">/* be cast to miImg_type. this is    */</span>
00778                                         <span class="comment">/* set internally in mi_img_create   */</span>
00779                                         <span class="comment">/* from miImg_file.type              */</span>
<a name="l00780"></a><a class="code" href="structmiImg__file.html#o20">00780</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiImg__file.html#o20">writable</a>;       <span class="comment">/* writable texture (eg. light map) */</span>
<a name="l00781"></a><a class="code" href="structmiImg__file.html#o21">00781</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiImg__file.html#o21">dummy</a>;          <span class="comment">/* not used */</span>
<a name="l00782"></a><a class="code" href="structmiImg__file.html#o22">00782</a>         <a class="code" href="unionmiPointer.html">miPointer</a>       <a class="code" href="structmiImg__file.html#o22">fp</a>;             <span class="comment">/* open file descriptor, 0 if closed */</span>
<a name="l00783"></a><a class="code" href="structmiImg__file.html#o23">00783</a>         <a class="code" href="unionmiPointer.html">miPointer</a>       <a class="code" href="structmiImg__file.html#o23">real_name</a>;      <span class="comment">/* complete path (for unlink/local) */</span>
<a name="l00784"></a><a class="code" href="structmiImg__file.html#o24">00784</a>         <a class="code" href="unionmiPointer.html">miPointer</a>       <a class="code" href="structmiImg__file.html#o24">convline</a>;       <span class="comment">/* converted line if type != format */</span>
<a name="l00785"></a><a class="code" href="structmiImg__file.html#o25">00785</a>         <a class="code" href="unionmiPointer.html">miPointer</a>       <a class="code" href="structmiImg__file.html#o25">data</a>;           <span class="comment">/* more format-dependent file info*/</span>
00786                                         <span class="comment">/* or map address for .map files */</span>
<a name="l00787"></a><a class="code" href="structmiImg__file.html#o26">00787</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiImg__file.html#o26">name</a>[64];       <span class="comment">/* file name (for error messages) */</span>
00788 } <a class="code" href="structmiImg__file.html">miImg_file</a>;
00789 
00790 
00791 <span class="comment">/*</span>
00792 <span class="comment"> * generic scanline and image struct. They are based on index values that</span>
00793 <span class="comment"> * define the beginning of component scanlines relative to the beginning of</span>
00794 <span class="comment"> * the struct (including header and all). Both miImg_line and miImg_image</span>
00795 <span class="comment"> * are actually allocated larger than their size; the component scanlines</span>
00796 <span class="comment"> * directly follow the typedef'ed header. One mi_mem_release suffices for</span>
00797 <span class="comment"> * the whole thing including data.</span>
00798 <span class="comment"> * &lt;comp&gt; in the access macro stands for one of the miIMG_* constants below.</span>
00799 <span class="comment"> * Do not use miIMG_LINEACCESS before using miIMG_ACCESS to load local texs!</span>
00800 <span class="comment"> */</span>
00801 
<a name="l00802"></a><a class="code" href="shader_8h.html#a50">00802</a> <span class="preprocessor">#define miIMG_R         0               </span><span class="comment">/* red */</span>
<a name="l00803"></a><a class="code" href="shader_8h.html#a51">00803</a> <span class="preprocessor">#define miIMG_G         1               </span><span class="comment">/* green */</span>
<a name="l00804"></a><a class="code" href="shader_8h.html#a52">00804</a> <span class="preprocessor">#define miIMG_B         2               </span><span class="comment">/* blue */</span>
<a name="l00805"></a><a class="code" href="shader_8h.html#a53">00805</a> <span class="preprocessor">#define miIMG_A         3               </span><span class="comment">/* alpha */</span>
<a name="l00806"></a><a class="code" href="shader_8h.html#a54">00806</a> <span class="preprocessor">#define miIMG_E         3               </span><span class="comment">/* HDR exponent */</span>
<a name="l00807"></a><a class="code" href="shader_8h.html#a55">00807</a> <span class="preprocessor">#define miIMG_S         miIMG_A         </span><span class="comment">/* scalar */</span>
<a name="l00808"></a><a class="code" href="shader_8h.html#a56">00808</a> <span class="preprocessor">#define miIMG_U         0               </span><span class="comment">/* u vector */</span>
<a name="l00809"></a><a class="code" href="shader_8h.html#a57">00809</a> <span class="preprocessor">#define miIMG_V         1               </span><span class="comment">/* v vector */</span>
<a name="l00810"></a><a class="code" href="shader_8h.html#a58">00810</a> <span class="preprocessor">#define miIMG_Z         0               </span><span class="comment">/* Z coordinate */</span>
<a name="l00811"></a><a class="code" href="shader_8h.html#a59">00811</a> <span class="preprocessor">#define miIMG_T         0               </span><span class="comment">/* material tag */</span>
<a name="l00812"></a><a class="code" href="shader_8h.html#a60">00812</a> <span class="preprocessor">#define miIMG_NX        0               </span><span class="comment">/* normal vector X component */</span>
<a name="l00813"></a><a class="code" href="shader_8h.html#a61">00813</a> <span class="preprocessor">#define miIMG_NY        1               </span><span class="comment">/* normal vector Y component */</span>
<a name="l00814"></a><a class="code" href="shader_8h.html#a62">00814</a> <span class="preprocessor">#define miIMG_NZ        2               </span><span class="comment">/* normal vector Z component */</span>
00815 
<a name="l00816"></a><a class="code" href="shader_8h.html#a63">00816</a> <span class="preprocessor">#define miIMG_ACCESS(_i, _y,_c)\</span>
00817 <span class="preprocessor">        ((_i)-&gt;cacheable \</span>
00818 <span class="preprocessor">         ? ((miUchar *) mi_img_cache_get((_i), (_i)-&gt;c[4*(_y)+(_c)]))\</span>
00819 <span class="preprocessor">         : ((miUchar *)(_i) + (_i)-&gt;c[4*(_y)+(_c)]))</span>
00820 <span class="preprocessor"></span>
00821 <span class="comment">/* do not use it with "cacheable" images */</span>
<a name="l00822"></a><a class="code" href="shader_8h.html#a64">00822</a> <span class="preprocessor">#define miIMG_LINEACCESS(_l,_c) ((miUchar *)(_l)+(_l)-&gt;c[(_c)])</span>
00823 <span class="preprocessor"></span>
<a name="l00824"></a><a class="code" href="shader_8h.html#a65">00824</a> <span class="preprocessor">#define miIMG_DIRSIZE   20              </span><span class="comment">/* image filters have max 20 levels */</span>
00825 
<a name="l00826"></a><a class="code" href="structmiImg__image.html">00826</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiImg__image.html">miImg_image</a> {
<a name="l00827"></a><a class="code" href="structmiImg__image.html#o0">00827</a>         <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="structmiImg__image.html#o0">filter</a>;         <span class="comment">/* filtered lookups if &gt; 0 */</span>
<a name="l00828"></a><a class="code" href="structmiImg__image.html#o1">00828</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__image.html#o1">dirsize</a>;        <span class="comment">/* valid # of filter levels */</span>
<a name="l00829"></a><a class="code" href="structmiImg__image.html#o2">00829</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__image.html#o2">dir</a>[<a class="code" href="shader_8h.html#a65">miIMG_DIRSIZE</a>]; <span class="comment">/* offs from this to other imgs */</span>
<a name="l00830"></a><a class="code" href="structmiImg__image.html#o3">00830</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__image.html#o3">width</a>, <a class="code" href="structmiImg__image.html#o4">height</a>;  <span class="comment">/* width and height in pixels */</span>
<a name="l00831"></a><a class="code" href="structmiImg__image.html#o5">00831</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__image.html#o5">bits</a>;           <span class="comment">/* requested bits per comp, 8/16/32 */</span>
<a name="l00832"></a><a class="code" href="structmiImg__image.html#o6">00832</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__image.html#o6">comp</a>;           <span class="comment">/* requested components/pixel, 1..4 */</span>
<a name="l00833"></a><a class="code" href="structmiImg__image.html#o7">00833</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiImg__image.html#o7">local</a>;          <span class="comment">/* local texture, use image/mmap/path*/</span>
<a name="l00834"></a><a class="code" href="structmiImg__image.html#o8">00834</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiImg__image.html#o8">writable</a>;       <span class="comment">/* writable texture (eg. light map) */</span>
<a name="l00835"></a><a class="code" href="structmiImg__image.html#o9">00835</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiImg__image.html#o9">cacheable</a>;      <span class="comment">/* cache in parts */</span>
<a name="l00836"></a><a class="code" href="structmiImg__image.html#o10">00836</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiImg__image.html#o10">remap</a>;          <span class="comment">/* image is remapped */</span>
<a name="l00837"></a><a class="code" href="structmiImg__image.html#o11">00837</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__image.html#o11">type</a>;           <span class="comment">/* requested miIMG_TYPE_* */</span>
<a name="l00838"></a><a class="code" href="structmiImg__image.html#o12">00838</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiImg__image.html#o12">real_name</a>;      <span class="comment">/* (local) file name to open */</span>
<a name="l00839"></a><a class="code" href="structmiImg__image.html#o13">00839</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__image.html#o13">null</a>[1];        <span class="comment">/* unused */</span>
<a name="l00840"></a><a class="code" href="structmiImg__image.html#o14">00840</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiImg__image.html#o14">c</a>[4];           <span class="comment">/*      indexed by miIMG_*; 4*height */</span>
00841                                         <span class="comment">/*      component indices follow, */</span>
00842                                         <span class="comment">/*      then component scanlines */</span>
00843 } <a class="code" href="structmiImg__image.html">miImg_image</a>;
00844 
00845 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a712">mi_img_create</a>(
00846                                 <a class="code" href="structmiImg__file.html">miImg_file</a> *<span class="keyword">const</span>,      <span class="comment">/* file descriptor */</span>
00847                                 <span class="keywordtype">char</span> * <span class="keyword">const</span>,           <span class="comment">/* new file name */</span>
00848                                 <span class="keyword">const</span> miImg_type,       <span class="comment">/* data type, RGB etc*/</span>
00849                                 <span class="keyword">const</span> miImg_format,     <span class="comment">/* format, RLA etc */</span>
00850                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* image width */</span>
00851                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* image height */</span>
00852 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a713">mi_img_open</a>(
00853                                 <a class="code" href="structmiImg__file.html">miImg_file</a> *<span class="keyword">const</span>,      <span class="comment">/* file descriptor */</span>
00854                                 <span class="keywordtype">char</span> * <span class="keyword">const</span>,           <span class="comment">/* file name */</span>
00855                                 <span class="keyword">const</span> miImg_type);      <span class="comment">/* desired data type */</span>
00856 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a714">mi_img_close</a>(
00857                                 <a class="code" href="structmiImg__file.html">miImg_file</a> *<span class="keyword">const</span>);     <span class="comment">/* file descriptor */</span>
00858 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a715">mi_img_image_read</a>(
00859                                 <a class="code" href="structmiImg__file.html">miImg_file</a> *<span class="keyword">const</span>,      <span class="comment">/* file descriptor */</span>
00860                                 <a class="code" href="structmiImg__image.html">miImg_image</a>*<span class="keyword">const</span>);     <span class="comment">/* frame buffer */</span>
00861 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a716">mi_img_image_write</a>(
00862                                 <a class="code" href="structmiImg__file.html">miImg_file</a> *<span class="keyword">const</span>,      <span class="comment">/* file descriptor */</span>
00863                                 <a class="code" href="structmiImg__image.html">miImg_image</a>*<span class="keyword">const</span>);     <span class="comment">/* frame buffer */</span>
00864 <a class="code" href="structmiImg__image.html">miImg_image</a>     *<a class="code" href="shader_8h.html#a717">mi_img_mmap_address</a>(
00865                                 <a class="code" href="structmiImg__file.html">miImg_file</a> *);          <span class="comment">/* file descriptor */</span>
00866 <a class="code" href="structmiImg__image.html">miImg_image</a>     *<a class="code" href="shader_8h.html#a718">mi_img_image_dbcreate</a>(
00867                                 <a class="code" href="structmiImg__file.html">miImg_file</a> *<span class="keyword">const</span>,      <span class="comment">/* file descriptor */</span>
00868                                 miTag * <span class="keyword">const</span>);         <span class="comment">/* returned tag in DB*/</span>
00869 <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="shader_8h.html#a719">mi_img_placeholder_dbcreate</a>(
00870                                 <a class="code" href="structmiImg__file.html">miImg_file</a> * <span class="keyword">const</span>,     <span class="comment">/* file struct */</span>
00871                                 miTag * <span class="keyword">const</span>,          <span class="comment">/* returned tag in DB*/</span>
00872                                 miBoolean);             <span class="comment">/* local texture? */</span>
00873 <a class="code" href="structmiImg__image.html">miImg_image</a>     *<a class="code" href="shader_8h.html#a717">mi_img_mmap_address</a>(
00874                                 <a class="code" href="structmiImg__file.html">miImg_file</a> *ifp);       <span class="comment">/* file struct */</span>
00875 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a720">mi_img_image_release</a>(
00876                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *img);      <span class="comment">/* file struct */</span>
00877 
00878 
00879 <a class="code" href="shader_8h.html#a136">miUchar</a>         *<a class="code" href="shader_8h.html#a721">mi_img_access</a>(
00880                                 <a class="code" href="structmiImg__image.html">miImg_image</a>     *,      <span class="comment">/* image to access */</span>
00881                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* requested scanline*/</span>
00882                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* req component 0..3*/</span>
00883 <a class="code" href="structmiImg__image.html">miImg_image</a>     *<a class="code" href="shader_8h.html#a722">mi_img_image_alloc</a>(
00884                                 <a class="code" href="structmiImg__file.html">miImg_file</a> *<span class="keyword">const</span>);     <span class="comment">/* file descriptor */</span>
00885 <a class="code" href="shader_8h.html#a878">miImg_type</a>      <a class="code" href="shader_8h.html#a723">mi_img_type_identify</a>(
00886                                 <span class="keywordtype">char</span> * <span class="keyword">const</span>);          <span class="comment">/* type, "rgb" etc */</span>
00887 <a class="code" href="shader_8h.html#a879">miImg_format</a>    <a class="code" href="shader_8h.html#a724">mi_img_format_identify</a>(
00888                                 <span class="keywordtype">char</span> * <span class="keyword">const</span>);          <span class="comment">/* format, "rla" etc */</span>
00889 <a class="code" href="shader_8h.html#a878">miImg_type</a>      <a class="code" href="shader_8h.html#a725">mi_img_best_type</a>(
00890                                 <span class="keyword">const</span> miImg_format);    <span class="comment">/* format to test */</span>
00891 <span class="keywordtype">char</span>            *<a class="code" href="shader_8h.html#a726">mi_img_type_name</a>(
00892                                 <span class="keyword">const</span> miImg_type);      <span class="comment">/* data type to name */</span>
00893 <span class="keywordtype">char</span>            *<a class="code" href="shader_8h.html#a727">mi_img_format_name</a>(
00894                                 <span class="keyword">const</span> miImg_format);    <span class="comment">/* format to name */</span>
<a name="l00895"></a><a class="code" href="shader_8h.html#a881">00895</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {                                          <span class="comment">/* colorclip modes */</span>
00896         <a class="code" href="shader_8h.html#a881a483">miIMG_COLORCLIP_RGB</a>,                            <span class="comment">/* rgb priority */</span>
00897         <a class="code" href="shader_8h.html#a881a484">miIMG_COLORCLIP_ALPHA</a>,                          <span class="comment">/* alpha priority */</span>
00898         <a class="code" href="shader_8h.html#a881a485">miIMG_COLORCLIP_RAW</a>                             <span class="comment">/* ignore premult */</span>
00899 } <a class="code" href="shader_8h.html#a881">miImg_colorclip</a>;
00900 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a728">mi_img_clip_color</a>(
00901                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to clip for */</span>
00902                                 <a class="code" href="structmiColor.html">miColor</a> *<span class="keyword">const</span>);        <span class="comment">/* color to clip */</span>
00903 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a729">mi_img_put_color</a>(
00904                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00905                                 <a class="code" href="structmiColor.html">miColor</a> * <span class="keyword">const</span>,        <span class="comment">/* color to store */</span>
00906                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00907                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00908 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a730">mi_img_put_scalar</a>(
00909                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00910                                 <span class="keyword">const</span> <span class="keywordtype">float</span>,            <span class="comment">/* scalar to store */</span>
00911                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00912                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00913 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a731">mi_img_put_vector</a>(
00914                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00915                                 <a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>,       <span class="comment">/* vector to store */</span>
00916                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00917                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00918 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a732">mi_img_put_depth</a>(
00919                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00920                                 <span class="keyword">const</span> <span class="keywordtype">float</span>,            <span class="comment">/* depth, 0=eye, &gt;=0 */</span>
00921                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00922                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00923 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a733">mi_img_put_normal</a>(
00924                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00925                                 <a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>,       <span class="comment">/* normal to store */</span>
00926                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00927                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00928 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a734">mi_img_put_label</a>(
00929                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00930                                 <span class="keyword">const</span> miUint,           <span class="comment">/* label value */</span>
00931                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00932                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00933 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a735">mi_img_get_color</a>(
00934                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00935                                 <a class="code" href="structmiColor.html">miColor</a> * <span class="keyword">const</span>,        <span class="comment">/* color to read */</span>
00936                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00937                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00938 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a736">mi_img_get_scalar</a>(
00939                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00940                                 <span class="keywordtype">float</span> * <span class="keyword">const</span>,          <span class="comment">/* scalar to read */</span>
00941                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00942                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00943 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a737">mi_img_get_vector</a>(
00944                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00945                                 <a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>,       <span class="comment">/* vector to read */</span>
00946                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00947                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00948 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a738">mi_img_get_depth</a>(
00949                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00950                                 <span class="keywordtype">float</span> * <span class="keyword">const</span>,          <span class="comment">/* depth, 0=eye, &gt;=0 */</span>
00951                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00952                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00953 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a739">mi_img_get_normal</a>(
00954                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00955                                 <a class="code" href="structmiVector.html">miVector</a> * <span class="keyword">const</span>,       <span class="comment">/* normal to read */</span>
00956                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00957                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00958 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a740">mi_img_get_label</a>(
00959                                 <a class="code" href="structmiImg__image.html">miImg_image</a> *<span class="keyword">const</span>,     <span class="comment">/* image to store in */</span>
00960                                 miUint * <span class="keyword">const</span>,         <span class="comment">/* returned label */</span>
00961                                 <span class="keyword">const</span> <span class="keywordtype">int</span>,              <span class="comment">/* X coordinate */</span>
00962                                 <span class="keyword">const</span> <span class="keywordtype">int</span>);             <span class="comment">/* Y coordinate */</span>
00963 <a class="code" href="structmiImg__image.html">miImg_image</a>     *<a class="code" href="shader_8h.html#a741">mi_lightmap_edit</a>(                      <span class="comment">/* open for writing */</span>
00964                                 <span class="keywordtype">void</span> **handle,          <span class="comment">/* for _edit_end */</span>
00965                                 miTag tag);             <span class="comment">/* texture tag */</span>
00966 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a742">mi_lightmap_edit_end</a>(                   <span class="comment">/* write texture */</span>
00967                                 <span class="keywordtype">void</span> *handle);          <span class="comment">/* from _edit */</span>
00968 <span class="keywordtype">void</span> *<a class="code" href="shader_8h.html#a743">mi_img_cache_get</a>(
00969                 <span class="keyword">const</span> <a class="code" href="structmiImg__image.html">miImg_image</a>       *image,         <span class="comment">/* cached image */</span>
00970                 miUint                  offset);        <span class="comment">/* to image-&gt;c */</span>
00971 
00972 <span class="comment">/*------------ mi_msg.h ------------*/</span>
00973 
00974 <span class="comment">/* create and initialize lock*/</span>
00975 <span class="preprocessor">#if defined(LOCK_DEBUG)</span>
00976 <span class="preprocessor"></span>  <a class="code" href="shader_8h.html#a875">miBoolean</a> mi_init_lock_dbg(<a class="code" href="unionmiLock.html">miLock</a> *, <span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
00977 <span class="preprocessor"># define mi_init_lock(p) mi_init_lock_dbg(p, __FILE__, __LINE__)</span>
00978 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00979 <span class="preprocessor"></span>  <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a744">mi_init_lock</a>(<a class="code" href="unionmiLock.html">miLock</a> *);
00980 <span class="preprocessor">#endif</span>
00981 <span class="preprocessor"></span>
00982 <span class="comment">/* destroy, acquire, release and try lock*/</span>
00983 
00984 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a745">mi_lock_thread_suspend</a>(<a class="code" href="unionmiLock.html">miLock</a>);
00985 
00986 <span class="preprocessor">#if defined(LOCK_DEBUG)</span>
00987 <span class="preprocessor"></span>  <span class="keywordtype">void</span> mi_delete_lock_dbg(<a class="code" href="unionmiLock.html">miLock</a> *, <span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
00988   <span class="keywordtype">void</span> mi_lock_dbg(<a class="code" href="unionmiLock.html">miLock</a>, <span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
00989   <span class="keywordtype">void</span> mi_unlock_dbg(<a class="code" href="unionmiLock.html">miLock</a>, <span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
00990   <a class="code" href="shader_8h.html#a875">miBoolean</a> mi_trylock_dbg(<a class="code" href="unionmiLock.html">miLock</a>, <span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
00991 <span class="preprocessor"># define mi_delete_lock(p) mi_delete_lock_dbg(p, __FILE__, __LINE__)</span>
00992 <span class="preprocessor"></span><span class="preprocessor"># define mi_lock(p) mi_lock_dbg(p, __FILE__, __LINE__)</span>
00993 <span class="preprocessor"></span><span class="preprocessor"># define mi_unlock(p) mi_unlock_dbg(p, __FILE__, __LINE__)</span>
00994 <span class="preprocessor"></span><span class="preprocessor"># define mi_trylock(p) mi_trylock_dbg(p, __FILE__, __LINE__)</span>
00995 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00996 <span class="preprocessor"></span>  <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a746">mi_delete_lock</a>(<a class="code" href="unionmiLock.html">miLock</a> *); <span class="comment">/* destroy and free lock */</span>
00997   <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a747">mi_lock</a>(<a class="code" href="unionmiLock.html">miLock</a>);          <span class="comment">/* acquire lock, blocking */</span>
00998   <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a748">mi_unlock</a>(<a class="code" href="unionmiLock.html">miLock</a>);        <span class="comment">/* release lock */</span>
00999   <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a749">mi_trylock</a>(<a class="code" href="unionmiLock.html">miLock</a>);  <span class="comment">/* aqcuire lock if available, non-blocking */</span>
01000 <span class="preprocessor">#endif</span>
01001 <span class="preprocessor"></span>
01002 <span class="comment">/*------------ mi_par.h ------------*/</span>
01003 
01004 <span class="keywordtype">int</span> <a class="code" href="shader_8h.html#a750">mi_par_aborted</a>(<span class="keywordtype">void</span>);
01005 
01006 <span class="comment">/*------------ mi_rc.h ------------*/</span>
01007 
01008 <span class="keyword">struct </span><a class="code" href="structmiState.html">miState</a>;
01009 <span class="keywordtype">void</span> *<a class="code" href="shader_8h.html#a751">mi_renderpass_access</a>(             <span class="comment">/* for renderpass merge function */</span>
01010         <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>  *state,         <span class="comment">/* state-&gt;pri is sample set array */</span>
01011         <span class="keywordtype">int</span>             pass,           <span class="comment">/* access which pass, -1=output */</span>
01012         <span class="keywordtype">int</span>             fb);            <span class="comment">/* frame buffer number */</span>
01013 
01014 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a752">mi_renderpass_resolution</a>(
01015         <span class="keywordtype">int</span>             *xl,            <span class="comment">/* returned subpixel coordinates of */</span>
01016         <span class="keywordtype">int</span>             *yl,            <span class="comment">/* lower left corner of rectangle */</span>
01017         <span class="keywordtype">int</span>             *xs,            <span class="comment">/* returned number of subpixels in */</span>
01018         <span class="keywordtype">int</span>             *ys,            <span class="comment">/* the rectangle (containing x/y) */</span>
01019         <span class="keywordtype">int</span>             *xres,          <span class="comment">/* returned number of subpixels in */</span>
01020         <span class="keywordtype">int</span>             *yres,          <span class="comment">/* the entire frame buffer */</span>
01021         <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>  *state,         <span class="comment">/* state-&gt;cache is sample set array */</span>
01022         <span class="keywordtype">int</span>             x,              <span class="comment">/* X subpixel coordinate to look up */</span>
01023         <span class="keywordtype">int</span>             y);             <span class="comment">/* Y subpixel coordinate to look up */</span>
01024 
01025 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a753">mi_renderpass_sample_get</a>(
01026         <span class="keywordtype">void</span>            *result,        <span class="comment">/* copy data here */</span>
01027         <span class="keywordtype">int</span>             resultsize,     <span class="comment">/* number of bytes in *result */</span>
01028         <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>  *state,         <span class="comment">/* state-&gt;cache is sample set array */</span>
01029         <span class="keywordtype">int</span>             fb,             <span class="comment">/* frame buffer number */</span>
01030         <span class="keywordtype">int</span>             x,              <span class="comment">/* X subpixel coordinate */</span>
01031         <span class="keywordtype">int</span>             y);             <span class="comment">/* Y subpixel coordinate */</span>
01032 
01033 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a754">mi_renderpass_sample_put</a>(
01034         <span class="keywordtype">void</span>            *result,        <span class="comment">/* data to copy */</span>
01035         <span class="keywordtype">int</span>             resultsize,     <span class="comment">/* number of bytes in *result */</span>
01036         <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>  *state,         <span class="comment">/* state-&gt;cache is sample set array */</span>
01037         <span class="keywordtype">int</span>             fb,             <span class="comment">/* frame buffer number */</span>
01038         <span class="keywordtype">int</span>             x,              <span class="comment">/* X subpixel coordinate */</span>
01039         <span class="keywordtype">int</span>             y);             <span class="comment">/* Y subpixel coordinate */</span>
01040 
01041 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a755">mi_renderpass_samplerect_black</a>(
01042         miBoolean       *result,        <span class="comment">/* set this to miTRUE if black */</span>
01043         <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>  *state,         <span class="comment">/* state-&gt;cache is sample set array */</span>
01044         <span class="keywordtype">int</span>             x,              <span class="comment">/* X subpixel coordinate */</span>
01045         <span class="keywordtype">int</span>             y);             <span class="comment">/* Y subpixel coordinate */</span>
01046 
01047 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a756">mi_renderpass_samplerect_flush</a>(
01048         <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>  *state,         <span class="comment">/* state-&gt;cache is sample set array */</span>
01049         <span class="keywordtype">int</span>             pass,           <span class="comment">/* 0=write (put), 1=read (get) */</span>
01050         <span class="keywordtype">int</span>             x,              <span class="comment">/* X subpixel coordinate in rect */</span>
01051         <span class="keywordtype">int</span>             y);             <span class="comment">/* Y subpixel coordinate in rect */</span>
01052 <span class="comment">/*</span>
01053 <span class="comment"> * Set the falloff start/stop. If the intersecton point is closer than</span>
01054 <span class="comment"> * start, result of the intersection is taken. If it lies between start</span>
01055 <span class="comment"> * ebd stop, the result is linearly interpoletad from surface shader and</span>
01056 <span class="comment"> * environment shader. If intersection point is behind stop, the environment </span>
01057 <span class="comment"> * shader result is taken. Obviously, intersections behind stop may be ignored</span>
01058 <span class="comment"> * for optimization.</span>
01059 <span class="comment"> */</span>
01060 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a757">mi_ray_falloff</a>(
01061         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>    *state,         <span class="comment">/* state */</span>
01062         <span class="keywordtype">double</span>                  *start,         <span class="comment">/* falloff start distance */</span>
01063         <span class="keywordtype">double</span>                  *stop);         <span class="comment">/* complete falloff */</span>
01064 
01065 <span class="comment">/*</span>
01066 <span class="comment"> * Set the distance to the normal plane under which the intersections</span>
01067 <span class="comment"> * would be ignored. The main purpose is to allow rendering of objects</span>
01068 <span class="comment"> * with different approximation levels.</span>
01069 <span class="comment"> */</span>
01070 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a758">mi_ray_offset</a>(
01071         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>    *state,         <span class="comment">/* state */</span>
01072         <span class="keywordtype">double</span>                  *offset);       <span class="comment">/* offset from the surface */</span>
01073 
01074 
01075 <span class="comment">/*------------ mi_api.h ------------*/</span>
01076 
01077 <a class="code" href="shader_8h.html#a141">miScalar</a>     <a class="code" href="shader_8h.html#a759">mi_lightprofile_value</a>      (<span class="keyword">const</span> <span class="keywordtype">void</span> *, miScalar, miScalar,
01078                                          <span class="keyword">const</span> <a class="code" href="structmiVector.html">miVector</a> *, miBoolean);
01079 <span class="keyword">struct </span><a class="code" href="structmiState.html">miState</a>;
01080 <a class="code" href="shader_8h.html#a141">miScalar</a>     <a class="code" href="shader_8h.html#a760">mi_lightprofile_sample</a>     (<span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a> *, miTag, miBoolean);
01081 
01082 <span class="comment">/*------------ mi_scene.h ------------*/</span>
01083 
01084 <span class="comment">/*</span>
01085 <span class="comment"> * Every DB element managed by SCENE has a unique type and is known by SCENE.</span>
01086 <span class="comment"> * mi_db_create should not be used by modules other than SCENE because that</span>
01087 <span class="comment"> * makes it hard to properly swap bytes between sane parts of the</span>
01088 <span class="comment"> * network and Windows NT.</span>
01089 <span class="comment"> * When adding types, change the arrays in scncall1.c!</span>
01090 <span class="comment"> */</span>
01091 
<a name="l01092"></a><a class="code" href="shader_8h.html#a882">01092</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
01093         <a class="code" href="shader_8h.html#a882a486">miSCENE_NONE</a> = 0,       <span class="comment">/* unknown. Danger, Will Robinson. */</span>
01094         <a class="code" href="shader_8h.html#a882a487">miSCENE_FUNCTION_DECL</a>,  <span class="comment">/*  1:miFunction_decl */</span>
01095         <a class="code" href="shader_8h.html#a882a488">miSCENE_FUNCTION</a>,       <span class="comment">/*  2:miFunction */</span>
01096         <a class="code" href="shader_8h.html#a882a489">miSCENE_MATERIAL</a>,       <span class="comment">/*  3:miMaterial */</span>
01097         <a class="code" href="shader_8h.html#a882a490">miSCENE_LIGHT</a>,          <span class="comment">/*  4:miLight */</span>
01098         <a class="code" href="shader_8h.html#a882a491">miSCENE_CAMERA</a>,         <span class="comment">/*  5:miCamera */</span>
01099         <a class="code" href="shader_8h.html#a882a492">miSCENE_BASIS_LIST</a>,     <span class="comment">/*  6:miBasis_list */</span>
01100         <a class="code" href="shader_8h.html#a882a493">miSCENE_OBJECT</a>,         <span class="comment">/*  7:miObject */</span>
01101         <a class="code" href="shader_8h.html#a882a494">miSCENE_BOX</a>,            <span class="comment">/*  8:miGeoBox */</span>
01102         <a class="code" href="shader_8h.html#a882a495">miSCENE_LINEBOX</a>,        <span class="comment">/*  9:miLinebox */</span>
01103         <a class="code" href="shader_8h.html#a882a496">miSCENE_INSTANCE</a>,       <span class="comment">/* 10:miInstance */</span>
01104         <a class="code" href="shader_8h.html#a882a497">miSCENE_GROUP</a>,          <span class="comment">/* 11:miGroup */</span>
01105         <a class="code" href="shader_8h.html#a882a498">miSCENE_OPTIONS</a>,        <span class="comment">/* 12:miOptions */</span>
01106         <a class="code" href="shader_8h.html#a882a499">miSCENE_IMAGE</a>,          <span class="comment">/* 13:image data type */</span>
01107         <a class="code" href="shader_8h.html#a882a500">miSCENE_POLYGON</a>,        <span class="comment">/* 14:miPolygon [] */</span>
01108         <a class="code" href="shader_8h.html#a882a501">miSCENE_INDEX</a>,          <span class="comment">/* 15:miIndex [], used as indices */</span>
01109         <a class="code" href="shader_8h.html#a882a502">miSCENE_GEOINDEX</a>,       <span class="comment">/* 16:miGeoIndex [], used as indices */</span>
01110         <a class="code" href="shader_8h.html#a882a503">miSCENE_VERTEX</a>,         <span class="comment">/* 17:miIndex [], used as vertices */</span>
01111         <a class="code" href="shader_8h.html#a882a504">miSCENE_GEOVERTEX</a>,      <span class="comment">/* 18:miGeoIndex [], used as vertices */</span>
01112         <a class="code" href="shader_8h.html#a882a505">miSCENE_VECTOR</a>,         <span class="comment">/* 19:miVector [] */</span>
01113         <a class="code" href="shader_8h.html#a882a506">miSCENE_GEOVECTOR</a>,      <span class="comment">/* 20:miGeoVector [] */</span>
01114         <a class="code" href="shader_8h.html#a882a507">miSCENE_FACE</a>,           <span class="comment">/* 21:miFace [] */</span>
01115         <a class="code" href="shader_8h.html#a882a508">miSCENE_SURFACE</a>,        <span class="comment">/* 22:miSurface [] */</span>
01116         <a class="code" href="shader_8h.html#a882a509">miSCENE_CURVE</a>,          <span class="comment">/* 23:miCurve [] */</span>
01117         <a class="code" href="shader_8h.html#a882a510">miSCENE_CURVPNT</a>,        <span class="comment">/* 24:miCurve_point [] */</span>
01118         <a class="code" href="shader_8h.html#a882a511">miSCENE_SCALAR</a>,         <span class="comment">/* 25:miScalar [] */</span>
01119         <a class="code" href="shader_8h.html#a882a512">miSCENE_GEOSCALAR</a>,      <span class="comment">/* 26:miGeoScalar [] */</span>
01120         <a class="code" href="shader_8h.html#a882a513">miSCENE_ALGEBRAIC</a>,      <span class="comment">/* 27:miAlgebraic [] */</span>
01121         <a class="code" href="shader_8h.html#a882a514">miSCENE_TAG</a>,            <span class="comment">/* 28:miTag [] */</span>
01122         <a class="code" href="shader_8h.html#a882a515">miSCENE_STRING</a>,         <span class="comment">/* 29:char [] */</span>
01123         <a class="code" href="shader_8h.html#a882a516">miSCENE_SPACECURVE</a>,     <span class="comment">/* 30:miSpacecurve [] */</span>
01124         <a class="code" href="shader_8h.html#a882a517">miSCENE_BOOK</a>,           <span class="comment">/* 31:miBook */</span>
01125         <a class="code" href="shader_8h.html#a882a518">miSCENE_PAGE</a>,           <span class="comment">/* 32:miPage */</span>
01126         <a class="code" href="shader_8h.html#a882a519">miSCENE_SUBDIVSURF</a>,     <span class="comment">/* 33:miSurf_subsurf */</span>
01127         <a class="code" href="shader_8h.html#a882a520">miSCENE_USERDATA</a>,       <span class="comment">/* 34:miUserdata */</span>
01128         <a class="code" href="shader_8h.html#a882a521">miSCENE_WORLD</a>,          <span class="comment">/* 35:&lt;dummy for worlds&gt; */</span>
01129         <a class="code" href="shader_8h.html#a882a522">miSCENE_SESSION</a>,        <span class="comment">/* 36:miTag[1]: World */</span>
01130         <a class="code" href="shader_8h.html#a882a523">miSCENE_TRANSACTION</a>,    <span class="comment">/* 37:miTag[2]: World,Session */</span>
01131         <a class="code" href="shader_8h.html#a882a524">miSCENE_SPLIT</a>,          <span class="comment">/* 38:miScene_split: for WST-aware DB */</span>
01132         <a class="code" href="shader_8h.html#a882a525">miSCENE_IMATTER</a>,        <span class="comment">/* 39:char []: opaque for imatter/iraylib */</span>
01133         <a class="code" href="shader_8h.html#a882a526">miSCENE_BSPTREE</a>,        <span class="comment">/* 40:miBsptree: ray - object intersect */</span>
01134         <a class="code" href="shader_8h.html#a882a527">miSCENE_LOCAL</a>,          <span class="comment">/* 41:byte[], host-local unswappable data */</span>
01135         <a class="code" href="shader_8h.html#a882a528">miSCENE_SPLITOBJECT</a>,    <span class="comment">/* 42:miSplit_object */</span>
01136         <a class="code" href="shader_8h.html#a882a529">miSCENE_INDEXRANGE</a>,     <span class="comment">/* 43:miIndex_range */</span>
01137         <a class="code" href="shader_8h.html#a882a530">miSCENE_LIGHTPROFILE</a>,   <span class="comment">/* 44:light profiles*/</span>
01138         <a class="code" href="shader_8h.html#a882a531">miSCENE_HARDWARE</a>,       <span class="comment">/* 45:hardware shaders */</span>
01139         <a class="code" href="shader_8h.html#a882a532">miSCENE_LIGHTPROFILE_STD</a>,       <span class="comment">/* 46: light profile descr. */</span>
01140         <a class="code" href="shader_8h.html#a882a533">miSCENE_APPROX_LIST</a>,    <span class="comment">/* 47:miApprox array*/</span>
01141         <a class="code" href="shader_8h.html#a882a534">miSCENE_VENDOR</a>,         <span class="comment">/* 48:miVendor describes OpenGL hardware */</span>
01142 
01143         <a class="code" href="shader_8h.html#a882a535">miSCENE_NTYPES</a> = 64     <span class="comment">/* user defs start with this index */</span>
01144 } <a class="code" href="shader_8h.html#a882">miScene_types</a>;
01145 
01146 <span class="comment">/*------------ mi_scene_db.h ------------*/</span>
01147 
<a name="l01148"></a><a class="code" href="shader_8h.html#a883">01148</a> <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a883">miApprox_method</a> {
01149         <a class="code" href="shader_8h.html#a883a536">miAPPROX_PARAMETRIC</a>,
01150         <a class="code" href="shader_8h.html#a883a537">miAPPROX_REGULAR</a>,
01151         <a class="code" href="shader_8h.html#a883a538">miAPPROX_SPATIAL</a>,
01152         <a class="code" href="shader_8h.html#a883a539">miAPPROX_CURVATURE</a>,
01153         <a class="code" href="shader_8h.html#a883a540">miAPPROX_LDA</a>,
01154         <a class="code" href="shader_8h.html#a883a541">miAPPROX_ADJACENCY</a>,             <span class="comment">/* only for curves                   */</span>
01155         <a class="code" href="shader_8h.html#a883a542">miAPPROX_ALGEBRAIC</a>,             <span class="comment">/* only for surfaces                 */</span>
01156         <a class="code" href="shader_8h.html#a883a543">miAPPROX_DEFTRIM</a>,               <span class="comment">/* only for miFace def_trim_approx   */</span>
01157         <a class="code" href="shader_8h.html#a883a544">miAPPROX_REGULAR_PERCENT</a>,       <span class="comment">/* new in 3.2, regular param n% m%   */</span>
01158         <a class="code" href="shader_8h.html#a883a545">miAPPROX_INDIRECT</a>,              <span class="comment">/* in which case                     */</span>
01159                                         <span class="comment">/* cnst[miCNST_VISIBLE]              */</span>
01160                                         <span class="comment">/* cnst[miCNST_SHADOW] ...           */</span>
01161                                         <span class="comment">/* are offsets into approx list      */</span>
01162         <a class="code" href="shader_8h.html#a883a546">miAPPROX_NMETHODS</a>
01163 };
01164 
<a name="l01165"></a><a class="code" href="shader_8h.html#a884">01165</a> <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a884">miApprox_style</a> {
01166         <a class="code" href="shader_8h.html#a884a547">miAPPROX_STYLE_NONE</a> = 0,        <span class="comment">/* must be 0 for miOptions default */</span>
01167         <a class="code" href="shader_8h.html#a884a548">miAPPROX_STYLE_GRID</a>,            <span class="comment">/* (0 means don't override) */</span>
01168         <a class="code" href="shader_8h.html#a884a549">miAPPROX_STYLE_TREE</a>,
01169         <a class="code" href="shader_8h.html#a884a550">miAPPROX_STYLE_DELAUNAY</a>,
01170         <a class="code" href="shader_8h.html#a884a551">miAPPROX_STYLE_CONTOUR</a>,         <span class="comment">/* contour-based displacement */</span>
01171         <a class="code" href="shader_8h.html#a884a552">miAPPROX_STYLE_CONTOUR_NORM</a>,    <span class="comment">/* same but shader requires normals */</span>
01172         <a class="code" href="shader_8h.html#a884a553">miAPPROX_STYLE_FINE</a>,            <span class="comment">/* sub-object/subpixel tessellation */</span>
01173         <a class="code" href="shader_8h.html#a884a554">miAPPROX_NSTYLES</a>
01174 };
01175 
<a name="l01176"></a><a class="code" href="shader_8h.html#a66">01176</a> <span class="preprocessor">#define miCNST_UPARAM     0             </span><span class="comment">/* regular/parametric only */</span>
<a name="l01177"></a><a class="code" href="shader_8h.html#a67">01177</a> <span class="preprocessor">#define miCNST_VPARAM     1</span>
<a name="l01178"></a><a class="code" href="shader_8h.html#a68">01178</a> <span class="preprocessor"></span><span class="preprocessor">#define miCNST_LENGTH     0             </span><span class="comment">/* curvature/spatial only  */</span>
<a name="l01179"></a><a class="code" href="shader_8h.html#a69">01179</a> <span class="preprocessor">#define miCNST_DISTANCE   1</span>
<a name="l01180"></a><a class="code" href="shader_8h.html#a70">01180</a> <span class="preprocessor"></span><span class="preprocessor">#define miCNST_ANGLE      2</span>
01181 <span class="preprocessor"></span>
<a name="l01182"></a><a class="code" href="shader_8h.html#a885">01182</a> <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a885">miCnst_type</a> {
01183         <a class="code" href="shader_8h.html#a885a555">miCNST_VISIBLE</a>  = 0,            <span class="comment">/* for accessing (int)cnst[0] */</span>
01184         <a class="code" href="shader_8h.html#a885a556">miCNST_TRACE</a>,
01185         <a class="code" href="shader_8h.html#a885a557">miCNST_SHADOW</a>,
01186         <a class="code" href="shader_8h.html#a885a558">miCNST_CAUSTIC</a>,
01187         <a class="code" href="shader_8h.html#a885a559">miCNST_GLOBILLUM</a>,
01188         <a class="code" href="shader_8h.html#a885a560">miCNST_NTYPES</a>                   <span class="comment">/* must not be &gt; 7 ! */</span>
01189 };
01190 
<a name="l01191"></a><a class="code" href="shader_8h.html#a886">01191</a> <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a886">miApprox_flag</a> {
01192         <a class="code" href="shader_8h.html#a886a561">miAPPROX_FLAG_ANY</a>       = 0,                    <span class="comment">/* f. all rays (31)  */</span>
01193         <a class="code" href="shader_8h.html#a886a562">miAPPROX_FLAG_VISIBLE</a>   = 1 &lt;&lt; <a class="code" href="shader_8h.html#a885a555">miCNST_VISIBLE</a>,  <span class="comment">/* f. 1-gen rays     */</span>
01194         <a class="code" href="shader_8h.html#a886a563">miAPPROX_FLAG_TRACE</a>     = 1 &lt;&lt; <a class="code" href="shader_8h.html#a885a556">miCNST_TRACE</a>,    <span class="comment">/* f. trace rays     */</span>
01195         <a class="code" href="shader_8h.html#a886a564">miAPPROX_FLAG_SHADOW</a>    = 1 &lt;&lt; <a class="code" href="shader_8h.html#a885a557">miCNST_SHADOW</a>,   <span class="comment">/* f. shadow rays    */</span>
01196         <a class="code" href="shader_8h.html#a886a565">miAPPROX_FLAG_CAUSTIC</a>   = 1 &lt;&lt; <a class="code" href="shader_8h.html#a885a558">miCNST_CAUSTIC</a>,  <span class="comment">/* f. caustic rays   */</span>
01197         <a class="code" href="shader_8h.html#a886a566">miAPPROX_FLAG_GLOBILLUM</a> = 1 &lt;&lt; <a class="code" href="shader_8h.html#a885a559">miCNST_GLOBILLUM</a> <span class="comment">/* f. globillum rays */</span>
01198 };
01199 
<a name="l01200"></a><a class="code" href="structmiApprox.html">01200</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiApprox.html">miApprox</a> {
<a name="l01201"></a><a class="code" href="structmiApprox.html#o0">01201</a>         <a class="code" href="shader_8h.html#a141">miScalar</a>             <a class="code" href="structmiApprox.html#o0">cnst</a>[6];   <span class="comment">/* indexed with miUPARAM...miANGLE   */</span>
<a name="l01202"></a><a class="code" href="structmiApprox.html#o1">01202</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>              <a class="code" href="structmiApprox.html#o1">sharp</a>;     <span class="comment">/* 0=smooth normals, 255=faceted     */</span>
<a name="l01203"></a><a class="code" href="structmiApprox.html#o2">01203</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>              <a class="code" href="structmiApprox.html#o2">flag</a>;      <span class="comment">/* vis, trace, shad: miApprox_flag   */</span>
<a name="l01204"></a><a class="code" href="structmiApprox.html#o3">01204</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>           <a class="code" href="structmiApprox.html#o3">any</a>;       <span class="comment">/* stop if any criterion is met      */</span>
<a name="l01205"></a><a class="code" href="structmiApprox.html#o4">01205</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>           <a class="code" href="structmiApprox.html#o4">view_dep</a>;  <span class="comment">/* view dependent ?                  */</span>
<a name="l01206"></a><a class="code" href="structmiApprox.html#o5">01206</a>         <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a883">miApprox_method</a> <a class="code" href="structmiApprox.html#o5">method</a>;
<a name="l01207"></a><a class="code" href="structmiApprox.html#o6">01207</a>         <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a884">miApprox_style</a>  <a class="code" href="structmiApprox.html#o6">style</a>;
<a name="l01208"></a><a class="code" href="structmiApprox.html#o7">01208</a>         <a class="code" href="shader_8h.html#a137">miUshort</a>             <a class="code" href="structmiApprox.html#o7">subdiv</a>[2]; <span class="comment">/* recursive subdivision depth       */</span>
<a name="l01209"></a><a class="code" href="structmiApprox.html#o8">01209</a>         <a class="code" href="shader_8h.html#a145">miGeoIndex</a>           <a class="code" href="structmiApprox.html#o8">max</a>;       <span class="comment">/* maximum number of triangles       */</span>
01210                                         <span class="comment">/* in case of style contour:</span>
01211 <span class="comment">                                           resolution of sampling grid       */</span>
<a name="l01212"></a><a class="code" href="structmiApprox.html#o9">01212</a>         <a class="code" href="shader_8h.html#a141">miScalar</a>             <a class="code" href="structmiApprox.html#o9">grading</a>;   <span class="comment">/* min angle bound for graded meshing*/</span>
01213 } <a class="code" href="structmiApprox.html">miApprox</a>;
01214 
<a name="l01215"></a><a class="code" href="shader_8h.html#a71">01215</a> <span class="preprocessor">#define miAPPROX_MAX_SUBDIV 7</span>
<a name="l01216"></a><a class="code" href="shader_8h.html#a72">01216</a> <span class="preprocessor"></span><span class="preprocessor">#define miAPPROX_NONE(A) memset(&amp;(A), 0, sizeof(miApprox))</span>
01217 <span class="preprocessor"></span><span class="comment">/*: ! this does not specify a valid approximation (tree + parametric) */</span>
<a name="l01218"></a><a class="code" href="shader_8h.html#a73">01218</a> <span class="preprocessor">#define miAPPROX_DEFAULT(A) do {                 \</span>
01219 <span class="preprocessor">        (A).style         = miAPPROX_STYLE_TREE; \</span>
01220 <span class="preprocessor">        (A).method        = miAPPROX_PARAMETRIC; \</span>
01221 <span class="preprocessor">        (A).sharp         = 0;                   \</span>
01222 <span class="preprocessor">        (A).flag          = miAPPROX_FLAG_ANY;   \</span>
01223 <span class="preprocessor">        (A).any           = miFALSE;             \</span>
01224 <span class="preprocessor">        (A).view_dep      = miFALSE;             \</span>
01225 <span class="preprocessor">        (A).cnst[0]       = 0.0;                 \</span>
01226 <span class="preprocessor">        (A).cnst[1]       = 0.0;                 \</span>
01227 <span class="preprocessor">        (A).cnst[2]       = 0.0;                 \</span>
01228 <span class="preprocessor">        (A).cnst[3]       = 0.0;                 \</span>
01229 <span class="preprocessor">        (A).cnst[4]       = 0.0;                 \</span>
01230 <span class="preprocessor">        (A).cnst[5]       = 0.0;                 \</span>
01231 <span class="preprocessor">        (A).subdiv[miMIN] = 0;                   \</span>
01232 <span class="preprocessor">        (A).subdiv[miMAX] = 5;                   \</span>
01233 <span class="preprocessor">        (A).max           = miHUGE_INT;          \</span>
01234 <span class="preprocessor">        (A).grading       = 0.0; } while (0)</span>
<a name="l01235"></a><a class="code" href="shader_8h.html#a74">01235</a> <span class="preprocessor"></span><span class="preprocessor">#define miAPPROX_FINE_DEFAULT(A) do {            \</span>
01236 <span class="preprocessor">        (A).style         = miAPPROX_STYLE_FINE; \</span>
01237 <span class="preprocessor">        (A).method        = miAPPROX_LDA;        \</span>
01238 <span class="preprocessor">        (A).sharp         = 0;                   \</span>
01239 <span class="preprocessor">        (A).flag          = (1&lt;&lt;miCNST_NTYPES)-1;\</span>
01240 <span class="preprocessor">        (A).any           = miFALSE;             \</span>
01241 <span class="preprocessor">        (A).view_dep      = miTRUE;              \</span>
01242 <span class="preprocessor">        (A).cnst[0]       = 0.25;                \</span>
01243 <span class="preprocessor">        (A).cnst[1]       = 0.0;                 \</span>
01244 <span class="preprocessor">        (A).cnst[2]       = 0.0;                 \</span>
01245 <span class="preprocessor">        (A).cnst[3]       = 0.0;                 \</span>
01246 <span class="preprocessor">        (A).cnst[4]       = 0.0;                 \</span>
01247 <span class="preprocessor">        (A).cnst[5]       = 0.0;                 \</span>
01248 <span class="preprocessor">        (A).subdiv[miMIN] = 0;                   \</span>
01249 <span class="preprocessor">        (A).subdiv[miMAX] = miAPPROX_MAX_SUBDIV; \</span>
01250 <span class="preprocessor">        (A).max           = miHUGE_INT;          \</span>
01251 <span class="preprocessor">        (A).grading       = 0.0; } while (0)</span>
<a name="l01252"></a><a class="code" href="shader_8h.html#a75">01252</a> <span class="preprocessor"></span><span class="preprocessor">#define miRC_MAX_IMAGES         16              </span><span class="comment">/* max. number of frame bufs */</span>
<a name="l01253"></a><a class="code" href="shader_8h.html#a76">01253</a> <span class="preprocessor">#define miRC_IMAGE_RGBA         0               </span><span class="comment">/* standard RGBA color fb */</span>
<a name="l01254"></a><a class="code" href="shader_8h.html#a77">01254</a> <span class="preprocessor">#define miRC_IMAGE_Z            1               </span><span class="comment">/* standard depth fb */</span>
<a name="l01255"></a><a class="code" href="shader_8h.html#a78">01255</a> <span class="preprocessor">#define miRC_IMAGE_N            2               </span><span class="comment">/* standard normal-vector fb */</span>
<a name="l01256"></a><a class="code" href="shader_8h.html#a79">01256</a> <span class="preprocessor">#define miRC_IMAGE_M            3               </span><span class="comment">/* standard motion-vector fb */</span>
<a name="l01257"></a><a class="code" href="shader_8h.html#a80">01257</a> <span class="preprocessor">#define miRC_IMAGE_TAG          4               </span><span class="comment">/* standard object label fb */</span>
<a name="l01258"></a><a class="code" href="shader_8h.html#a81">01258</a> <span class="preprocessor">#define miRC_IMAGE_COVERAGE     5               </span><span class="comment">/* coverage framebuffer */</span>
<a name="l01259"></a><a class="code" href="shader_8h.html#a82">01259</a> <span class="preprocessor">#define miRC_IMAGE_PPREV        7               </span><span class="comment">/* reserved for pixel preview*/</span>
<a name="l01260"></a><a class="code" href="shader_8h.html#a83">01260</a> <span class="preprocessor">#define miRC_IMAGE_USER         8               </span><span class="comment">/* first user-defined fb */</span>
<a name="l01261"></a><a class="code" href="shader_8h.html#a84">01261</a> <span class="preprocessor">#define miRC_CLIP_MIN           0.001           </span><span class="comment">/* min near clipping plane */</span>
01262 
<a name="l01263"></a><a class="code" href="shader_8h.html#a85">01263</a> <span class="preprocessor">#define miRc_options            miOptions       </span><span class="comment">/* backwards compatibility */</span>
01264 
01265 <span class="comment">/* bit definitions for miOptions.diagnostic_mode */</span>
<a name="l01266"></a><a class="code" href="shader_8h.html#a86">01266</a> <span class="preprocessor">#define miSCENE_DIAG_SAMPLES    1               </span><span class="comment">/* turn on sample view mode */</span>
<a name="l01267"></a><a class="code" href="shader_8h.html#a87">01267</a> <span class="preprocessor">#define miSCENE_DIAG_PHOTON     6               </span><span class="comment">/* photon 2 bits  */</span>
<a name="l01268"></a><a class="code" href="shader_8h.html#a88">01268</a> <span class="preprocessor">#define miSCENE_DIAG_PHOTON_D   2               </span><span class="comment">/* photon density  */</span>
<a name="l01269"></a><a class="code" href="shader_8h.html#a89">01269</a> <span class="preprocessor">#define miSCENE_DIAG_PHOTON_I   4               </span><span class="comment">/* photon irradiance  */</span>
<a name="l01270"></a><a class="code" href="shader_8h.html#a90">01270</a> <span class="preprocessor">#define miSCENE_DIAG_GRID       24              </span><span class="comment">/* grid 2 bits */</span>
<a name="l01271"></a><a class="code" href="shader_8h.html#a91">01271</a> <span class="preprocessor">#define miSCENE_DIAG_GRID_O     8               </span><span class="comment">/* object_space_grid*/</span>
<a name="l01272"></a><a class="code" href="shader_8h.html#a92">01272</a> <span class="preprocessor">#define miSCENE_DIAG_GRID_W     16              </span><span class="comment">/* world_space_grid*/</span>
<a name="l01273"></a><a class="code" href="shader_8h.html#a93">01273</a> <span class="preprocessor">#define miSCENE_DIAG_GRID_C     24              </span><span class="comment">/* camera_space_grid*/</span>
<a name="l01274"></a><a class="code" href="shader_8h.html#a94">01274</a> <span class="preprocessor">#define miSCENE_DIAG_BSP_D      32              </span><span class="comment">/* bsp tree depth */</span>
<a name="l01275"></a><a class="code" href="shader_8h.html#a95">01275</a> <span class="preprocessor">#define miSCENE_DIAG_BSP_L      64              </span><span class="comment">/* bsp tree leaf size */</span>
<a name="l01276"></a><a class="code" href="shader_8h.html#a96">01276</a> <span class="preprocessor">#define miSCENE_DIAG_BSP        96              </span><span class="comment">/* bsp 2 bits */</span>
<a name="l01277"></a><a class="code" href="shader_8h.html#a97">01277</a> <span class="preprocessor">#define miSCENE_DIAG_FG         128             </span><span class="comment">/* final gather */</span>
01278 
01279 <span class="comment">/* bit definitions for miOptions.hardware_diagnostic */</span>
<a name="l01280"></a><a class="code" href="shader_8h.html#a98">01280</a> <span class="preprocessor">#define miSCENE_HWDIAG_MESH_O   1               </span><span class="comment">/* hardware mesh only */</span>
<a name="l01281"></a><a class="code" href="shader_8h.html#a99">01281</a> <span class="preprocessor">#define miSCENE_HWDIAG_MESH_B   2               </span><span class="comment">/* hardware mesh and render */</span>
<a name="l01282"></a><a class="code" href="shader_8h.html#a100">01282</a> <span class="preprocessor">#define miSCENE_HWDIAG_MESH     3               </span><span class="comment">/* hardware mesh: 2 bits */</span>
<a name="l01283"></a><a class="code" href="shader_8h.html#a101">01283</a> <span class="preprocessor">#define miSCENE_HWDIAG_LIGHTS   4               </span><span class="comment">/* show light sources */</span>
01284 
01285 <span class="comment">/* bit definitions for miOptions.motion */</span>
<a name="l01286"></a><a class="code" href="shader_8h.html#a102">01286</a> <span class="preprocessor">#define miSCENE_MOTION_ON       1               </span><span class="comment">/* motion blur on */</span>
<a name="l01287"></a><a class="code" href="shader_8h.html#a103">01287</a> <span class="preprocessor">#define miSCENE_MOTION_C_INT    2               </span><span class="comment">/* camera instance interp. */</span>
01288 
01289 <span class="comment">/* bit definitions for shadowmaps */</span>
<a name="l01290"></a><a class="code" href="shader_8h.html#a104">01290</a> <span class="preprocessor">#define miSHADOWMAP_MERGE       0x01</span>
<a name="l01291"></a><a class="code" href="shader_8h.html#a105">01291</a> <span class="preprocessor"></span><span class="preprocessor">#define miSHADOWMAP_TRACE       0x02</span>
<a name="l01292"></a><a class="code" href="shader_8h.html#a106">01292</a> <span class="preprocessor"></span><span class="preprocessor">#define miSHADOWMAP_CROP        0x04</span>
<a name="l01293"></a><a class="code" href="shader_8h.html#a107">01293</a> <span class="preprocessor"></span><span class="preprocessor">#define miSHADOWMAP_ONLY        0x08</span>
01294 <span class="preprocessor"></span>
<a name="l01295"></a><a class="code" href="structmiOptions.html">01295</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiOptions.html">miOptions</a> {
<a name="l01296"></a><a class="code" href="structmiOptions.html#o0">01296</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o0">trace</a>;                  <span class="comment">/* 2nd generation ray trace? */</span>
<a name="l01297"></a><a class="code" href="structmiOptions.html#o1">01297</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o1">scanline</a>;               <span class="comment">/* 0=off, 1=on, 'o'=OpenGL */</span>
<a name="l01298"></a><a class="code" href="structmiOptions.html#o2">01298</a>         <a class="code" href="shader_8h.html#a135">miUint</a>          <a class="code" href="structmiOptions.html#o2">motion</a>;                 <span class="comment">/* motion blur? : miFALSE */</span>
<a name="l01299"></a><a class="code" href="structmiOptions.html#o3">01299</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o3">shadow_sort</a>;            <span class="comment">/* Obsolete! Do not use */</span>
<a name="l01300"></a><a class="code" href="structmiOptions.html#o4">01300</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o4">preview_mode</a>;           <span class="comment">/* for future use */</span>
<a name="l01301"></a><a class="code" href="structmiOptions.html#o5">01301</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o5">reflection_depth</a>;       <span class="comment">/* refl. trace depth : 1 */</span>
<a name="l01302"></a><a class="code" href="structmiOptions.html#o6">01302</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o6">refraction_depth</a>;       <span class="comment">/* refr. trace depth : 1 */</span>
<a name="l01303"></a><a class="code" href="structmiOptions.html#o7">01303</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o7">trace_depth</a>;            <span class="comment">/* refl. + refr. depth : 1 */</span>
<a name="l01304"></a><a class="code" href="structmiOptions.html#o8">01304</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o8">min_samples</a>;            <span class="comment">/* min. sampling level : -2 */</span>
<a name="l01305"></a><a class="code" href="structmiOptions.html#o9">01305</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o9">max_samples</a>;            <span class="comment">/* max. sampling level : 0 */</span>
<a name="l01306"></a><a class="code" href="structmiOptions.html#o10">01306</a>         <a class="code" href="structmiColor.html">miColor</a>         <a class="code" href="structmiOptions.html#o10">contrast</a>;               <span class="comment">/* sampling contrast: .1 */</span>
<a name="l01307"></a><a class="code" href="structmiOptions.html#o11">01307</a>         <a class="code" href="structmiColor.html">miColor</a>         <a class="code" href="structmiOptions.html#o11">time_contrast</a>;          <span class="comment">/* temporal sampling contrast*/</span>
<a name="l01308"></a><a class="code" href="structmiOptions.html#o12">01308</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiOptions.html#o12">contour_contrast</a>;       <span class="comment">/* NULLTAG */</span>
<a name="l01309"></a><a class="code" href="structmiOptions.html#o13">01309</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiOptions.html#o13">contour_store</a>;          <span class="comment">/* NULLTAG */</span>
<a name="l01310"></a><a class="code" href="structmiOptions.html#o14">01310</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o14">caustic</a>;                <span class="comment">/* enable caustics: miFALSE */</span>
<a name="l01311"></a><a class="code" href="structmiOptions.html#o15">01311</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o15">globillum</a>;              <span class="comment">/* enable global il.: miFALSE*/</span>
<a name="l01312"></a><a class="code" href="structmiOptions.html#o16">01312</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o16">caustic_accuracy</a>;       <span class="comment">/* no. caus. photons in est. */</span>
<a name="l01313"></a><a class="code" href="structmiOptions.html#o17">01313</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o17">caustic_radius</a>;         <span class="comment">/* maxdist for caus. photons */</span>
<a name="l01314"></a><a class="code" href="structmiOptions.html#o18">01314</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o18">globillum_accuracy</a>;     <span class="comment">/* no. glob. photons in est. */</span>
<a name="l01315"></a><a class="code" href="structmiOptions.html#o19">01315</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o19">globillum_radius</a>;       <span class="comment">/* maxdist for glob. photons */</span>
<a name="l01316"></a><a class="code" href="structmiOptions.html#o20">01316</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o20">caustic_filter_const</a>;   <span class="comment">/* filter const. for caus. */</span>
<a name="l01317"></a><a class="code" href="structmiOptions.html#o21">01317</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o21">filter_size_x</a>;          <span class="comment">/* filter size in x : 1.0 */</span>
<a name="l01318"></a><a class="code" href="structmiOptions.html#o22">01318</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o22">filter_size_y</a>;          <span class="comment">/* filter size in y : 1.0 */</span>
<a name="l01319"></a><a class="code" href="structmiOptions.html#o23">01319</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o23">jitter</a>;                 <span class="comment">/* sample jittering : 0.0 */</span>
<a name="l01320"></a><a class="code" href="structmiOptions.html#o24">01320</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o24">shutter</a>;                <span class="comment">/* shutter close time: 0 */</span>
<a name="l01321"></a><a class="code" href="structmiOptions.html#o25">01321</a>         <span class="keywordtype">short</span>           <a class="code" href="structmiOptions.html#o25">grid_res</a>[3];            <span class="comment">/* grid resolution */</span>
<a name="l01322"></a><a class="code" href="structmiOptions.html#o26">01322</a>         <span class="keywordtype">short</span>           <a class="code" href="structmiOptions.html#o26">grid_max_size</a>;          <span class="comment">/* max obj. in grid cell */</span>
<a name="l01323"></a><a class="code" href="structmiOptions.html#o27">01323</a>         <span class="keywordtype">short</span>           <a class="code" href="structmiOptions.html#o27">grid_max_depth</a>;         <span class="comment">/* max grid nesting */</span>
<a name="l01324"></a><a class="code" href="structmiOptions.html#o28">01324</a>         <a class="code" href="shader_8h.html#a129">miSint1</a>         <a class="code" href="structmiOptions.html#o28">def_min_samples</a>;        <span class="comment">/* min/max samples for objs */</span>
<a name="l01325"></a><a class="code" href="structmiOptions.html#o29">01325</a>         <a class="code" href="shader_8h.html#a129">miSint1</a>         <a class="code" href="structmiOptions.html#o29">def_max_samples</a>;        <span class="comment">/* without min/max, -128 127 */</span>
<a name="l01326"></a><a class="code" href="structmiOptions.html#o30">01326</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o30">space_max_size</a>;         <span class="comment">/* space subdiv. leaf size: 4*/</span>
<a name="l01327"></a><a class="code" href="structmiOptions.html#o31">01327</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o31">space_max_depth</a>;        <span class="comment">/* space subdiv. depth : 25*/</span>
<a name="l01328"></a><a class="code" href="structmiOptions.html#o32">01328</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o32">shutter_delay</a>;          <span class="comment">/* shutter open time: 0 */</span>
<a name="l01329"></a><a class="code" href="structmiOptions.html#o33">01329</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o33">no_images</a>;              <span class="comment">/* # images : 1 */</span>
<a name="l01330"></a><a class="code" href="structmiOptions.html#o34">01330</a>         <a class="code" href="shader_8h.html#a878">miImg_type</a>      <a class="code" href="structmiOptions.html#o34">image_types</a>[<a class="code" href="shader_8h.html#a75">miRC_MAX_IMAGES</a>];  <span class="comment">/* image types */</span>
01331                                                 <span class="comment">/* miIMG_TYPE_RGBA, ...ANY...*/</span>
<a name="l01332"></a><a class="code" href="structmiOptions.html#o35">01332</a>         <a class="code" href="shader_8h.html#a134">miUint4</a>         <a class="code" href="structmiOptions.html#o35">write_image</a>[<a class="code" href="shader_8h.html#a75">miRC_MAX_IMAGES</a>];  <span class="comment">/* what to do with it */</span>
01333                                                 <span class="comment">/* bits: 0=sample image */</span>
01334                                                 <span class="comment">/*       1=write  image */</span>
<a name="l01335"></a><a class="code" href="structmiOptions.html#o36">01335</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o36">interp_image</a>[<a class="code" href="shader_8h.html#a75">miRC_MAX_IMAGES</a>]; <span class="comment">/* interpolate image? */</span>
01336                                                 <span class="comment">/* miTRUE, miFALSE ... */</span>
<a name="l01337"></a><a class="code" href="structmiOptions.html#o37">01337</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiOptions.html#o37">finalgather_file</a>;       <span class="comment">/* finalgather map file: 0 */</span>
<a name="l01338"></a><a class="code" href="structmiOptions.html#o38">01338</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o38">space_shadow_separate</a>;  <span class="comment">/* space subdiv shadow struct*/</span>
<a name="l01339"></a><a class="code" href="structmiOptions.html#o39">01339</a>         <a class="code" href="shader_8h.html#a136">miUchar</a>         <a class="code" href="structmiOptions.html#o39">finalgather_filter</a>;     <span class="comment">/* finalgather ray filter */</span>
<a name="l01340"></a><a class="code" href="structmiOptions.html#o40">01340</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o40">rapid_collect_rate</a>;     <span class="comment">/* rapid motion only: # of */</span>
01341                                                 <span class="comment">/* fragment samples per pixel*/</span>
01342                                                 <span class="comment">/* 0=use 1&lt;&lt;max_samples (def)*/</span>
<a name="l01343"></a><a class="code" href="structmiOptions.html#o41">01343</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o41">rapid_motion_resample</a>;  <span class="comment">/* rapid motion only: # of */</span>
01344                                                 <span class="comment">/* time samples for movng geo*/</span>
<a name="l01345"></a><a class="code" href="structmiOptions.html#o42">01345</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o42">use_shadow_maps</a>;        <span class="comment">/* 0=off, 1=on, 'o'=opengl*/</span>
01346                                                 <span class="comment">/* bit7: only shmap,no render*/</span>
<a name="l01347"></a><a class="code" href="structmiOptions.html#o43">01347</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o43">rendering_shadow_maps</a>;  <span class="comment">/* Shadow map mode? 0 */</span>
<a name="l01348"></a><a class="code" href="structmiOptions.html#o44">01348</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o44">recompute_shadow_maps</a>;  <span class="comment">/* 'n'o,'y'es (could be Bool)*/</span>
<a name="l01349"></a><a class="code" href="structmiOptions.html#o45">01349</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o45">shadow</a>;                 <span class="comment">/* shadow casting? : 1 */</span>
01350                                                 <span class="comment">/* 0 off, 1 on, 'l' sort, */</span>
01351                                                 <span class="comment">/* 's' segments */</span>
<a name="l01352"></a><a class="code" href="structmiOptions.html#o46">01352</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o46">caustic_filter</a>;         <span class="comment">/* filter-type */</span>
01353                                                 <span class="comment">/* 'b' box, 'c' cone, */</span>
01354                                                 <span class="comment">/* 'g' gaussian */</span>
<a name="l01355"></a><a class="code" href="structmiOptions.html#o47">01355</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o47">finalgather_rebuild</a>;    <span class="comment">/* rebuild FG ?: on*/</span>
<a name="l01356"></a><a class="code" href="structmiOptions.html#o48">01356</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o48">filter</a>;                 <span class="comment">/* sample filter type : 'b' */</span>
01357                                                 <span class="comment">/* 'b' box, 't' triangle, */</span>
01358                                                 <span class="comment">/* 'g' gauss */</span>
<a name="l01359"></a><a class="code" href="structmiOptions.html#o49">01359</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o49">acceleration</a>;           <span class="comment">/* acceleration: 'b'         */</span>
01360                                                 <span class="comment">/* 'c' ray classification,   */</span>
01361                                                 <span class="comment">/* 'b' bsp, 'g' grid         */</span>
01362                                                 <span class="comment">/* 'l' large (flushing) bsp  */</span>
<a name="l01363"></a><a class="code" href="structmiOptions.html#o50">01363</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o50">face</a>;                   <span class="comment">/* primitive facing: 'a' */</span>
01364                                                 <span class="comment">/* 'f' front, 'b' back, */</span>
01365                                                 <span class="comment">/* 'a' all */</span>
<a name="l01366"></a><a class="code" href="structmiOptions.html#o51">01366</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o51">field</a>;                  <span class="comment">/* field rendering? 0 */</span>
01367                                                 <span class="comment">/* 0 off, 'e' even, 'o' odd */</span>
<a name="l01368"></a><a class="code" href="structmiOptions.html#o52">01368</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o52">smethod</a>;                <span class="comment">/* sampling algorithm: 'q' */</span>
<a name="l01369"></a><a class="code" href="structmiOptions.html#o53">01369</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiOptions.html#o53">render_space</a>;           <span class="comment">/* coordinate space 'o' */</span>
01370                                                 <span class="comment">/* 'c' camera space, */</span>
01371                                                 <span class="comment">/* 'o' object space, */</span>
01372                                                 <span class="comment">/* 'm' mixed space */</span>
<a name="l01373"></a><a class="code" href="structmiOptions.html#o54">01373</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o54">pixel_preview</a>;          <span class="comment">/* pixel selective sampling */</span>
<a name="l01374"></a><a class="code" href="structmiOptions.html#o55">01374</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o55">task_preview</a>;           <span class="comment">/* task selective sampling */</span>
<a name="l01375"></a><a class="code" href="structmiOptions.html#o56">01375</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o56">visible_lights</a>;         <span class="comment">/* any visible area lights? */</span>
<a name="l01376"></a><a class="code" href="structmiOptions.html#o57">01376</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o57">shadow_map_motion</a>;      <span class="comment">/* motion blurred shadowmaps?*/</span>
<a name="l01377"></a><a class="code" href="structmiOptions.html#o58">01377</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o58">task_size</a>;              <span class="comment">/* image task size : 0 */</span>
<a name="l01378"></a><a class="code" href="structmiOptions.html#o59">01378</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o59">strips</a>;                 <span class="comment">/* GAP returns triangles in</span>
01379 <span class="comment">                                                   strips */</span>
<a name="l01380"></a><a class="code" href="structmiOptions.html#o60">01380</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiOptions.html#o60">photonmap_file</a>;         <span class="comment">/* photon map file name */</span>
<a name="l01381"></a><a class="code" href="structmiOptions.html#o61">01381</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o61">photonmap_rebuild</a>;      <span class="comment">/* photon map rebuild ? */</span>
<a name="l01382"></a><a class="code" href="structmiOptions.html#o62">01382</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o62">photon_reflection_depth</a>;<span class="comment">/* photon refl. depth */</span>
<a name="l01383"></a><a class="code" href="structmiOptions.html#o63">01383</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o63">photon_refraction_depth</a>;<span class="comment">/* photon refr. depth */</span>
<a name="l01384"></a><a class="code" href="structmiOptions.html#o64">01384</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o64">photon_trace_depth</a>;     <span class="comment">/* total photon trace depth */</span>
<a name="l01385"></a><a class="code" href="structmiOptions.html#o65">01385</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o65">space_max_mem</a>;          <span class="comment">/* maximum bsp memory (mb):0 */</span>
<a name="l01386"></a><a class="code" href="structmiOptions.html#o66">01386</a>         <a class="code" href="unionmiPointer.html">miPointer</a>       <a class="code" href="structmiOptions.html#o66">image</a>[<a class="code" href="shader_8h.html#a75">miRC_MAX_IMAGES</a>]; <span class="comment">/* pointers to frame buffers */</span>
01387                                                 <span class="comment">/* (for output shaders only) */</span>
<a name="l01388"></a><a class="code" href="structmiOptions.html#o67">01388</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o67">no_lens</a>;                <span class="comment">/* disable lens shaders */</span>
<a name="l01389"></a><a class="code" href="structmiOptions.html#o68">01389</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o68">no_volume</a>;              <span class="comment">/* disable volume shaders */</span>
<a name="l01390"></a><a class="code" href="structmiOptions.html#o69">01390</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o69">no_geometry</a>;            <span class="comment">/* disable geometry shaders */</span>
<a name="l01391"></a><a class="code" href="structmiOptions.html#o70">01391</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o70">no_displace</a>;            <span class="comment">/* disable displace shaders */</span>
<a name="l01392"></a><a class="code" href="structmiOptions.html#o71">01392</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o71">no_output</a>;              <span class="comment">/* disable output shaders */</span>
<a name="l01393"></a><a class="code" href="structmiOptions.html#o72">01393</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o72">no_merge</a>;               <span class="comment">/* disable surface merging */</span>
<a name="l01394"></a><a class="code" href="structmiOptions.html#o73">01394</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o73">caustic_flag</a>;           <span class="comment">/* def. caustic flag for objs*/</span>
<a name="l01395"></a><a class="code" href="structmiOptions.html#o74">01395</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o74">diagnostic_mode</a>;        <span class="comment">/* miSCENE_DIAG_* flags */</span>
<a name="l01396"></a><a class="code" href="structmiOptions.html#o75">01396</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o75">photonvol_accuracy</a>;     <span class="comment">/* no. vol. photons in est. */</span>
<a name="l01397"></a><a class="code" href="structmiOptions.html#o76">01397</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o76">photonvol_radius</a>;       <span class="comment">/* maxdist for vol. photons */</span>
<a name="l01398"></a><a class="code" href="structmiOptions.html#o77">01398</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o77">globillum_flag</a>;         <span class="comment">/* def. globil. flag for objs*/</span>
<a name="l01399"></a><a class="code" href="structmiOptions.html#o78">01399</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o78">samplelock</a>;             <span class="comment">/* steady samples?: on */</span>
<a name="l01400"></a><a class="code" href="structmiOptions.html#o79">01400</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o79">autovolume</a>;             <span class="comment">/* internal volumes? */</span>
<a name="l01401"></a><a class="code" href="structmiOptions.html#o80">01401</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o80">finalgather_view</a>;       <span class="comment">/* radii in raster pixels ? */</span>
<a name="l01402"></a><a class="code" href="structmiOptions.html#o81">01402</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o81">no_hair</a>;                <span class="comment">/* disable hair rendering */</span>
<a name="l01403"></a><a class="code" href="structmiOptions.html#o82">01403</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o82">n_motion_vectors</a>;       <span class="comment">/* global number of motions */</span>
<a name="l01404"></a><a class="code" href="structmiOptions.html#o83">01404</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o83">no_pass</a>;                <span class="comment">/* disable multipass render */</span>
<a name="l01405"></a><a class="code" href="structmiOptions.html#o84">01405</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o84">photon_autovolume</a>;      <span class="comment">/* autovolume for photons */</span>
<a name="l01406"></a><a class="code" href="structmiOptions.html#o85">01406</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o85">no_predisplace</a>;         <span class="comment">/* disable displ presampling */</span>
<a name="l01407"></a><a class="code" href="structmiOptions.html#o86">01407</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o86">fg_reflection_depth</a>;    <span class="comment">/* finalgather refl. depth */</span>
<a name="l01408"></a><a class="code" href="structmiOptions.html#o87">01408</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o87">fg_refraction_depth</a>;    <span class="comment">/* finalgather refr. depth */</span>
<a name="l01409"></a><a class="code" href="structmiOptions.html#o88">01409</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o88">fg_trace_depth</a>;         <span class="comment">/* total fg trace depth */</span>
<a name="l01410"></a><a class="code" href="structmiOptions.html#o89">01410</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o89">fg_falloff_start</a>;       <span class="comment">/* finalgather falloff start */</span>
<a name="l01411"></a><a class="code" href="structmiOptions.html#o90">01411</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o90">fg_falloff_stop</a>;        <span class="comment">/* finalgather falloff stop */</span>
<a name="l01412"></a><a class="code" href="structmiOptions.html#o91">01412</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiOptions.html#o91">userdata</a>;               <span class="comment">/* optional user data blocks */</span>
<a name="l01413"></a><a class="code" href="structmiOptions.html#o92">01413</a>         <a class="code" href="structmiApprox.html">miApprox</a>        <a class="code" href="structmiOptions.html#o92">approx</a>;                 <span class="comment">/* approximation overrides if*/</span>
<a name="l01414"></a><a class="code" href="structmiOptions.html#o93">01414</a>         <a class="code" href="structmiApprox.html">miApprox</a>        <a class="code" href="structmiOptions.html#o93">approx_displace</a>;        <span class="comment">/* style != APPROX_STYLE_NONE*/</span>
<a name="l01415"></a><a class="code" href="structmiOptions.html#o94">01415</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o94">finalgather</a>;            <span class="comment">/* 0:off,1:on,'f':fastlookup*/</span>
<a name="l01416"></a><a class="code" href="structmiOptions.html#o95">01416</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o95">finalgather_rays</a>;       <span class="comment">/* no. rays in final gather */</span>
<a name="l01417"></a><a class="code" href="structmiOptions.html#o96">01417</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o96">finalgather_maxradius</a>;  <span class="comment">/* maxdist for finalgather */</span>
<a name="l01418"></a><a class="code" href="structmiOptions.html#o97">01418</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o97">finalgather_minradius</a>;  <span class="comment">/* mindist for finalgather */</span>
<a name="l01419"></a><a class="code" href="structmiOptions.html#o98">01419</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o98">diag_photon_density</a>;    <span class="comment">/* density for diag */</span>
<a name="l01420"></a><a class="code" href="structmiOptions.html#o99">01420</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o99">diag_grid_size</a>;         <span class="comment">/* gridsize for diag */</span>
<a name="l01421"></a><a class="code" href="structmiOptions.html#o100">01421</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o100">desaturate</a>;             <span class="comment">/* for IMG: fade to white? */</span>
<a name="l01422"></a><a class="code" href="structmiOptions.html#o101">01422</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o101">dither</a>;                 <span class="comment">/* for IMG: LSB dithering? */</span>
<a name="l01423"></a><a class="code" href="structmiOptions.html#o102">01423</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiOptions.html#o102">nopremult</a>;              <span class="comment">/* for IMG: A &lt; RGB ok? */</span>
<a name="l01424"></a><a class="code" href="structmiOptions.html#o103">01424</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o103">colorclip</a>;              <span class="comment">/* for IMG: miIMG_COLORCLIP* */</span>
<a name="l01425"></a><a class="code" href="structmiOptions.html#o104">01425</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o104">gamma</a>;                  <span class="comment">/* for IMG: gamma, default 1 */</span>
<a name="l01426"></a><a class="code" href="structmiOptions.html#o105">01426</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiOptions.html#o105">inh_funcdecl</a>;           <span class="comment">/* inheritance function */</span>
<a name="l01427"></a><a class="code" href="structmiOptions.html#o106">01427</a>         <a class="code" href="structmiColor.html">miColor</a>         <a class="code" href="structmiOptions.html#o106">luminance_weight</a>;       <span class="comment">/* weights to calc intensity */</span>
<a name="l01428"></a><a class="code" href="structmiOptions.html#o107">01428</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o107">split_obj_no_triangs</a>;   <span class="comment">/* max no_triangs for split of</span>
01429 <span class="comment">                                                 * miOBJECT_POLYGONS */</span>
<a name="l01430"></a><a class="code" href="structmiOptions.html#o108">01430</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiOptions.html#o108">split_obj_no_faces</a>;     <span class="comment">/* max no_faces for split of</span>
01431 <span class="comment">                                                 * miOBJECT_FACES */</span>
<a name="l01432"></a><a class="code" href="structmiOptions.html#o109">01432</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiOptions.html#o109">inh_is_traversal</a>;       <span class="comment">/* inh_funcdecl is a traver- */</span>
01433                                                 <span class="comment">/* sal, not inheritance, shd */</span>
<a name="l01434"></a><a class="code" href="structmiOptions.html#o110">01434</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o110">hardware</a>;               <span class="comment">/* hw rendering: on|off|all*/</span>
<a name="l01435"></a><a class="code" href="structmiOptions.html#o111">01435</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o111">hardware_diagnostic</a>;    <span class="comment">/* flags for diagn. mode */</span>
<a name="l01436"></a><a class="code" href="structmiOptions.html#o112">01436</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiOptions.html#o112">shadowmap_flags</a>;        <span class="comment">/* flag for shadowmaps */</span>
<a name="l01437"></a><a class="code" href="structmiOptions.html#o113">01437</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiOptions.html#o113">maxdisplace</a>;            <span class="comment">/* override if !=0: default 0*/</span>
01438 } <a class="code" href="structmiOptions.html">miOptions</a>;
<a name="l01439"></a><a class="code" href="structmiCamera.html">01439</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiCamera.html">miCamera</a> {
<a name="l01440"></a><a class="code" href="structmiCamera.html#o0">01440</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiCamera.html#o0">orthographic</a>;           <span class="comment">/* orthographic rendering? */</span>
<a name="l01441"></a><a class="code" href="structmiCamera.html#o1">01441</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiCamera.html#o1">focal</a>;                  <span class="comment">/* focal length */</span>
<a name="l01442"></a><a class="code" href="structmiCamera.html#o2">01442</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiCamera.html#o2">aperture</a>;               <span class="comment">/* aperture */</span>
<a name="l01443"></a><a class="code" href="structmiCamera.html#o3">01443</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiCamera.html#o3">aspect</a>;                 <span class="comment">/* aspect ratio of the image */</span>
<a name="l01444"></a><a class="code" href="structmiCamera.html#o4">01444</a>         <a class="code" href="structmiRange.html">miRange</a>         <a class="code" href="structmiCamera.html#o4">clip</a>;                   <span class="comment">/* min/max clipping */</span>
<a name="l01445"></a><a class="code" href="structmiCamera.html#o5">01445</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiCamera.html#o5">x_resolution</a>;           <span class="comment">/* x resolution */</span>
<a name="l01446"></a><a class="code" href="structmiCamera.html#o6">01446</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiCamera.html#o6">y_resolution</a>;           <span class="comment">/* y resolution */</span>
<a name="l01447"></a><a class="code" href="structmiCamera.html#o8">01447</a>         <span class="keyword">struct </span>{<span class="keywordtype">int</span> <a class="code" href="structmiCamera.html#o7">xl</a>, <a class="code" href="structmiCamera.html#o8">yl</a>, <a class="code" href="structmiCamera.html#o9">xh</a>, <a class="code" href="structmiCamera.html#o10">yh</a>;}
01448                         window;                 <span class="comment">/* corners of subwindow */</span>
<a name="l01449"></a><a class="code" href="structmiCamera.html#o12">01449</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiCamera.html#o12">volume</a>;                 <span class="comment">/* opt. volume shader */</span>
<a name="l01450"></a><a class="code" href="structmiCamera.html#o13">01450</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiCamera.html#o13">environment</a>;            <span class="comment">/* opt. environment shader */</span>
<a name="l01451"></a><a class="code" href="structmiCamera.html#o14">01451</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiCamera.html#o14">lens</a>;                   <span class="comment">/* opt. lens shader */</span>
<a name="l01452"></a><a class="code" href="structmiCamera.html#o15">01452</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiCamera.html#o15">output</a>;                 <span class="comment">/* opt. output shaders/files */</span>
<a name="l01453"></a><a class="code" href="structmiCamera.html#o16">01453</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiCamera.html#o16">frame</a>;                  <span class="comment">/* current frame number */</span>
<a name="l01454"></a><a class="code" href="structmiCamera.html#o17">01454</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiCamera.html#o17">frame_time</a>;             <span class="comment">/* ... as time in seconds */</span>
<a name="l01455"></a><a class="code" href="structmiCamera.html#o18">01455</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiCamera.html#o18">frame_field</a>;            <span class="comment">/* 0=frame, 1/2=field number */</span>
<a name="l01456"></a><a class="code" href="structmiCamera.html#o19">01456</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiCamera.html#o19">x_offset</a>;               <span class="comment">/* x image offset in pixels */</span>
<a name="l01457"></a><a class="code" href="structmiCamera.html#o20">01457</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiCamera.html#o20">y_offset</a>;               <span class="comment">/* y image offset in pixels */</span>
<a name="l01458"></a><a class="code" href="structmiCamera.html#o21">01458</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiCamera.html#o21">userdata</a>;               <span class="comment">/* optional user data blocks */</span>
<a name="l01459"></a><a class="code" href="structmiCamera.html#o22">01459</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiCamera.html#o22">pass</a>;                   <span class="comment">/* opt. pass function chain */</span>
<a name="l01460"></a><a class="code" href="structmiCamera.html#o23">01460</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiCamera.html#o23">spare</a>[14];              <span class="comment">/* not used */</span>
01461 } <a class="code" href="structmiCamera.html">miCamera</a>;
<a name="l01462"></a><a class="code" href="shader_8h.html#a887">01462</a> <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a887">miLight_type</a> {
01463         <a class="code" href="shader_8h.html#a887a567">miLIGHT_ORIGIN</a>,
01464         <a class="code" href="shader_8h.html#a887a568">miLIGHT_DIRECTION</a>,
01465         <a class="code" href="shader_8h.html#a887a569">miLIGHT_SPOT</a>
01466 };
01467 
<a name="l01468"></a><a class="code" href="shader_8h.html#a888">01468</a> <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a888">miLight_area</a> {
01469         <a class="code" href="shader_8h.html#a888a570">miLIGHT_NONE</a> = 0,
01470         <a class="code" href="shader_8h.html#a888a571">miLIGHT_RECTANGLE</a>,
01471         <a class="code" href="shader_8h.html#a888a572">miLIGHT_DISC</a>,
01472         <a class="code" href="shader_8h.html#a888a573">miLIGHT_SPHERE</a>,
01473         <a class="code" href="shader_8h.html#a888a574">miLIGHT_CYLINDER</a>,
01474         <a class="code" href="shader_8h.html#a888a575">miLIGHT_OBJECT</a>,
01475         <a class="code" href="shader_8h.html#a888a576">miLIGHT_USER</a>
01476 };
<a name="l01477"></a><a class="code" href="shader_8h.html#a889">01477</a> <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a889">miFunction_type</a> {
01478         <a class="code" href="shader_8h.html#a889a577">miFUNCTION_C</a>,                           <span class="comment">/* regular C/C++ shader */</span>
01479         <a class="code" href="shader_8h.html#a889a578">miFUNCTION_PHEN</a>,                        <span class="comment">/* phenomenon interface */</span>
01480         <a class="code" href="shader_8h.html#a889a579">miFUNCTION_C_REQ</a>,                       <span class="comment">/* C/C++ shader with reqmnts */</span>
01481         <a class="code" href="shader_8h.html#a889a580">miFUNCTION_OUTFILE</a>,                     <span class="comment">/* write an image to a file */</span>
01482         <a class="code" href="shader_8h.html#a889a581">miFUNCTION_DATA</a>,                        <span class="comment">/* user data decl, no miFunc */</span>
01483         <a class="code" href="shader_8h.html#a889a582">miFUNCTION_PASS_SAVE</a>,                   <span class="comment">/* write pass file */</span>
01484         <a class="code" href="shader_8h.html#a889a583">miFUNCTION_PASS_PREP</a>,                   <span class="comment">/* pass file preprocessor */</span>
01485         <a class="code" href="shader_8h.html#a889a584">miFUNCTION_PASS_MERGE</a>,                  <span class="comment">/* pass file merge function */</span>
01486         <a class="code" href="shader_8h.html#a889a585">miFUNCTION_PASS_DELETE</a>,                 <span class="comment">/* pass file delete */</span>
01487         <a class="code" href="shader_8h.html#a889a586">miFUNCTION_HARDWARE</a>                     <span class="comment">/* hardware rendering shader */</span>
01488 };
01489 
<a name="l01490"></a><a class="code" href="structmiFunction.html">01490</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiFunction.html">miFunction</a> {
<a name="l01491"></a><a class="code" href="structmiFunction.html#o0">01491</a>         <a class="code" href="unionmiPointer.html">miPointer</a>       <a class="code" href="structmiFunction.html#o0">sparep1</a>[7];
<a name="l01492"></a><a class="code" href="structmiFunction.html#o1">01492</a>         <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a889">miFunction_type</a> <a class="code" href="structmiFunction.html#o1">type</a>;              <span class="comment">/* C/C++, phenomenon, or file*/</span>
<a name="l01493"></a><a class="code" href="structmiFunction.html#o2">01493</a>         <a class="code" href="shader_8h.html#a135">miUint</a>          <a class="code" href="structmiFunction.html#o2">out_typemap</a>;            <span class="comment">/* if output, IMG_TYPE bitmap*/</span>
<a name="l01494"></a><a class="code" href="structmiFunction.html#o3">01494</a>         <a class="code" href="shader_8h.html#a135">miUint</a>          <a class="code" href="structmiFunction.html#o3">out_interpmap</a>;          <span class="comment">/* if output, interpolate bm */</span>
<a name="l01495"></a><a class="code" href="structmiFunction.html#o4">01495</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiFunction.html#o4">function_decl</a>;          <span class="comment">/* declaration if C or PHEN */</span>
<a name="l01496"></a><a class="code" href="structmiFunction.html#o5">01496</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiFunction.html#o5">next_function</a>;          <span class="comment">/* next function call in list*/</span>
<a name="l01497"></a><a class="code" href="structmiFunction.html#o6">01497</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiFunction.html#o6">parameter_indirect</a>;     <span class="comment">/* get params from this func */</span>
<a name="l01498"></a><a class="code" href="structmiFunction.html#o7">01498</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiFunction.html#o7">interfacephen</a>;          <span class="comment">/* parent phen, if any */</span>
<a name="l01499"></a><a class="code" href="structmiFunction.html#o8">01499</a>         <a class="code" href="shader_8h.html#a875">miBoolean</a>       <a class="code" href="structmiFunction.html#o8">spare0</a>;                 <span class="comment">/* not used */</span>
<a name="l01500"></a><a class="code" href="structmiFunction.html#o9">01500</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiFunction.html#o9">parameter_size</a>;         <span class="comment">/* size of parameter block */</span>
<a name="l01501"></a><a class="code" href="structmiFunction.html#o10">01501</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiFunction.html#o10">result_size</a>;            <span class="comment">/* size of result struct */</span>
<a name="l01502"></a><a class="code" href="structmiFunction.html#o11">01502</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiFunction.html#o11">ghost_offs</a>;             <span class="comment">/* offset to tag ghost, or 0 */</span>
<a name="l01503"></a><a class="code" href="structmiFunction.html#o12">01503</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiFunction.html#o12">pass_read</a>;              <span class="comment">/* pass: infile, infile list */</span>
<a name="l01504"></a><a class="code" href="structmiFunction.html#o13">01504</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiFunction.html#o13">pass_write</a>;             <span class="comment">/* pass: outfile or 0 */</span>
<a name="l01505"></a><a class="code" href="structmiFunction.html#o14">01505</a>         <a class="code" href="shader_8h.html#a129">miSint1</a>         <a class="code" href="structmiFunction.html#o14">pass_maxsamples</a>;        <span class="comment">/* pass: max samples or ~0 */</span>
<a name="l01506"></a><a class="code" href="structmiFunction.html#o15">01506</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiFunction.html#o15">spare2</a>[3];              <span class="comment">/* not used */</span>
<a name="l01507"></a><a class="code" href="structmiFunction.html#o16">01507</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiFunction.html#o16">no_expl_params</a>;         <span class="comment">/* candidate for indirect par*/</span>
<a name="l01508"></a><a class="code" href="structmiFunction.html#o17">01508</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiFunction.html#o17">cloned</a>;                 <span class="comment">/* is this a clone */</span>
<a name="l01509"></a><a class="code" href="structmiFunction.html#o18">01509</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiFunction.html#o18">spare3</a>[5];              <span class="comment">/* not used */</span>
<a name="l01510"></a><a class="code" href="structmiFunction.html#o19">01510</a>         <a class="code" href="shader_8h.html#a136">miUchar</a>         <a class="code" href="structmiFunction.html#o19">label</a>;                  <span class="comment">/* sequential # for bitmasks */</span>
<a name="l01511"></a><a class="code" href="structmiFunction.html#o20">01511</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiFunction.html#o20">parameters</a>[8];          <span class="comment">/* parameter block, then */</span>
01512                                                 <span class="comment">/* miTag ghost for phenomena */</span>
01513 } <a class="code" href="structmiFunction.html">miFunction</a>;
<a name="l01514"></a><a class="code" href="structmiUserdata.html">01514</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiUserdata.html">miUserdata</a> {
<a name="l01515"></a><a class="code" href="structmiUserdata.html#o0">01515</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiUserdata.html#o0">data_decl</a>;              <span class="comment">/* parameter declaration */</span>
<a name="l01516"></a><a class="code" href="structmiUserdata.html#o1">01516</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiUserdata.html#o1">next_data</a>;              <span class="comment">/* next data block in list */</span>
<a name="l01517"></a><a class="code" href="structmiUserdata.html#o2">01517</a>         <a class="code" href="shader_8h.html#a135">miUint</a>          <a class="code" href="structmiUserdata.html#o2">label</a>;                  <span class="comment">/* data label */</span>
<a name="l01518"></a><a class="code" href="structmiUserdata.html#o3">01518</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiUserdata.html#o3">parameter_size</a>;         <span class="comment">/* size of parameter block */</span>
<a name="l01519"></a><a class="code" href="structmiUserdata.html#o4">01519</a>         <span class="keywordtype">short</span>           <a class="code" href="structmiUserdata.html#o4">one</a>;                    <span class="comment">/* ==1, for byte order check */</span>
<a name="l01520"></a><a class="code" href="structmiUserdata.html#o5">01520</a>         <span class="keywordtype">short</span>           <a class="code" href="structmiUserdata.html#o5">spare1</a>;                 <span class="comment">/* not used */</span>
<a name="l01521"></a><a class="code" href="structmiUserdata.html#o6">01521</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiUserdata.html#o6">spare2</a>;                 <span class="comment">/* not used */</span>
<a name="l01522"></a><a class="code" href="structmiUserdata.html#o7">01522</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiUserdata.html#o7">parameters</a>[8];          <span class="comment">/* parameter block */</span>
01523 } <a class="code" href="structmiUserdata.html">miUserdata</a>;
01524 
01525 <span class="comment">/*------------ mi_shader.h ------------*/</span>
01526 
01527 <span class="comment">/*</span>
01528 <span class="comment"> * Enumeration of all types of rays to be traced</span>
01529 <span class="comment"> * DO NOT renumber the flags, or precompiled shaders may stop working!</span>
01530 <span class="comment"> * volume shaders can find out from state-&gt;type whether this ray came</span>
01531 <span class="comment"> * from an object or from a light source. Note that in 3.0, mi_trace_probe</span>
01532 <span class="comment"> * used miRAY_NONE and hence ignored non-trace objects. Changed in 3.1.2.</span>
01533 <span class="comment"> */</span>
01534 
<a name="l01535"></a><a class="code" href="shader_8h.html#a890">01535</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a162">miRay_type</a> {
01536         <a class="code" href="shader_8h.html#a890a587">miRAY_EYE</a>,                      <span class="comment">/* eye ray */</span>
01537         <a class="code" href="shader_8h.html#a890a588">miRAY_TRANSPARENT</a>,              <span class="comment">/* transparency ray */</span>
01538         <a class="code" href="shader_8h.html#a890a589">miRAY_REFLECT</a>,                  <span class="comment">/* reflection ray */</span>
01539         <a class="code" href="shader_8h.html#a890a590">miRAY_REFRACT</a>,                  <span class="comment">/* refraction ray */</span>
01540         <a class="code" href="shader_8h.html#a890a591">miRAY_LIGHT</a>,                    <span class="comment">/* light ray */</span>
01541         <a class="code" href="shader_8h.html#a890a592">miRAY_SHADOW</a>,                   <span class="comment">/* shadow ray */</span>
01542         <a class="code" href="shader_8h.html#a890a593">miRAY_ENVIRONMENT</a>,              <span class="comment">/* ray only into environment/volume */</span>
01543         <a class="code" href="shader_8h.html#a890a594">miRAY_NONE</a>,                     <span class="comment">/* other ray */</span>
01544         <a class="code" href="shader_8h.html#a890a595">miPHOTON_ABSORB</a>,                <span class="comment">/* photon is absorbed (RIP) */</span>
01545         <a class="code" href="shader_8h.html#a890a596">miPHOTON_LIGHT</a>,                 <span class="comment">/* photon emitted from a light source*/</span>
01546         <a class="code" href="shader_8h.html#a890a597">miPHOTON_REFLECT_SPECULAR</a>,      <span class="comment">/* specular reflection of a photon */</span>
01547         <a class="code" href="shader_8h.html#a890a598">miPHOTON_REFLECT_GLOSSY</a>,        <span class="comment">/* glossy reflection of a photon */</span>
01548         <a class="code" href="shader_8h.html#a890a599">miPHOTON_REFLECT_DIFFUSE</a>,       <span class="comment">/* diffuse reflection of a photon */</span>
01549         <a class="code" href="shader_8h.html#a890a600">miPHOTON_TRANSMIT_SPECULAR</a>,     <span class="comment">/* specular transmission of a photon */</span>
01550         <a class="code" href="shader_8h.html#a890a601">miPHOTON_TRANSMIT_GLOSSY</a>,       <span class="comment">/* glossy transmission of a photon */</span>
01551         <a class="code" href="shader_8h.html#a890a602">miPHOTON_TRANSMIT_DIFFUSE</a>,      <span class="comment">/* diffuse transmission of a photon */</span>
01552         <a class="code" href="shader_8h.html#a890a603">miRAY_DISPLACE</a>,                 <span class="comment">/* displacement during tesselation */</span>
01553         <a class="code" href="shader_8h.html#a890a604">miRAY_OUTPUT</a>,                   <span class="comment">/* output shader */</span>
01554         <a class="code" href="shader_8h.html#a890a605">miPHOTON_SCATTER_VOLUME</a>,        <span class="comment">/* volume scattering of a photon */</span>
01555         <a class="code" href="shader_8h.html#a890a606">miPHOTON_TRANSPARENT</a>,           <span class="comment">/* transparency photon */</span>
01556         <a class="code" href="shader_8h.html#a890a607">miRAY_FINALGATHER</a>,              <span class="comment">/* final gather ray */</span>
01557         <a class="code" href="shader_8h.html#a890a608">miRAY_LM_VERTEX</a>,                <span class="comment">/* light map vertex rendering */</span>
01558         <a class="code" href="shader_8h.html#a890a609">miRAY_LM_MESH</a>,                  <span class="comment">/* light map mesh rendering */</span>
01559         <a class="code" href="shader_8h.html#a890a610">miPHOTON_EMIT_GLOBILLUM</a>,        <span class="comment">/* globillum photons (emitters only) */</span>
01560         <a class="code" href="shader_8h.html#a890a611">miPHOTON_EMIT_CAUSTIC</a>,          <span class="comment">/* caustic photons (emitters only) */</span>
01561         <a class="code" href="shader_8h.html#a890a612">miRAY_PROBE</a>,                    <span class="comment">/* mi_trace_probe, ignores vis/trace */</span>
01562         <a class="code" href="shader_8h.html#a890a613">miRAPID_TESSTRIS</a>,               <span class="comment">/* triangles after approximation */</span>
01563         <a class="code" href="shader_8h.html#a890a614">miRAPID_CANDS</a>,                  <span class="comment">/* shading candidates */</span>
01564         <a class="code" href="shader_8h.html#a890a615">miRAPID_SHADING</a>,                <span class="comment">/* shading samples */</span>
01565         <a class="code" href="shader_8h.html#a890a616">miRAPID_COLLECT</a>,                <span class="comment">/* collect samples */</span>
01566         <a class="code" href="shader_8h.html#a890a617">miRAY_NO_TYPES</a>
01567 } <a class="code" href="shader_8h.html#a162">miRay_type</a>;
01568 
01569 <span class="comment">/*</span>
01570 <span class="comment"> * Determine if a ray given by miRay_type is an eye or first generation</span>
01571 <span class="comment"> * transparency ray (primary), or a reflection or refraction (secondary) ray.</span>
01572 <span class="comment"> */</span>
01573 
<a name="l01574"></a><a class="code" href="shader_8h.html#a108">01574</a> <span class="preprocessor">#define miRAY_PRIMARY(r)        ((r) == miRAY_EYE)</span>
<a name="l01575"></a><a class="code" href="shader_8h.html#a109">01575</a> <span class="preprocessor"></span><span class="preprocessor">#define miRAY_SECONDARY(r)      ((r) &gt;  miRAY_EYE &amp;&amp;\</span>
01576 <span class="preprocessor">                                 (r) &lt;  miPHOTON_ABSORB ||\</span>
01577 <span class="preprocessor">                                 (r) == miRAY_FINALGATHER)</span>
01578 <span class="preprocessor"></span>
01579 <span class="comment">/*</span>
01580 <span class="comment"> * Determine if ray is a photon</span>
01581 <span class="comment"> */</span>
01582 
<a name="l01583"></a><a class="code" href="shader_8h.html#a110">01583</a> <span class="preprocessor">#define miRAY_PHOTON(r)         (((r) &gt;= miPHOTON_ABSORB &amp;&amp;\</span>
01584 <span class="preprocessor">                                 (r) &lt;= miPHOTON_TRANSMIT_DIFFUSE) ||\</span>
01585 <span class="preprocessor">                                 ((r) &gt;= miPHOTON_SCATTER_VOLUME &amp;&amp;\</span>
01586 <span class="preprocessor">                                  (r) &lt;= miPHOTON_TRANSPARENT) ||\</span>
01587 <span class="preprocessor">                                  (r) &gt;= miPHOTON_EMIT_GLOBILLUM &amp;&amp;\</span>
01588 <span class="preprocessor">                                  (r) &lt;= miPHOTON_EMIT_CAUSTIC)</span>
01589 <span class="preprocessor"></span>
<a name="l01590"></a><a class="code" href="shader_8h.html#a111">01590</a> <span class="preprocessor">#define MAX_TEX         64      </span><span class="comment">/* max. number of texture spaces */</span>
<a name="l01591"></a><a class="code" href="shader_8h.html#a112">01591</a> <span class="preprocessor">#define NO_DERIVS       5       </span><span class="comment">/* number of surface derivatives */</span>
01592 
01593 <span class="comment">/*</span>
01594 <span class="comment"> * Virtual frame buffers numbers.  Used exclusively by pass filters.</span>
01595 <span class="comment"> * to access sample information that is not written to files.</span>
01596 <span class="comment"> */</span>
01597 
<a name="l01598"></a><a class="code" href="shader_8h.html#a113">01598</a> <span class="preprocessor">#define miVFB_FIRST             16</span>
<a name="l01599"></a><a class="code" href="shader_8h.html#a114">01599</a> <span class="preprocessor"></span><span class="preprocessor">#define miVFB_SAMPLE_TIME       16      </span><span class="comment">/* time when sample was shot */</span>
<a name="l01600"></a><a class="code" href="shader_8h.html#a115">01600</a> <span class="preprocessor">#define miVFB_SAMPLE_LIMITS     17      </span><span class="comment">/* per object sample limits */</span>
<a name="l01601"></a><a class="code" href="shader_8h.html#a116">01601</a> <span class="preprocessor">#define miVFB_TOTAL             18</span>
01602 <span class="preprocessor"></span>
01603 <span class="comment">/*</span>
01604 <span class="comment"> * Types of shaders</span>
01605 <span class="comment"> */</span>
01606 
<a name="l01607"></a><a class="code" href="shader_8h.html#a891">01607</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
01608         <a class="code" href="shader_8h.html#a891a618">miSHADER_LENS</a>,          <span class="comment">/* lens shader */</span>
01609         <a class="code" href="shader_8h.html#a891a619">miSHADER_MATERIAL</a>,      <span class="comment">/* material shader */</span>
01610         <a class="code" href="shader_8h.html#a891a620">miSHADER_LIGHT</a>,         <span class="comment">/* light shader */</span>
01611         <a class="code" href="shader_8h.html#a891a621">miSHADER_SHADOW</a>,        <span class="comment">/* shadow shader */</span>
01612         <a class="code" href="shader_8h.html#a891a622">miSHADER_ENVIRONMENT</a>,   <span class="comment">/* environment shader */</span>
01613         <a class="code" href="shader_8h.html#a891a623">miSHADER_VOLUME</a>,        <span class="comment">/* volume shader */</span>
01614         <a class="code" href="shader_8h.html#a891a624">miSHADER_TEXTURE</a>,       <span class="comment">/* texture shader */</span>
01615         <a class="code" href="shader_8h.html#a891a625">miSHADER_PHOTON</a>,        <span class="comment">/* forward shader */</span>
01616         <a class="code" href="shader_8h.html#a891a626">miSHADER_GEOMETRY</a>,      <span class="comment">/* geometry shader */</span>
01617         <a class="code" href="shader_8h.html#a891a627">miSHADER_DISPLACE</a>,      <span class="comment">/* displacement shader */</span>
01618         <a class="code" href="shader_8h.html#a891a628">miSHADER_PHOTON_EMITTER</a>,<span class="comment">/* photon emitter */</span>
01619         <a class="code" href="shader_8h.html#a891a629">miSHADER_OUTPUT</a>,        <span class="comment">/* output shader */</span>
01620         <a class="code" href="shader_8h.html#a891a630">miSHADER_OTHER</a>,         <span class="comment">/* shader not known by RC */</span>
01621         <a class="code" href="shader_8h.html#a891a631">miSHADER_LIGHTMAP</a>,      <span class="comment">/* lightmap shader */</span>
01622         <a class="code" href="shader_8h.html#a891a632">miSHADER_PHOTONVOL</a>,     <span class="comment">/* photon volume shader */</span>
01623         <a class="code" href="shader_8h.html#a891a633">miSHADER_NO_TYPES</a>
01624 } <a class="code" href="shader_8h.html#a891">miShader_type</a>;
01625 
01626 <span class="comment">/*</span>
01627 <span class="comment"> * State structure</span>
01628 <span class="comment"> */</span>
01629 
<a name="l01630"></a><a class="code" href="shader_8h.html#a117">01630</a> <span class="preprocessor">#define MI_STATE_VERSION 2</span>
01631 <span class="preprocessor"></span>
<a name="l01632"></a><a class="code" href="structmiState.html">01632</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiState.html">miState</a> {
01633                                         <span class="comment">/* global */</span>
<a name="l01634"></a><a class="code" href="structmiState.html#o0">01634</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiState.html#o0">version</a>;                <span class="comment">/* version of state struct,</span>
01635 <span class="comment">                                                 * and shader interface</span>
01636 <span class="comment">                                                 * currently 2 */</span>
<a name="l01637"></a><a class="code" href="structmiState.html#o1">01637</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiState.html#o1">camera_inst</a>;            <span class="comment">/* camera instance */</span>
<a name="l01638"></a><a class="code" href="structmiState.html#o2">01638</a>         <span class="keyword">struct </span><a class="code" href="structmiCamera.html">miCamera</a> *<a class="code" href="structmiState.html#o2">camera</a>;                <span class="comment">/* camera */</span>
<a name="l01639"></a><a class="code" href="structmiState.html#o3">01639</a>         <span class="keyword">struct </span><a class="code" href="structmiOptions.html">miOptions</a> *<a class="code" href="structmiState.html#o3">options</a>;              <span class="comment">/* options */</span>
<a name="l01640"></a><a class="code" href="structmiState.html#o4">01640</a>         <a class="code" href="unionmiLock.html">miLock</a>          <a class="code" href="structmiState.html#o4">global_lock</a>;            <span class="comment">/* global lock for shaders */</span>
<a name="l01641"></a><a class="code" href="structmiState.html#o5">01641</a>         <a class="code" href="shader_8h.html#a135">miUint</a>          <a class="code" href="structmiState.html#o5">qmc_instance</a>;           <span class="comment">/* instance of low discrepacny</span>
01642 <span class="comment">                                                 * vector associated to current</span>
01643 <span class="comment">                                                 * ray tree */</span>
01644 <span class="preprocessor">#ifdef BIT64</span>
01645 <span class="preprocessor"></span>        <a class="code" href="shader_8h.html#a135">miUint</a>          pad;
01646 <span class="preprocessor">#endif</span>
<a name="l01647"></a><a class="code" href="structmiState.html#o6">01647</a> <span class="preprocessor"></span>        <span class="keyword">struct </span>miTs     *<a class="code" href="structmiState.html#o6">ts</a>;                    <span class="comment">/* thread local storage (ts) */</span>
01648                                                 <span class="comment">/* (internal) */</span>
<a name="l01649"></a><a class="code" href="structmiState.html#o7">01649</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiState.html#o7">raster_x</a>;               <span class="comment">/* x in raster space */</span>
<a name="l01650"></a><a class="code" href="structmiState.html#o8">01650</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiState.html#o8">raster_y</a>;               <span class="comment">/* y in raster space */</span>
01651                                         <span class="comment">/* ray */</span>
<a name="l01652"></a><a class="code" href="structmiState.html#o9">01652</a>         <span class="keyword">struct </span><a class="code" href="structmiState.html">miState</a>  *<a class="code" href="structmiState.html#o9">parent</a>;                <span class="comment">/* state of parent ray</span>
01653 <span class="comment">                                                 * first eye ray/lens shader:</span>
01654 <span class="comment">                                                 *   NULL</span>
01655 <span class="comment">                                                 * subsequent eye rays/lens</span>
01656 <span class="comment">                                                 * shaders: previous one</span>
01657 <span class="comment">                                                 * reflection, refraction,</span>
01658 <span class="comment">                                                 * dissolve rays: parent ray</span>
01659 <span class="comment">                                                 * light rays: parent ray</span>
01660 <span class="comment">                                                 * shadow rays: light ray */</span>
<a name="l01661"></a><a class="code" href="structmiState.html#o10">01661</a>         <a class="code" href="shader_8h.html#a162">miRay_type</a>      <a class="code" href="structmiState.html#o10">type</a>;                   <span class="comment">/* type of the ray */</span>
<a name="l01662"></a><a class="code" href="structmiState.html#o11">01662</a>         <a class="code" href="shader_8h.html#a136">miUchar</a>         <a class="code" href="structmiState.html#o11">qmc_component</a>;          <span class="comment">/* next component of current</span>
01663 <span class="comment">                                                 * instance of low discrepancy</span>
01664 <span class="comment">                                                 * vector to be used */</span>
<a name="l01665"></a><a class="code" href="structmiState.html#o12">01665</a>         <a class="code" href="shader_8h.html#a130">miUint1</a>         <a class="code" href="structmiState.html#o12">scanline</a>;               <span class="comment">/* intersect ray by scanline?*/</span>
<a name="l01666"></a><a class="code" href="structmiState.html#o13">01666</a>         <a class="code" href="shader_8h.html#a127">miCBoolean</a>      <a class="code" href="structmiState.html#o13">inv_normal</a>;             <span class="comment">/* normals are inverted because</span>
01667 <span class="comment">                                                 * ray hit the back side */</span>
<a name="l01668"></a><a class="code" href="structmiState.html#o14">01668</a>         <span class="keywordtype">char</span>            <a class="code" href="structmiState.html#o14">face</a>;                   <span class="comment">/* f)ront, b)ack, a)ll, from</span>
01669 <span class="comment">                                                 * state-&gt;options for subrays*/</span>
<a name="l01670"></a><a class="code" href="structmiState.html#o15">01670</a>         <span class="keywordtype">void</span>            *<a class="code" href="structmiState.html#o15">spare0</a>;                <span class="comment">/* unused */</span>
<a name="l01671"></a><a class="code" href="structmiState.html#o16">01671</a>         <span class="keywordtype">void</span>            *<a class="code" href="structmiState.html#o16">cache</a>;                 <span class="comment">/* cache holding shadow rays</span>
01672 <span class="comment">                                                 * it's a shadow cache</span>
01673 <span class="comment">                                                 * internal to RC */</span>
<a name="l01674"></a><a class="code" href="structmiState.html#o17">01674</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiState.html#o17">reflection_level</a>;       <span class="comment">/* reflection depth of the ray</span>
01675 <span class="comment">                                                 * SHOULD BE SHORT</span>
01676 <span class="comment">                                                 */</span>
<a name="l01677"></a><a class="code" href="structmiState.html#o18">01677</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiState.html#o18">refraction_level</a>;       <span class="comment">/* refraction depth of the ray</span>
01678 <span class="comment">                                                 * SHOULD BE SHORT</span>
01679 <span class="comment">                                                 */</span>
<a name="l01680"></a><a class="code" href="structmiState.html#o19">01680</a>         <a class="code" href="structmiVector.html">miVector</a>        <a class="code" href="structmiState.html#o19">org</a>;                    <span class="comment">/* ray origin</span>
01681 <span class="comment">                                                 * for light, shadow rays the</span>
01682 <span class="comment">                                                 * light position */</span>
<a name="l01683"></a><a class="code" href="structmiState.html#o20">01683</a>         <a class="code" href="structmiVector.html">miVector</a>        <a class="code" href="structmiState.html#o20">dir</a>;                    <span class="comment">/* ray direction</span>
01684 <span class="comment">                                                 * for light, shadow ray</span>
01685 <span class="comment">                                                 * it points</span>
01686 <span class="comment">                                                 * towards the intersection */</span>
<a name="l01687"></a><a class="code" href="structmiState.html#o21">01687</a>         <span class="keywordtype">double</span>          <a class="code" href="structmiState.html#o21">dist</a>;                   <span class="comment">/* length of the ray */</span>
<a name="l01688"></a><a class="code" href="structmiState.html#o22">01688</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiState.html#o22">time</a>;                   <span class="comment">/* time of the ray */</span>
<a name="l01689"></a><a class="code" href="structmiState.html#o23">01689</a>         <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="structmiState.html#o23">ior</a>;                    <span class="comment">/* ior of outgoing ray */</span>
<a name="l01690"></a><a class="code" href="structmiState.html#o24">01690</a>         <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="structmiState.html#o24">ior_in</a>;                 <span class="comment">/* ior of incoming ray */</span>
<a name="l01691"></a><a class="code" href="structmiState.html#o25">01691</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiState.html#o25">material</a>;               <span class="comment">/* material of the primitive.</span>
01692 <span class="comment">                                                 * Set to miNULL_TAG if no hit.</span>
01693 <span class="comment">                                                 */</span>
<a name="l01694"></a><a class="code" href="structmiState.html#o26">01694</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiState.html#o26">volume</a>;                 <span class="comment">/* volume shader to be applied</span>
01695 <span class="comment">                                                 */</span>
<a name="l01696"></a><a class="code" href="structmiState.html#o27">01696</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiState.html#o27">environment</a>;            <span class="comment">/* environment shader to be</span>
01697 <span class="comment">                                                 * applied if no hit */</span>
01698                                         <span class="comment">/* intersection point */</span>
<a name="l01699"></a><a class="code" href="structmiState.html#o28">01699</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiState.html#o28">refraction_volume</a>;      <span class="comment">/* volume shader to apply</span>
01700 <span class="comment">                                                 * to refraction ray */</span>
<a name="l01701"></a><a class="code" href="structmiState.html#o29">01701</a>         <a class="code" href="shader_8h.html#a135">miUint</a>          <a class="code" href="structmiState.html#o29">label</a>;                  <span class="comment">/* label of hit object */</span>
<a name="l01702"></a><a class="code" href="structmiState.html#o30">01702</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiState.html#o30">instance</a>;               <span class="comment">/* hit object instance */</span>
<a name="l01703"></a><a class="code" href="structmiState.html#o31">01703</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiState.html#o31">light_instance</a>;         <span class="comment">/* light instance */</span>
01704 
<a name="l01705"></a><a class="code" href="structmiState.html#o32">01705</a>         <span class="keywordtype">void</span>            *<a class="code" href="structmiState.html#o32">pri</a>;                   <span class="comment">/* box_info of hit box, shaders</span>
01706 <span class="comment">                                                 * can check if  pri== NULL</span>
01707 <span class="comment">                                                 */</span>
<a name="l01708"></a><a class="code" href="structmiState.html#o33">01708</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiState.html#o33">pri_idx</a>;                <span class="comment">/* index of hit primitive</span>
01709 <span class="comment">                                                 * in box */</span>
<a name="l01710"></a><a class="code" href="structmiState.html#o34">01710</a>         <span class="keywordtype">float</span>           <a class="code" href="structmiState.html#o34">bary</a>[4];                <span class="comment">/* barycentric coordinates</span>
01711 <span class="comment">                                                 * of hit primitive</span>
01712 <span class="comment">                                                 * triangles: 0 - 2,</span>
01713 <span class="comment">                                                 * imp. patches: 0 - 3 */</span>
<a name="l01714"></a><a class="code" href="structmiState.html#o35">01714</a>         <a class="code" href="structmiVector.html">miVector</a>        <a class="code" href="structmiState.html#o35">point</a>;                  <span class="comment">/* point of intersection */</span>
<a name="l01715"></a><a class="code" href="structmiState.html#o36">01715</a>         <a class="code" href="structmiVector.html">miVector</a>        <a class="code" href="structmiState.html#o36">normal</a>;                 <span class="comment">/* interpolated normal</span>
01716 <span class="comment">                                                 * pointing to the side of the</span>
01717 <span class="comment">                                                 * ray */</span>
<a name="l01718"></a><a class="code" href="structmiState.html#o37">01718</a>         <a class="code" href="structmiVector.html">miVector</a>        <a class="code" href="structmiState.html#o37">normal_geom</a>;            <span class="comment">/* geometric normal of pri.</span>
01719 <span class="comment">                                                 * pointing to the side of the</span>
01720 <span class="comment">                                                 * ray */</span>
<a name="l01721"></a><a class="code" href="structmiState.html#o38">01721</a>         <a class="code" href="shader_8h.html#a141">miScalar</a>        <a class="code" href="structmiState.html#o38">dot_nd</a>;                 <span class="comment">/* dot of normal, dir</span>
01722 <span class="comment">                                                 * for light rays,</span>
01723 <span class="comment">                                                 * it's the dot_nd of the</span>
01724 <span class="comment">                                                 * parent (intersection) normal</span>
01725 <span class="comment">                                                 * and the light ray dir */</span>
<a name="l01726"></a><a class="code" href="structmiState.html#o39">01726</a>         <span class="keywordtype">double</span>          <a class="code" href="structmiState.html#o39">shadow_tol</a>;             <span class="comment">/* the minimum distance to a</span>
01727 <span class="comment">                                                 * plane perpendicular to the</span>
01728 <span class="comment">                                                 * shading normal for which the</span>
01729 <span class="comment">                                                 * triangle is completely on</span>
01730 <span class="comment">                                                 * the negative side.  */</span>
<a name="l01731"></a><a class="code" href="structmiState.html#o40">01731</a>         <a class="code" href="structmiVector.html">miVector</a>        *<a class="code" href="structmiState.html#o40">tex_list</a>;              <span class="comment">/* list of texture coordinates</span>
01732 <span class="comment">                                                 */</span>
<a name="l01733"></a><a class="code" href="structmiState.html#o41">01733</a>         <a class="code" href="structmiVector.html">miVector</a>        *<a class="code" href="structmiState.html#o41">bump_x_list</a>;           <span class="comment">/* list of bump map basis x</span>
01734 <span class="comment">                                                 * (perturbation) vectors */</span>
<a name="l01735"></a><a class="code" href="structmiState.html#o42">01735</a>         <a class="code" href="structmiVector.html">miVector</a>        *<a class="code" href="structmiState.html#o42">bump_y_list</a>;           <span class="comment">/* list of bump map basis y</span>
01736 <span class="comment">                                                 * (perturbation) vectors */</span>
<a name="l01737"></a><a class="code" href="structmiState.html#o43">01737</a>         <a class="code" href="structmiVector.html">miVector</a>        <a class="code" href="structmiState.html#o43">motion</a>;                 <span class="comment">/* motion vector or (0,0,0) */</span>
<a name="l01738"></a><a class="code" href="structmiState.html#o44">01738</a>         <a class="code" href="structmiVector.html">miVector</a>        *<a class="code" href="structmiState.html#o44">derivs</a>;                <span class="comment">/* list of surface derivative</span>
01739 <span class="comment">                                                 * vectors containing dx/du,</span>
01740 <span class="comment">                                                 * dx/dv, d^2x/du^2, d^2x/dv^2,</span>
01741 <span class="comment">                                                 * d^2x/dudv or (0,0,0) */</span>
01742                                         <span class="comment">/* light shader, shadow shader */</span>
01743                                                 <span class="comment">/* instance is the</span>
01744 <span class="comment">                                                 * light instance, see above */</span>
01745                                         <span class="comment">/* texture shader */</span>
<a name="l01746"></a><a class="code" href="structmiState.html#o45">01746</a>         <a class="code" href="structmiVector.html">miVector</a>        <a class="code" href="structmiState.html#o45">tex</a>;                    <span class="comment">/* texture coordinates for</span>
01747 <span class="comment">                                                 * lookup */</span>
01748                                         <span class="comment">/* shader */</span>
<a name="l01749"></a><a class="code" href="structmiState.html#o46">01749</a>         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structmiFunction.html">miFunction</a> *<a class="code" href="structmiState.html#o46">shader</a>;        <span class="comment">/* current shader */</span>
01750                                         <span class="comment">/* other */</span>
<a name="l01751"></a><a class="code" href="structmiState.html#o47">01751</a>         <span class="keyword">struct </span><a class="code" href="structmiState.html">miState</a>  *<a class="code" href="structmiState.html#o47">child</a>;                 <span class="comment">/* child state */</span>
<a name="l01752"></a><a class="code" href="structmiState.html#o48">01752</a>         <span class="keywordtype">short</span>           <a class="code" href="structmiState.html#o48">thread</a>;                 <span class="comment">/* current thread number */</span>
<a name="l01753"></a><a class="code" href="structmiState.html#o49">01753</a>         <a class="code" href="shader_8h.html#a137">miUshort</a>        <a class="code" href="structmiState.html#o49">count</a>;                  <span class="comment">/* area light sample counter */</span>
01754                                         <span class="comment">/* user */</span>
<a name="l01755"></a><a class="code" href="structmiState.html#o50">01755</a>         <span class="keywordtype">void</span>            *<a class="code" href="structmiState.html#o50">user</a>;                  <span class="comment">/* user data */</span>
<a name="l01756"></a><a class="code" href="structmiState.html#o51">01756</a>         <span class="keywordtype">int</span>             <a class="code" href="structmiState.html#o51">user_size</a>;              <span class="comment">/* size of user data */</span>
01757 } <a class="code" href="structmiState.html">miState</a>;
01758 
01759 <span class="comment">/*</span>
01760 <span class="comment"> * state structure passed to old-style output shaders. It is used for</span>
01761 <span class="comment"> * output shaders whose declaration does not specify a version number.</span>
01762 <span class="comment"> * Do not use this. Output shaders with nonzero version numbers get</span>
01763 <span class="comment"> * a miState, not a miOutstate, and work with versioning and init/exit.</span>
01764 <span class="comment"> */</span>
01765 
<a name="l01766"></a><a class="code" href="shader_8h.html#a118">01766</a> <span class="preprocessor">#define MI_OUTSTATE_VERSION 2</span>
01767 <span class="preprocessor"></span>
<a name="l01768"></a><a class="code" href="structmiOutstate.html">01768</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{                                <span class="comment">/* state for output shaders */</span>
<a name="l01769"></a><a class="code" href="structmiOutstate.html#o0">01769</a>         <span class="keywordtype">int</span>             version;                <span class="comment">/* version of miOutstate */</span>
<a name="l01770"></a><a class="code" href="structmiOutstate.html#o1">01770</a>         <a class="code" href="shader_8h.html#a147">miTag</a>           camera_inst;            <span class="comment">/* camera instance */</span>
<a name="l01771"></a><a class="code" href="structmiOutstate.html#o2">01771</a>         <span class="keyword">struct </span><a class="code" href="structmiCamera.html">miCamera</a> *camera;                <span class="comment">/* camera */</span>
<a name="l01772"></a><a class="code" href="structmiOutstate.html#o3">01772</a>         <span class="keyword">struct </span><a class="code" href="structmiOptions.html">miOptions</a> *options;              <span class="comment">/* options */</span>
<a name="l01773"></a><a class="code" href="structmiOutstate.html#o5">01773</a>         <span class="keywordtype">int</span>             xres, yres;             <span class="comment">/* image resolution */</span>
<a name="l01774"></a><a class="code" href="structmiOutstate.html#o6">01774</a>         <a class="code" href="structmiImg__image.html">miImg_image</a>     *frame_rgba;            <span class="comment">/* RGBA color frame buffer */</span>
<a name="l01775"></a><a class="code" href="structmiOutstate.html#o7">01775</a>         <a class="code" href="structmiImg__image.html">miImg_image</a>     *frame_z;               <span class="comment">/* depth channel frame buffer*/</span>
<a name="l01776"></a><a class="code" href="structmiOutstate.html#o8">01776</a>         <a class="code" href="structmiImg__image.html">miImg_image</a>     *frame_n;               <span class="comment">/* normal vector frame buffer*/</span>
<a name="l01777"></a><a class="code" href="structmiOutstate.html#o9">01777</a>         <a class="code" href="structmiImg__image.html">miImg_image</a>     *frame_label;           <span class="comment">/* label channel frame buffer*/</span>
<a name="l01778"></a><a class="code" href="structmiOutstate.html#o10">01778</a>         <a class="code" href="shader_8h.html#a143">miMatrix</a>        camera_to_world;        <span class="comment">/* world transformation */</span>
<a name="l01779"></a><a class="code" href="structmiOutstate.html#o11">01779</a>         <a class="code" href="shader_8h.html#a143">miMatrix</a>        world_to_camera;        <span class="comment">/* inverse world transform */</span>
<a name="l01780"></a><a class="code" href="structmiOutstate.html#o12">01780</a>         <a class="code" href="structmiImg__image.html">miImg_image</a>     *frame_m;               <span class="comment">/* motion vector frame buffer*/</span>
01781 } <a class="code" href="structmiOutstate.html">miOutstate</a>;
01782 
01783 
01784 <span class="comment">/*</span>
01785 <span class="comment"> * shader type</span>
01786 <span class="comment"> */</span>
01787 
<a name="l01788"></a><a class="code" href="shader_8h.html#a164">01788</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a875">miBoolean</a> (*<a class="code" href="shader_8h.html#a164">miShader</a>)(
01789                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* result */</span>
01790                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
01791                 <span class="keywordtype">void</span>            *args);         <span class="comment">/* shader args */</span>
01792 
<a name="l01793"></a><a class="code" href="shader_8h.html#a165">01793</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a875">miBoolean</a> (*<a class="code" href="shader_8h.html#a165">miShaderx</a>)(
01794                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* result */</span>
01795                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
01796                 <span class="keywordtype">void</span>            *args,          <span class="comment">/* shader args */</span>
01797                 <span class="keywordtype">void</span>            *arg);          <span class="comment">/* arg from parent shader */</span>
01798 
<a name="l01799"></a><a class="code" href="shader_8h.html#a166">01799</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a875">miBoolean</a> (*<a class="code" href="shader_8h.html#a166">miShader_init</a>)(
01800                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
01801                 <span class="keywordtype">void</span>            *args,          <span class="comment">/* shader args or NULL */</span>
01802                 <a class="code" href="shader_8h.html#a875">miBoolean</a>       *init_req);     <span class="comment">/* instance inits too? */</span>
01803 
<a name="l01804"></a><a class="code" href="shader_8h.html#a167">01804</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a875">miBoolean</a> (*<a class="code" href="shader_8h.html#a167">miShader_exit</a>)(
01805                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
01806                 <span class="keywordtype">void</span>            *args);         <span class="comment">/* shader args or NULL */</span>
01807 
<a name="l01808"></a><a class="code" href="shader_8h.html#a168">01808</a> <span class="keyword">typedef</span> int (*<a class="code" href="shader_8h.html#a168">miShader_version</a>)(<span class="keywordtype">void</span>);
01809 
<a name="l01810"></a><a class="code" href="shader_8h.html#a169">01810</a> <span class="keyword">typedef</span> void (*<a class="code" href="shader_8h.html#a169">miContour_Store_Function</a>)(
01811                 <span class="keywordtype">void</span>            *info_void,
01812                 <span class="keywordtype">int</span>             *info_size,
01813                 <a class="code" href="structmiState.html">miState</a>         *state,
01814                 <a class="code" href="structmiColor.html">miColor</a>         *color);
01815 
<a name="l01816"></a><a class="code" href="shader_8h.html#a170">01816</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a875">miBoolean</a> (*<a class="code" href="shader_8h.html#a170">miContour_Contrast_Function</a>)(
01817                 <span class="keywordtype">void</span>            *info1,
01818                 <span class="keywordtype">void</span>            *info2,
01819                 <span class="keywordtype">int</span>             level,
01820                 <a class="code" href="structmiState.html">miState</a>         *state,
01821                 <span class="keywordtype">void</span>            *paras);
01822 
01823 <span class="keyword">struct </span><a class="code" href="structmiContour__endpoint.html">miContour_endpoint</a>;                      <span class="comment">/* typedef'd later */</span>
01824 
<a name="l01825"></a><a class="code" href="shader_8h.html#a171">01825</a> <span class="keyword">typedef</span> <a class="code" href="shader_8h.html#a875">miBoolean</a> (*<a class="code" href="shader_8h.html#a171">miContour_Shader</a>)(
01826                 <span class="keyword">struct </span><a class="code" href="structmiContour__endpoint.html">miContour_endpoint</a> *epoint,
01827                 <span class="keywordtype">void</span>            *info_near,
01828                 <span class="keywordtype">void</span>            *info_far,
01829                 <a class="code" href="structmiState.html">miState</a>         *state,
01830                 <span class="keywordtype">void</span>            *paras);
01831 
01832 
01833 <span class="comment">/* Typedefs for lightmapping shaders */</span>
<a name="l01834"></a><a class="code" href="structmiRclm__triangle.html">01834</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiRclm__triangle.html">miRclm_triangle</a> {
<a name="l01835"></a><a class="code" href="structmiRclm__triangle.html#o0">01835</a>                 <a class="code" href="shader_8h.html#a128">miInteger</a>       <a class="code" href="structmiRclm__triangle.html#o0">a</a>;
<a name="l01836"></a><a class="code" href="structmiRclm__triangle.html#o1">01836</a>                 <a class="code" href="shader_8h.html#a128">miInteger</a>       <a class="code" href="structmiRclm__triangle.html#o1">b</a>;
<a name="l01837"></a><a class="code" href="structmiRclm__triangle.html#o2">01837</a>                 <a class="code" href="shader_8h.html#a128">miInteger</a>       <a class="code" href="structmiRclm__triangle.html#o2">c</a>;
<a name="l01838"></a><a class="code" href="structmiRclm__triangle.html#o3">01838</a>                 <a class="code" href="shader_8h.html#a145">miGeoIndex</a>      <a class="code" href="structmiRclm__triangle.html#o3">pri_idx</a>;
01839 } <a class="code" href="structmiRclm__triangle.html">miRclm_triangle</a>;
01840 
<a name="l01841"></a><a class="code" href="structmiRclm__mesh__render.html">01841</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiRclm__mesh__render.html">miRclm_mesh_render</a> {
<a name="l01842"></a><a class="code" href="structmiRclm__mesh__render.html#o0">01842</a>                 <span class="keywordtype">void</span>                    *<a class="code" href="structmiRclm__mesh__render.html#o0">pri</a>;
<a name="l01843"></a><a class="code" href="structmiRclm__mesh__render.html#o1">01843</a>                 <span class="keywordtype">int</span>                     <a class="code" href="structmiRclm__mesh__render.html#o1">no_triangles</a>;
<a name="l01844"></a><a class="code" href="structmiRclm__mesh__render.html#o2">01844</a>                 <a class="code" href="structmiRclm__triangle.html">miRclm_triangle</a> <span class="keyword">const</span>   *<a class="code" href="structmiRclm__mesh__render.html#o2">triangles</a>;
<a name="l01845"></a><a class="code" href="structmiRclm__mesh__render.html#o3">01845</a>                 <span class="keywordtype">void</span> <span class="keyword">const</span>              *<a class="code" href="structmiRclm__mesh__render.html#o3">vertex_data</a>;
01846 } <a class="code" href="structmiRclm__mesh__render.html">miRclm_mesh_render</a>;
01847 
01848 
01849 <span class="comment">/*</span>
01850 <span class="comment"> * functions</span>
01851 <span class="comment"> */</span>
01852 
<a name="l01853"></a><a class="code" href="shader_8h.html#a119">01853</a> <span class="preprocessor">#define mi_eval( s, p ) (!(s)-&gt;shader-&gt;ghost_offs ? (void*)(p) : \</span>
01854 <span class="preprocessor">  (!*((miTag*)((char*)(p)+(s)-&gt;shader-&gt;ghost_offs)) ? (void*)(p) : \</span>
01855 <span class="preprocessor">  mi_phen_eval(s,(void*)(p))))</span>
01856 <span class="preprocessor"></span>
<a name="l01857"></a><a class="code" href="shader_8h.html#a120">01857</a> <span class="preprocessor">#define mi_eval_boolean(p)      ((miBoolean *)mi_eval(state, (void *)(p)))</span>
<a name="l01858"></a><a class="code" href="shader_8h.html#a121">01858</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_eval_integer(p)      ((miInteger *)mi_eval(state, (void *)(p)))</span>
<a name="l01859"></a><a class="code" href="shader_8h.html#a122">01859</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_eval_scalar(p)       ((miScalar  *)mi_eval(state, (void *)(p)))</span>
<a name="l01860"></a><a class="code" href="shader_8h.html#a123">01860</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_eval_vector(p)       ((miVector  *)mi_eval(state, (void *)(p)))</span>
<a name="l01861"></a><a class="code" href="shader_8h.html#a124">01861</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_eval_transform(p)    ((miScalar  *)mi_eval(state, (void *)(p)))</span>
<a name="l01862"></a><a class="code" href="shader_8h.html#a125">01862</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_eval_color(p)        ((miColor   *)mi_eval(state, (void *)(p)))</span>
<a name="l01863"></a><a class="code" href="shader_8h.html#a126">01863</a> <span class="preprocessor"></span><span class="preprocessor">#define mi_eval_tag(p)          ((miTag     *)mi_eval(state, (void *)(p)))</span>
01864 <span class="preprocessor"></span>
01865 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a761">mi_call_shader</a>(
01866                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* result */</span>
01867                 miShader_type   type,           <span class="comment">/* shader type */</span>
01868                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
01869                 miTag           shader);        <span class="comment">/* shader function instance */</span>
01870 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a762">mi_call_shader_x</a>(
01871                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* result */</span>
01872                 miShader_type   type,           <span class="comment">/* shader type */</span>
01873                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
01874                 miTag           shader,         <span class="comment">/* shader function instance */</span>
01875                 <span class="keywordtype">void</span>            *arg);          <span class="comment">/* pass to shader */</span>
01876 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a763">mi_flush_cache</a>(
01877                 <a class="code" href="structmiState.html">miState</a> *state );               <span class="comment">/* the famous state */</span>
01878 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a764">mi_call_material</a>(                     <span class="comment">/* for smart volume shaders */</span>
01879                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* material shader result */</span>
01880                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state with state-&gt;material*/</span>
01881 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a765">mi_call_photon_material</a>(              <span class="comment">/* for photon volume shaders */</span>
01882                 <a class="code" href="structmiColor.html">miColor</a>         *energy,        <span class="comment">/* energy (surprise!) */</span>
01883                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state with state-&gt;material*/</span>
01884 <span class="keywordtype">void</span> *<a class="code" href="shader_8h.html#a766">mi_phen_eval</a>(                             <span class="comment">/* evaluate a shader param */</span>
01885                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
01886                 <span class="keywordtype">void</span>            *parm );        <span class="comment">/* parameter */</span>
01887 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a767">mi_lookup_color_texture</a>(
01888                 <a class="code" href="structmiColor.html">miColor</a> * <span class="keyword">const</span> color,          <span class="comment">/* returned color */</span>
01889                 <a class="code" href="structmiState.html">miState</a> * <span class="keyword">const</span> state,
01890                 <span class="keyword">const</span> miTag     tex,            <span class="comment">/* texture to look up */</span>
01891                 <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span> coord);         <span class="comment">/* texture coordinate */</span>
01892 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a768">mi_lookup_scalar_texture</a>(
01893                 miScalar *<span class="keyword">const</span> scalar,         <span class="comment">/* returned scalar */</span>
01894                 <a class="code" href="structmiState.html">miState</a> * <span class="keyword">const</span> state,
01895                 <span class="keyword">const</span> miTag     tex,            <span class="comment">/* texture to look up */</span>
01896                 <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span> coord);         <span class="comment">/* texture coordinate */</span>
01897 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a769">mi_lookup_vector_texture</a>(
01898                 <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span> rvector,        <span class="comment">/* returned vector */</span>
01899                 <a class="code" href="structmiState.html">miState</a> * <span class="keyword">const</span> state,
01900                 <span class="keyword">const</span> miTag     tex,            <span class="comment">/* texture to look up */</span>
01901                 <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span> coord);         <span class="comment">/* texture coordinate */</span>
01902 
01903 
01904 <span class="comment">/*</span>
01905 <span class="comment"> * texture filtering</span>
01906 <span class="comment"> */</span>
01907 
<a name="l01908"></a><a class="code" href="structmiTexfilter.html">01908</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l01909"></a><a class="code" href="structmiTexfilter.html#o0">01909</a>                 <a class="code" href="shader_8h.html#a141">miScalar</a>        eccmax;         <span class="comment">/* max. eccentricity */</span>
<a name="l01910"></a><a class="code" href="structmiTexfilter.html#o1">01910</a>                 <a class="code" href="shader_8h.html#a141">miScalar</a>        max_minor;      <span class="comment">/* max. minor axis length */</span>
<a name="l01911"></a><a class="code" href="structmiTexfilter.html#o2">01911</a>                 <a class="code" href="shader_8h.html#a141">miScalar</a>        circle_radius;  <span class="comment">/* scale blurring */</span>
<a name="l01912"></a><a class="code" href="structmiTexfilter.html#o3">01912</a>                 <a class="code" href="shader_8h.html#a875">miBoolean</a>       bilinear;       <span class="comment">/* bilin. subpixel interp. */</span>
<a name="l01913"></a><a class="code" href="structmiTexfilter.html#o4">01913</a>                 <a class="code" href="shader_8h.html#a141">miScalar</a>        spare[10];      <span class="comment">/* not used */</span>
01914 } <a class="code" href="structmiTexfilter.html">miTexfilter</a>;
01915 
01916 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a770">mi_lookup_filter_color_texture</a>(
01917                 <a class="code" href="structmiColor.html">miColor</a> * <span class="keyword">const</span> color,          <span class="comment">/* returned color */</span>
01918                 <a class="code" href="structmiState.html">miState</a> * <span class="keyword">const</span> state,
01919                 <span class="keyword">const</span> miTag     tex,            <span class="comment">/* texture to look up */</span>
01920                 <span class="keyword">const</span> <a class="code" href="structmiTexfilter.html">miTexfilter</a> *paras,       <span class="comment">/* filter options */</span>
01921                 miMatrix        ST);            <span class="comment">/* pixel-&gt;texture transform */</span>
01922 
01923 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a771">mi_texture_filter_project</a>(
01924                 <a class="code" href="structmiVector.html">miVector</a>        p[3],           <span class="comment">/* pixel space points */</span>
01925                 <a class="code" href="structmiVector.html">miVector</a>        t[3],           <span class="comment">/* texture space points */</span>
01926                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>  state,
01927                 miScalar        disc_r,         <span class="comment">/* projection disc radius */</span>
01928                 miUint          space);         <span class="comment">/* texture space index */</span>
01929 
01930 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a772">mi_texture_filter_transform</a>(
01931                 miMatrix        ST,             <span class="comment">/* screen-&gt;texture transform */</span>
01932                 <a class="code" href="structmiVector.html">miVector</a>        p[3],           <span class="comment">/* pixel space points */</span>
01933                 <a class="code" href="structmiVector.html">miVector</a>        t[3]);          <span class="comment">/* texture space points */</span>
01934 
01935 <span class="comment">/* info functions */</span>
01936 <span class="keywordtype">void</span>      <a class="code" href="shader_8h.html#a773">mi_texture_info</a>(
01937                 <span class="keyword">const</span> miTag     tag,            <span class="comment">/* texture to inquire about */</span>
01938                 <span class="keywordtype">int</span> * <span class="keyword">const</span>     xresp,          <span class="comment">/* store width here */</span>
01939                 <span class="keywordtype">int</span> * <span class="keyword">const</span>     yresp,          <span class="comment">/* store height here */</span>
01940                 <span class="keywordtype">void</span> ** <span class="keyword">const</span>   paraspp);       <span class="comment">/* store ptr to tex paras */</span>
01941 <span class="keywordtype">void</span>      <a class="code" href="shader_8h.html#a774">mi_light_info</a>(
01942                 <span class="keyword">const</span> miTag     tag,            <span class="comment">/* light to inquire about */</span>
01943                 <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span> orgp,           <span class="comment">/* store origin here */</span>
01944                 <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span> dirp,           <span class="comment">/* store direction here */</span>
01945                 <span class="keywordtype">void</span> ** <span class="keyword">const</span>   paraspp);       <span class="comment">/* store ptr to light paras 0*/</span>
01946 <span class="keywordtype">int</span>       <a class="code" href="shader_8h.html#a775">mi_global_lights_info</a>(
01947                 miTag           **tag);         <span class="comment">/* array of light leaf insts */</span>
01948 <span class="keywordtype">void</span>    **<a class="code" href="shader_8h.html#a776">mi_shader_info</a>(
01949                 <a class="code" href="structmiState.html">miState</a> * <span class="keyword">const</span> state);         <span class="comment">/* state with shader */</span>
01950 <span class="keywordtype">int</span>       <a class="code" href="shader_8h.html#a777">mi_instance_info</a>(
01951                 <span class="keyword">const</span> miTag     inst_tag,       <span class="comment">/* instance tag */</span>
01952                 <span class="keywordtype">void</span> ** <span class="keyword">const</span>   paraspp,        <span class="comment">/* store ptr to inst paras */</span>
01953                 <span class="keywordtype">void</span> ** <span class="keyword">const</span>   spare1,         <span class="comment">/* not currently used */</span>
01954                 <span class="keywordtype">void</span> ** <span class="keyword">const</span>   spare2,         <span class="comment">/* not currently used */</span>
01955                 <span class="keywordtype">void</span> ** <span class="keyword">const</span>   spare3);        <span class="comment">/* not currently used */</span>
01956 
01957 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a778">mi_inclusive_lightlist</a>(
01958                 <span class="keywordtype">int</span>             *n_lights,      <span class="comment">/* number of lights */</span>
01959                 miTag           **lights,       <span class="comment">/* lightlist (array of tags) */</span>
01960                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
01961 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a779">mi_exclusive_lightlist</a>(
01962                 <span class="keywordtype">int</span>             *n_lights,      <span class="comment">/* number of lights */</span>
01963                 miTag           **lights,       <span class="comment">/* lightlist (array of tags) */</span>
01964                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
01965 
01966 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a780">mi_tri_vectors</a>(
01967                 <a class="code" href="structmiState.html">miState</a>         *state,
01968                 <span class="keywordtype">int</span>             which,          <span class="comment">/* point, normal, motion, tex*/</span>
01969                 <span class="keywordtype">int</span>             ntex,           <span class="comment">/* if which==t, which texture*/</span>
01970                 <a class="code" href="structmiVector.html">miVector</a>        **a,            <span class="comment">/* returned vectors */</span>
01971                 <a class="code" href="structmiVector.html">miVector</a>        **b,
01972                 <a class="code" href="structmiVector.html">miVector</a>        **c);
01973 
01974 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a781">mi_raster_unit</a>(
01975                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* shader state with camera */</span>
01976                 <a class="code" href="structmiVector.html">miVector</a>        *x,             <span class="comment">/* ret. X unit basis vector */</span>
01977                 <a class="code" href="structmiVector.html">miVector</a>        *y);            <span class="comment">/* ret. Y unit basis vector */</span>
01978 
01979 <span class="comment">/* autovolume functions */</span>
01980 <a class="code" href="shader_8h.html#a128">miInteger</a> <a class="code" href="shader_8h.html#a782">mi_volume_num_shaders</a>(
01981                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
01982 <a class="code" href="shader_8h.html#a128">miInteger</a> <a class="code" href="shader_8h.html#a783">mi_volume_cur_shader</a>(
01983                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
01984 <a class="code" href="structmiColor.html">miColor</a> *<a class="code" href="shader_8h.html#a784">mi_volume_user_color</a>(
01985                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
01986 <a class="code" href="shader_8h.html#a147">miTag</a> <span class="keyword">const</span> *<a class="code" href="shader_8h.html#a785">mi_volume_tags</a>(
01987                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
01988 <a class="code" href="shader_8h.html#a147">miTag</a> <span class="keyword">const</span> *<a class="code" href="shader_8h.html#a786">mi_volume_instances</a>(
01989                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
01990 
01991 <span class="comment">/* ray tracing functions */</span>
01992 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a787">mi_trace_eye</a>(
01993                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* result */</span>
01994                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
01995                 <a class="code" href="structmiVector.html">miVector</a>        *origin,        <span class="comment">/* ray origin */</span>
01996                 <a class="code" href="structmiVector.html">miVector</a>        *direction);    <span class="comment">/* ray direction */</span>
01997 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a788">mi_trace_transparent</a>(
01998                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* result */</span>
01999                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
02000 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a789">mi_trace_reflection</a>(
02001                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* result */</span>
02002                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02003                 <a class="code" href="structmiVector.html">miVector</a>        *direction);    <span class="comment">/* ray direction */</span>
02004 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a790">mi_trace_refraction</a>(
02005                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* result */</span>
02006                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02007                 <a class="code" href="structmiVector.html">miVector</a>        *direction);    <span class="comment">/* ray direction */</span>
02008 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a791">mi_trace_environment</a>(
02009                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* result */</span>
02010                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02011                 <a class="code" href="structmiVector.html">miVector</a>        *direction);    <span class="comment">/* direction */</span>
02012 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a792">mi_trace_probe</a>(
02013                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02014                 <a class="code" href="structmiVector.html">miVector</a> <span class="keyword">const</span>  *direction,     <span class="comment">/* direction */</span>
02015                 <a class="code" href="structmiVector.html">miVector</a> <span class="keyword">const</span>  *origin);       <span class="comment">/* origin */</span>
02016 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a793">mi_sample_light</a>(
02017                 <a class="code" href="structmiColor.html">miColor</a> * <span class="keyword">const</span> result,         <span class="comment">/* result */</span>
02018                 <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span> dir,            <span class="comment">/* opt. result direction */</span>
02019                 <span class="keywordtype">float</span>   * <span class="keyword">const</span> dot_nl,         <span class="comment">/* opt. result dot of N, L */</span>
02020                 <a class="code" href="structmiState.html">miState</a> * <span class="keyword">const</span> state,          <span class="comment">/* state */</span>
02021                 <span class="keyword">const</span> miTag     light_inst,     <span class="comment">/* light instance */</span>
02022                 <span class="keywordtype">int</span> * <span class="keyword">const</span>     samples);       <span class="comment">/* # samples */</span>
02023 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a794">mi_trace_light</a>(
02024                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* result */</span>
02025                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* opt. result direction */</span>
02026                 <span class="keywordtype">float</span>           *dot_nl,        <span class="comment">/* opt. result dot of N, L */</span>
02027                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02028                 miTag           light_inst);    <span class="comment">/* light instance */</span>
02029 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a795">mi_trace_shadow</a>(
02030                 <a class="code" href="structmiColor.html">miColor</a> * <span class="keyword">const</span> result,         <span class="comment">/* result */</span>
02031                 <a class="code" href="structmiState.html">miState</a> * <span class="keyword">const</span> state);         <span class="comment">/* state */</span>
02032 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a796">mi_trace_shadow_seg</a>(
02033                 <a class="code" href="structmiColor.html">miColor</a> * <span class="keyword">const</span> result,         <span class="comment">/* result */</span>
02034                 <a class="code" href="structmiState.html">miState</a> * <span class="keyword">const</span> state);         <span class="comment">/* state */</span>
02035 
02036 <span class="comment">/* set opacity color. mental ray will use the last value set. note</span>
02037 <span class="comment">   that if opacity is not set, alpha is assumed to hold the opacity. */</span>
02038 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a797">mi_opacity_set</a>(
02039                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* shader state */</span>
02040                 <a class="code" href="structmiColor.html">miColor</a> <span class="keyword">const</span> * <span class="keyword">const</span> opacity); <span class="comment">/* opacity to store */</span>
02041 
02042 <span class="comment">/* get opacity colour. return miBoolean is miTRUE</span>
02043 <span class="comment">   if it was previously set, otherwise miFALSE. */</span>
02044 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a798">mi_opacity_get</a>(
02045                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* shader state */</span>
02046                 <a class="code" href="structmiColor.html">miColor</a>         *opacity);      <span class="comment">/* where to store opacity */</span>
02047 
02048 <span class="comment">/* compute reflection / transmission directions */</span>
02049 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a799">mi_reflection_dir</a>(
02050                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* in direction */</span>
02051                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
02052 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a800">mi_refraction_dir</a>(
02053                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* in direction */</span>
02054                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02055                 miScalar        ior_in,         <span class="comment">/* in index of refraction */</span>
02056                 miScalar        ior_out);       <span class="comment">/* out index of refraction */</span>
02057 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a801">mi_reflection_dir_specular</a>(        <span class="comment">/* same as mi_reflection_dir */</span>
02058                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* in direction */</span>
02059                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
02060 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a802">mi_reflection_dir_glossy</a>(
02061                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* out direction */</span>
02062                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02063                 miScalar        shiny);         <span class="comment">/* shiny coefficient */</span>
02064 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a803">mi_reflection_dir_anisglossy</a>(
02065                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* out direction */</span>
02066                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02067                 <a class="code" href="structmiVector.html">miVector</a>        *u,             <span class="comment">/* u direction */</span>
02068                 <a class="code" href="structmiVector.html">miVector</a>        *v,             <span class="comment">/* v direction */</span>
02069                 miScalar        shiny_u,        <span class="comment">/* shiny coefficient in u dir*/</span>
02070                 miScalar        shiny_v);       <span class="comment">/* shiny coefficient in v dir*/</span>
02071 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a804">mi_reflection_dir_diffuse</a>(
02072                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* out direction */</span>
02073                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
02074 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a805">mi_transmission_dir_specular</a>( <span class="comment">/*same as mi_refraction_dir*/</span>
02075                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* in direction */</span>
02076                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02077                 miScalar        ior_in,         <span class="comment">/* in index of refraction */</span>
02078                 miScalar        ior_out);       <span class="comment">/* out index of refraction */</span>
02079 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a806">mi_transmission_dir_glossy</a>(
02080                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* out direction */</span>
02081                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02082                 miScalar        ior_in,         <span class="comment">/* in index of refraction */</span>
02083                 miScalar        ior_out,        <span class="comment">/* out index of refraction */</span>
02084                 miScalar        shiny);         <span class="comment">/* shiny coefficient */</span>
02085 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a807">mi_transmission_dir_anisglossy</a>(
02086                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* out direction */</span>
02087                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02088                 miScalar        ior_in,         <span class="comment">/* in index of refraction */</span>
02089                 miScalar        ior_out,        <span class="comment">/* out index of refraction */</span>
02090                 <a class="code" href="structmiVector.html">miVector</a>        *u,             <span class="comment">/* u direction */</span>
02091                 <a class="code" href="structmiVector.html">miVector</a>        *v,             <span class="comment">/* v direction */</span>
02092                 miScalar        shiny_u,        <span class="comment">/* shiny coefficient in u dir*/</span>
02093                 miScalar        shiny_v);       <span class="comment">/* shiny coefficient in v dir*/</span>
02094 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a808">mi_transmission_dir_diffuse</a>(
02095                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* out direction */</span>
02096                 <a class="code" href="structmiState.html">miState</a>         *state);        <span class="comment">/* state */</span>
02097 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a809">mi_scattering_dir_diffuse</a>(
02098                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* result: out direction */</span>
02099                 <a class="code" href="structmiState.html">miState</a>         *state);
02100 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a810">mi_scattering_dir_directional</a>(
02101                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* result: out direction */</span>
02102                 <a class="code" href="structmiState.html">miState</a>         *state,
02103                 miScalar        directionality);<span class="comment">/* -1: back ... 1: forward */</span>
02104 <a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="shader_8h.html#a811">mi_scattering_pathlength</a>(
02105                 <a class="code" href="structmiState.html">miState</a>         *state,
02106                 miScalar        k);
02107 
02108 <span class="comment">/* choose scatter type */</span>
02109 <a class="code" href="shader_8h.html#a162">miRay_type</a> <a class="code" href="shader_8h.html#a812">mi_choose_scatter_type</a>(
02110                 <a class="code" href="structmiState.html">miState</a>         *state,
02111                 miScalar        transp,         <span class="comment">/* refl = 1-transp */</span>
02112                 <a class="code" href="structmiColor.html">miColor</a>         *diffuse,
02113                 <a class="code" href="structmiColor.html">miColor</a>         *glossy,
02114                 <a class="code" href="structmiColor.html">miColor</a>         *specular);
02115 <a class="code" href="shader_8h.html#a162">miRay_type</a> <a class="code" href="shader_8h.html#a813">mi_choose_simple_scatter_type</a>(
02116                 <a class="code" href="structmiState.html">miState</a>         *state,
02117                 <a class="code" href="structmiColor.html">miColor</a>         *rdiffuse,
02118                 <a class="code" href="structmiColor.html">miColor</a>         *rspecular,
02119                 <a class="code" href="structmiColor.html">miColor</a>         *tdiffuse,
02120                 <a class="code" href="structmiColor.html">miColor</a>         *tspecular);
02121 <span class="keywordtype">int</span> <a class="code" href="shader_8h.html#a814">mi_choose_lobe</a>(
02122                 <a class="code" href="structmiState.html">miState</a>         *state,
02123                 miScalar        r);             <span class="comment">/* probability of first lobe */</span>
02124 
02125 <span class="comment">/* evalution of reflection models */</span>
02126 <a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="shader_8h.html#a815">mi_phong_specular</a>(
02127                 miScalar        spec_exp,       <span class="comment">/* specular exponent */</span>
02128                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02129                 <a class="code" href="structmiVector.html">miVector</a>        *dir);          <span class="comment">/* direction */</span>
02130 <a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="shader_8h.html#a816">mi_blong_specular</a>(
02131                 miScalar        spec_exp,       <span class="comment">/* specular exponent */</span>
02132                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02133                 <a class="code" href="structmiVector.html">miVector</a>        *dir);          <span class="comment">/* direction */</span>
02134 <a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="shader_8h.html#a817">mi_blinn_specular</a>(
02135                 <a class="code" href="structmiVector.html">miVector</a>        *di,            <span class="comment">/* incident direction */</span>
02136                 <a class="code" href="structmiVector.html">miVector</a>        *dr,            <span class="comment">/* direction of reflection */</span>
02137                 <a class="code" href="structmiVector.html">miVector</a>        *n,             <span class="comment">/* surface normal */</span>
02138                 miScalar        roughness,      <span class="comment">/* average microfacet slope */</span>
02139                 miScalar        ior);           <span class="comment">/* index of refraction */</span>
02140 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a818">mi_cooktorr_specular</a>(
02141                 <a class="code" href="structmiColor.html">miColor</a>         *result,        <span class="comment">/* resulting color */</span>
02142                 <a class="code" href="structmiVector.html">miVector</a>        *di,            <span class="comment">/* incident direction */</span>
02143                 <a class="code" href="structmiVector.html">miVector</a>        *dr,            <span class="comment">/* direction of reflection */</span>
02144                 <a class="code" href="structmiVector.html">miVector</a>        *n,             <span class="comment">/* surface normal */</span>
02145                 miScalar        roughness,      <span class="comment">/* average microfacet slope */</span>
02146                 <a class="code" href="structmiColor.html">miColor</a>         *ior);          <span class="comment">/* relative ior for 3 wavelgt*/</span>
02147 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a819">mi_fresnel_specular</a>(
02148                 miScalar        *ns,
02149                 miScalar        *ks,
02150                 miScalar        spec_exp,       <span class="comment">/* specular exponent */</span>
02151                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* state */</span>
02152                 <a class="code" href="structmiVector.html">miVector</a>        *dir,           <span class="comment">/* direction */</span>
02153                 miScalar        ior_in,         <span class="comment">/* in index of refraction */</span>
02154                 miScalar        ior_out);       <span class="comment">/* out index of refraction */</span>
02155 <a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="shader_8h.html#a820">mi_ward_glossy</a>(
02156                 <a class="code" href="structmiVector.html">miVector</a>        *di,            <span class="comment">/* incident direction */</span>
02157                 <a class="code" href="structmiVector.html">miVector</a>        *dr,            <span class="comment">/* direction of reflection */</span>
02158                 <a class="code" href="structmiVector.html">miVector</a>        *n,             <span class="comment">/* normal */</span>
02159                 miScalar        shiny);         <span class="comment">/* glossyness */</span>
02160 <a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="shader_8h.html#a821">mi_ward_anisglossy</a>(
02161                 <a class="code" href="structmiVector.html">miVector</a>        *di,            <span class="comment">/* incident direction */</span>
02162                 <a class="code" href="structmiVector.html">miVector</a>        *dr,            <span class="comment">/* direction of reflection */</span>
02163                 <a class="code" href="structmiVector.html">miVector</a>        *n,             <span class="comment">/* normal */</span>
02164                 <a class="code" href="structmiVector.html">miVector</a>        *u,             <span class="comment">/* u direction */</span>
02165                 <a class="code" href="structmiVector.html">miVector</a>        *v,             <span class="comment">/* v direction */</span>
02166                 miScalar        shiny_u,        <span class="comment">/* glossyness in u direction */</span>
02167                 miScalar        shiny_v);       <span class="comment">/* glossyness in u direction */</span>
02168 <a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="shader_8h.html#a822">mi_fresnel</a>(
02169                 miScalar        n1,
02170                 miScalar        n2,
02171                 miScalar        t1,
02172                 miScalar        t2);
02173 <a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="shader_8h.html#a823">mi_fresnel_reflection</a>(
02174                 <a class="code" href="structmiState.html">miState</a>         *state,
02175                 miScalar        ior_in,
02176                 miScalar        ior_out);
02177 <a class="code" href="shader_8h.html#a141">miScalar</a> <a class="code" href="shader_8h.html#a824">mi_schlick_scatter</a>(
02178                 <a class="code" href="structmiVector.html">miVector</a>        *di,            <span class="comment">/* incident direction */</span>
02179                 <a class="code" href="structmiVector.html">miVector</a>        *dr,            <span class="comment">/* direction of reflection */</span>
02180                 miScalar        directionality);<span class="comment">/* -1:back, 0:isot., 1:forw. */</span>
02181 
02182 <span class="comment">/* photon tracing */</span>
02183 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a825">mi_photon_reflection_specular</a>(
02184                 <a class="code" href="structmiColor.html">miColor</a>         *energy,        <span class="comment">/* energy carried by photon */</span>
02185                 <a class="code" href="structmiState.html">miState</a>         *state,
02186                 <a class="code" href="structmiVector.html">miVector</a>        *dir);
02187 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a826">mi_photon_reflection_glossy</a>(
02188                 <a class="code" href="structmiColor.html">miColor</a>         *energy,        <span class="comment">/* energy carried by photon */</span>
02189                 <a class="code" href="structmiState.html">miState</a>         *state,
02190                 <a class="code" href="structmiVector.html">miVector</a>        *dir);
02191 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a827">mi_photon_reflection_diffuse</a>(
02192                 <a class="code" href="structmiColor.html">miColor</a>         *energy,        <span class="comment">/* energy carried by photon */</span>
02193                 <a class="code" href="structmiState.html">miState</a>         *state,
02194                 <a class="code" href="structmiVector.html">miVector</a>        *dir);
02195 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a828">mi_photon_transmission_specular</a>(
02196                 <a class="code" href="structmiColor.html">miColor</a>         *energy,        <span class="comment">/* energy carried by photon */</span>
02197                 <a class="code" href="structmiState.html">miState</a>         *state,
02198                 <a class="code" href="structmiVector.html">miVector</a>        *dir);
02199 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a829">mi_photon_transmission_glossy</a>(
02200                 <a class="code" href="structmiColor.html">miColor</a>         *energy,        <span class="comment">/* energy carried by photon */</span>
02201                 <a class="code" href="structmiState.html">miState</a>         *state,
02202                 <a class="code" href="structmiVector.html">miVector</a>        *dir);
02203 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a830">mi_photon_transmission_diffuse</a>(
02204                 <a class="code" href="structmiColor.html">miColor</a>         *energy,        <span class="comment">/* energy carried by photon */</span>
02205                 <a class="code" href="structmiState.html">miState</a>         *state,
02206                 <a class="code" href="structmiVector.html">miVector</a>        *dir);
02207 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a831">mi_photon_transparent</a>(
02208                 <a class="code" href="structmiColor.html">miColor</a>         *energy,        <span class="comment">/* photon flux */</span>
02209                 <a class="code" href="structmiState.html">miState</a>         *parent);
02210 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a832">mi_photon_light</a>(
02211                 <a class="code" href="structmiColor.html">miColor</a>         *energy,
02212                 <a class="code" href="structmiState.html">miState</a>         *state );
02213 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a833">mi_photon_volume_scattering</a>(
02214                 <a class="code" href="structmiColor.html">miColor</a>         *energy,        <span class="comment">/* energy carried by photon */</span>
02215                 <a class="code" href="structmiState.html">miState</a>         *state,
02216                 <a class="code" href="structmiVector.html">miVector</a>        *dir);
02217 
02218 <span class="comment">/*</span>
02219 <span class="comment"> * user frame buffer access</span>
02220 <span class="comment"> */</span>
02221 
02222 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a834">mi_fb_put</a>(
02223                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* current shader state */</span>
02224                 <span class="keywordtype">int</span>             fb,             <span class="comment">/* frame buffer number, 0..7 */</span>
02225                 <span class="keywordtype">void</span>            *data);         <span class="comment">/* sample data to store */</span>
02226 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a835">mi_fb_get</a>(
02227                 <a class="code" href="structmiState.html">miState</a>         *state,         <span class="comment">/* current shader state */</span>
02228                 <span class="keywordtype">int</span>             fb,             <span class="comment">/* frame buffer number, 0..7 */</span>
02229                 <span class="keywordtype">void</span>            *data);         <span class="comment">/* sample data to store */</span>
02230 
02231 <span class="comment">/*</span>
02232 <span class="comment"> * contour output shader interface</span>
02233 <span class="comment"> */</span>
02234 
<a name="l02235"></a><a class="code" href="structmiContour__endpoint.html">02235</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmiContour__endpoint.html">miContour_endpoint</a> {
<a name="l02236"></a><a class="code" href="structmiContour__endpoint.html#o0">02236</a>                 <a class="code" href="structmiVector.html">miVector</a>        <a class="code" href="structmiContour__endpoint.html#o0">point</a>;          <span class="comment">/* x, y in screen coords, */</span>
02237                                                 <span class="comment">/* z in camera coordinates */</span>
<a name="l02238"></a><a class="code" href="structmiContour__endpoint.html#o1">02238</a>                 <a class="code" href="structmiColor.html">miColor</a>         <a class="code" href="structmiContour__endpoint.html#o1">color</a>;
<a name="l02239"></a><a class="code" href="structmiContour__endpoint.html#o2">02239</a>                 <span class="keywordtype">float</span>           <a class="code" href="structmiContour__endpoint.html#o2">width</a>;
<a name="l02240"></a><a class="code" href="structmiContour__endpoint.html#o3">02240</a>                 <a class="code" href="structmiVector.html">miVector</a>        <a class="code" href="structmiContour__endpoint.html#o3">motion</a>;
<a name="l02241"></a><a class="code" href="structmiContour__endpoint.html#o4">02241</a>                 <a class="code" href="structmiVector.html">miVector</a>        <a class="code" href="structmiContour__endpoint.html#o4">normal</a>;
<a name="l02242"></a><a class="code" href="structmiContour__endpoint.html#o5">02242</a>                 <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="structmiContour__endpoint.html#o5">material</a>;
<a name="l02243"></a><a class="code" href="structmiContour__endpoint.html#o6">02243</a>                 <span class="keywordtype">int</span>             <a class="code" href="structmiContour__endpoint.html#o6">label</a>;
02244 } <a class="code" href="structmiContour__endpoint.html">miContour_endpoint</a>;
02245 
02246 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a836">mi_get_contour_line</a>(
02247                 <a class="code" href="structmiContour__endpoint.html">miContour_endpoint</a> *p1,
02248                 <a class="code" href="structmiContour__endpoint.html">miContour_endpoint</a> *p2);
02249 
02250 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a837">mi_add_contour_lines</a>(
02251                 <a class="code" href="structmiContour__endpoint.html">miContour_endpoint</a> p1[],        <span class="comment">/* list of first endpoints */</span>
02252                 <a class="code" href="structmiContour__endpoint.html">miContour_endpoint</a> p2[],        <span class="comment">/* list of second endpoints */</span>
02253                 <span class="keywordtype">int</span>             n);             <span class="comment">/* number of contour lines */</span>
02254 
02255 
02256 <span class="comment">/*</span>
02257 <span class="comment"> * parallel safe random number generator</span>
02258 <span class="comment"> */</span>
02259 
02260 <span class="keywordtype">double</span> <a class="code" href="shader_8h.html#a838">mi_par_random</a>(
02261                 <a class="code" href="structmiState.html">miState</a>         *state);
02262 
02263 <span class="comment">/*</span>
02264 <span class="comment"> * more functions, defined by LIB. They are here because they need miState.</span>
02265 <span class="comment"> * All take the state, a result vector pointer, and an input vector pointer.</span>
02266 <span class="comment"> */</span>
02267 
02268 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a839">mi_point_to_world</a>(
02269                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02270 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a840">mi_point_to_camera</a>(
02271                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02272 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a841">mi_point_to_object</a>(
02273                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02274 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a842">mi_point_to_raster</a>(
02275                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02276 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a843">mi_point_to_light</a>(
02277                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02278 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a844">mi_point_from_world</a>(
02279                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02280 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a845">mi_point_from_camera</a>(
02281                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02282 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a846">mi_point_from_object</a>(
02283                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02284 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a847">mi_point_from_light</a>(
02285                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02286 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a848">mi_vector_to_world</a>(
02287                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02288 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a849">mi_vector_to_camera</a>(
02289                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02290 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a850">mi_vector_to_object</a>(
02291                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02292 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a851">mi_vector_to_light</a>(
02293                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02294 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a852">mi_vector_from_world</a>(
02295                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02296 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a853">mi_vector_from_camera</a>(
02297                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02298 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a854">mi_vector_from_object</a>(
02299                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02300 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a855">mi_vector_from_light</a>(
02301                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02302 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a856">mi_normal_to_world</a>(
02303                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02304 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a857">mi_normal_to_camera</a>(
02305                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02306 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a858">mi_normal_to_object</a>(
02307                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02308 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a859">mi_normal_to_light</a>(
02309                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02310 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a860">mi_normal_from_world</a>(
02311                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02312 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a861">mi_normal_from_camera</a>(
02313                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02314 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a862">mi_normal_from_object</a>(
02315                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02316 <span class="keywordtype">void</span> <a class="code" href="shader_8h.html#a863">mi_normal_from_light</a>(
02317                 <a class="code" href="structmiState.html">miState</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>, <a class="code" href="structmiVector.html">miVector</a> *<span class="keyword">const</span>);
02318 
02319 <span class="comment">/*</span>
02320 <span class="comment"> * geometry shaders</span>
02321 <span class="comment"> */</span>
02322 
02323 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a864">mi_geoshader_add_result</a>(
02324                 miTag           *result,        <span class="comment">/* shader result */</span>
02325                 <span class="keyword">const</span> miTag     item);          <span class="comment">/* scene item to add */</span>
02326 
<a name="l02327"></a><a class="code" href="structmiIntersect.html">02327</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{                                <span class="comment">/* intersection description */</span>
<a name="l02328"></a><a class="code" href="structmiIntersect.html#o0">02328</a>                 <span class="keywordtype">double</span>          dist;           <span class="comment">/* distance along ray */</span>
<a name="l02329"></a><a class="code" href="structmiIntersect.html#o1">02329</a>                 <a class="code" href="structmiVector.html">miVector</a>        point;          <span class="comment">/* point in render space */</span>
<a name="l02330"></a><a class="code" href="structmiIntersect.html#o2">02330</a>                 <a class="code" href="structmiVector.html">miVector</a>        normal_geom;    <span class="comment">/* geometric normal */</span>
<a name="l02331"></a><a class="code" href="structmiIntersect.html#o3">02331</a>                 <span class="keywordtype">float</span>           bary[4];        <span class="comment">/* barycentric coord. 0..2 */</span>
<a name="l02332"></a><a class="code" href="structmiIntersect.html#o4">02332</a>                 <span class="keywordtype">void</span>            *pri;           <span class="comment">/* internal primitive */</span>
<a name="l02333"></a><a class="code" href="structmiIntersect.html#o5">02333</a>                 <span class="keywordtype">int</span>             pri_idx;        <span class="comment">/* primitive index */</span>
<a name="l02334"></a><a class="code" href="structmiIntersect.html#o6">02334</a>                 <a class="code" href="shader_8h.html#a147">miTag</a>           instance;       <span class="comment">/* hit instance */</span>
02335 } <a class="code" href="structmiIntersect.html">miIntersect</a>;
02336 
02337 
02338 <span class="comment">/*------------ mi_rcgi.h ------------*/</span>
02339 
02340 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a865">mi_store_volume_photon</a>(
02341   <a class="code" href="structmiColor.html">miColor</a>* energy, 
02342   <a class="code" href="structmiState.html">miState</a>* state);
02343 
02344 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a866">mi_store_photon</a>(
02345   <a class="code" href="structmiColor.html">miColor</a>* energy, 
02346   <a class="code" href="structmiState.html">miState</a>* state);
02347 
02348 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a867">mi_compute_irradiance</a>(
02349   <a class="code" href="structmiColor.html">miColor</a>* result, 
02350   <a class="code" href="structmiState.html">miState</a>* state);
02351 
02352 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a868">mi_compute_irradiance_backside</a>(
02353   <a class="code" href="structmiColor.html">miColor</a>* result, 
02354   <a class="code" href="structmiState.html">miState</a>* state);
02355 
02356 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a869">mi_compute_directional_irradiance</a>(
02357   <a class="code" href="structmiColor.html">miColor</a>* result, 
02358   <a class="code" href="structmiState.html">miState</a>* state,
02359   <span class="keyword">const</span> miScalar r,
02360   <span class="keyword">const</span> miScalar g1,
02361   <span class="keyword">const</span> miScalar g2);
02362 
02363 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a870">mi_compute_volume_irradiance</a>(
02364   <a class="code" href="structmiColor.html">miColor</a>* result, 
02365   <a class="code" href="structmiState.html">miState</a>* state);
02366 
02367 <span class="comment">/*------------ mi_rcfg.h ------------*/</span>
02368 
<a name="l02369"></a><a class="code" href="shader_8h.html#a892">02369</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="shader_8h.html#a175">miFinalgather_store_mode</a> {
02370   <a class="code" href="shader_8h.html#a892a634">miFG_STORE_COMPUTE</a>            = 1,    <span class="comment">/* compute FG point */</span>
02371   <a class="code" href="shader_8h.html#a892a635">miFG_STORE_SET</a>                = 2     <span class="comment">/* set FG to given value */</span>
02372 } <a class="code" href="shader_8h.html#a175">miFinalgather_store_mode</a>;
02373 
02374 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a871">mi_finalgather_store</a>(
02375   <a class="code" href="structmiColor.html">miColor</a>       *result,
02376   <a class="code" href="structmiState.html">miState</a>       *state,
02377   <span class="keywordtype">int</span>           mode);
02378 
02379 <span class="comment">/*------------ mi_phen.h ------------*/</span>
02380 
02381 <a class="code" href="shader_8h.html#a147">miTag</a>           <a class="code" href="shader_8h.html#a872">mi_phen_clone</a>                   (<span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a> *, miTag);
02382 <span class="keywordtype">void</span>            <a class="code" href="shader_8h.html#a873">mi_phen_unclone</a>                 (miTag);
02383 
02384 <span class="comment">/*------------ mi_smethod.h ------------*/</span>
02385 
02386 <a class="code" href="shader_8h.html#a875">miBoolean</a> <a class="code" href="shader_8h.html#a874">mi_sample</a>(
02387         <span class="keywordtype">double</span>          *sample, 
02388         <span class="keywordtype">int</span>             *instance,
02389         <span class="keyword">struct</span> <a class="code" href="structmiState.html">miState</a>  *state, 
02390         <span class="keyword">const</span> miUshort  dimension, 
02391         miUint          *n);
02392 
02393 <span class="preprocessor">#ifdef __cplusplus</span>
02394 <span class="preprocessor"></span>}
02395 <span class="preprocessor">#endif</span>
02396 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Feb 14 01:41:00 2004 for mrClasses by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
